{"version":3,"sources":["utils/tv4.js"],"names":["notReallyPercentEncode","string","encodeURI","replace","doubleEncoded","substring","uriTemplateSubstitution","spec","modifier","uriTemplateGlobalModifiers","charAt","separator","prefix","shouldEscape","showVariables","trimEmptyString","varNames","varList","split","varSpecs","varSpecMap","i","length","varName","truncate","indexOf","parts","parseInt","suffices","uriTemplateSuffices","varSpec","name","push","subFunction","valueFunction","result","startIndex","value","undefined","Array","isArray","_typeof3","default","_keys2","j","encodeURIComponent","first","key","substitution","UriTemplate","template","this","textParts","shift","prefixes","substitutions","part","remainder","funcs","concat","fill","recursiveCompare","A","B","parseURI","url","m","String","match","href","protocol","authority","host","hostname","port","pathname","search","hash","resolveUrl","base","removeDotSegments","input","output","p","pop","join","slice","lastIndexOf","getDocumentUri","uri","normSchema","schema","baseUri","id","defaultErrorReporter","language","errorMessages","languages","error","messageTemplate","code","ErrorMessagesDefault","_stringify2","messageParams","params","whole","subValue","ValidationError","dataPath","schemaPath","subErrors","Error","call","message","err","stack","stacktrace","isTrustedUrl","baseUrl","testUrl","createApi","currentLanguage","customErrorReporter","globalContext","ValidatorContext","api","setErrorReporter","reporter","addFormat","apply","arguments","addLanguage","messageMap","ErrorCodes","rootCode","_create2","freshApi","validate","data","checkRecursive","banUnknownProperties","def","errorReporter","context","$ref","addSchema","validateAll","missing","valid","validateResult","validateMultiple","errors","getSchema","getSchemaMap","getSchemaUris","getMissingUris","dropSchemas","defineKeyword","defineError","codeName","codeNumber","defaultMessage","test","ErrorCodeLookup","langCode","reset","errorCodes","Object","keys","hasOwnProperty","prototype","hasDontEnumBug","toString","propertyIsEnumerable","dontEnums","dontEnumsLength","obj","TypeError","prop","create","F","o","vArg","searchElement","t","len","n","Number","Infinity","Math","floor","abs","k","max","_isFrozen2","isFrozen","random","e","+","#",".","/",";","?","&","*","fillFromObject","parent","collectMultiple","trackUnknownProperties","missingMap","formatValidators","schemas","handleError","collectError","returnError","scanned","scannedFrozen","scannedFrozenSchemas","scannedFrozenValidationErrors","validatedSchemasKey","validationErrorsKey","knownPropertyPaths","unknownPropertyPaths","definedKeywords","keyword","keywordFunction","createError","prefixErrors","prefixWith","unknownPath","UNKNOWN_PROPERTY","path","format","validator","resolveRefs","urlHistory","CIRCULAR_REFERENCE","urls","fragment","pointerPath","decodeURIComponent","component","searchSchemas","map","filterRegExp","list","dataPathParts","schemaPathParts","dataPointerPath","topLevel","frozenIndex","startErrorCount","scannedFrozenSchemaIndex","scannedSchemasIndex","schemaIndex","frozenSchemaIndex","_defineProperty2","configurable","errorCount","validateBasic","validateNumeric","validateString","validateArray","validateObject","validateCombinations","validateHypermedia","validateFormat","validateDefinedKeywords","item","dataPart","schemaPart","errorMessage","FORMAT_CUSTOM","validationFunctions","func","KEYWORD_CUSTOM","validateType","validateEnum","type","dataType","allowedTypes","INVALID_TYPE","expected","enumVal","ENUM_MISMATCH","JSON","validateMultipleOf","validateMinMax","validateNaN","CLOSE_ENOUGH_LOW","pow","CLOSE_ENOUGH_HIGH","multipleOf","divisibleBy","NUMBER_MULTIPLE_OF","minimum","NUMBER_MINIMUM","exclusiveMinimum","NUMBER_MINIMUM_EXCLUSIVE","maximum","NUMBER_MAXIMUM","exclusiveMaximum","NUMBER_MAXIMUM_EXCLUSIVE","isNaN","NUMBER_NOT_A_NUMBER","validateStringLength","validateStringPattern","minLength","STRING_LENGTH_SHORT","maxLength","STRING_LENGTH_LONG","pattern","RegExp","regexp","body","flags","literal","STRING_PATTERN","validateArrayLength","validateArrayUniqueItems","validateArrayItems","minItems","ARRAY_LENGTH_SHORT","maxItems","ARRAY_LENGTH_LONG","uniqueItems","ARRAY_UNIQUE","match1","match2","items","additionalItems","ARRAY_ADDITIONAL_ITEMS","validateObjectMinMaxProperties","validateObjectRequiredProperties","validateObjectProperties","validateObjectDependencies","minProperties","OBJECT_PROPERTIES_MINIMUM","propertyCount","maxProperties","OBJECT_PROPERTIES_MAXIMUM","required","OBJECT_REQUIRED","keyPointerPath","foundMatch","properties","patternProperties","patternKey","additionalProperties","OBJECT_ADDITIONAL_PROPERTIES","dependencies","depKey","dep","OBJECT_DEPENDENCY_KEY","requiredKey","validateAllOf","validateAnyOf","validateOneOf","validateNot","allOf","subSchema","anyOf","oldUnknownPropertyPaths","oldKnownPropertyPaths","errorAtEnd","knownKey","unknownKey","ANY_OF_MISSING","oneOf","validIndex","ONE_OF_MULTIPLE","index1","index2","ONE_OF_MISSING","not","oldErrorCount","notErrors","NOT_PASSED","links","ldo","rel","allPresent","schemaUrl","constructor","dataPrefix","schemaPrefix","tv4"],"mappings":"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","file":"utils/tv4.js","sourcesContent":["/*\n Author: Geraint Luff and others\n Year: 2013\n\n This code is released into the \"public domain\" by its author(s).  Anybody may use, alter and distribute the code without restriction.  The author makes no guarantees, and takes no liability of any kind for use of this code.\n\n If you find a bug or make an improvement, it would be courteous to let the author know, but it is not compulsory.\n */\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/keys?redirectlocale=en-US&redirectslug=JavaScript%2FReference%2FGlobal_Objects%2FObject%2Fkeys\nif (!Object.keys) {\n    Object.keys = (function () {\n        var hasOwnProperty = Object.prototype.hasOwnProperty,\n            hasDontEnumBug = !({toString: null}).propertyIsEnumerable('toString'),\n            dontEnums = [\n                'toString',\n                'toLocaleString',\n                'valueOf',\n                'hasOwnProperty',\n                'isPrototypeOf',\n                'propertyIsEnumerable',\n                'constructor'\n            ],\n            dontEnumsLength = dontEnums.length;\n\n        return function (obj) {\n            if (typeof obj !== 'object' && typeof obj !== 'function' || obj === null) {\n                throw new TypeError('Object.keys called on non-object');\n            }\n\n            var result = [];\n\n            for (var prop in obj) {\n                if (hasOwnProperty.call(obj, prop)) {\n                    result.push(prop);\n                }\n            }\n\n            if (hasDontEnumBug) {\n                for (var i = 0; i < dontEnumsLength; i++) {\n                    if (hasOwnProperty.call(obj, dontEnums[i])) {\n                        result.push(dontEnums[i]);\n                    }\n                }\n            }\n            return result;\n        };\n    })();\n}\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/create\nif (!Object.create) {\n    Object.create = (function () {\n        function F() {\n        }\n\n        return function (o) {\n            if (arguments.length !== 1) {\n                throw new Error('Object.create implementation only accepts one parameter.');\n            }\n            F.prototype = o;\n            return new F();\n        };\n    })();\n}\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/isArray?redirectlocale=en-US&redirectslug=JavaScript%2FReference%2FGlobal_Objects%2FArray%2FisArray\nif (!Array.isArray) {\n    Array.isArray = function (vArg) {\n        return Object.prototype.toString.call(vArg) === \"[object Array]\";\n    };\n}\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/indexOf?redirectlocale=en-US&redirectslug=JavaScript%2FReference%2FGlobal_Objects%2FArray%2FindexOf\nif (!Array.prototype.indexOf) {\n    Array.prototype.indexOf = function (searchElement /*, fromIndex */) {\n        if (this === null) {\n            throw new TypeError();\n        }\n        var t = Object(this);\n        var len = t.length >>> 0;\n\n        if (len === 0) {\n            return -1;\n        }\n        var n = 0;\n        if (arguments.length > 1) {\n            n = Number(arguments[1]);\n            if (n !== n) { // shortcut for verifying if it's NaN\n                n = 0;\n            } else if (n !== 0 && n !== Infinity && n !== -Infinity) {\n                n = (n > 0 || -1) * Math.floor(Math.abs(n));\n            }\n        }\n        if (n >= len) {\n            return -1;\n        }\n        var k = n >= 0 ? n : Math.max(len - Math.abs(n), 0);\n        for (; k < len; k++) {\n            if (k in t && t[k] === searchElement) {\n                return k;\n            }\n        }\n        return -1;\n    };\n}\n\n// Grungey Object.isFrozen hack\nif (!Object.isFrozen) {\n    Object.isFrozen = function (obj) {\n        var key = \"tv4_test_frozen_key\";\n        while (obj.hasOwnProperty(key)) {\n            key += Math.random();\n        }\n        try {\n            obj[key] = true;\n            delete obj[key];\n            return false;\n        } catch (e) {\n            return true;\n        }\n    };\n}\n// Based on: https://github.com/geraintluff/uri-templates, but with all the de-substitution stuff removed\n\nvar uriTemplateGlobalModifiers = {\n    \"+\": true,\n    \"#\": true,\n    \".\": true,\n    \"/\": true,\n    \";\": true,\n    \"?\": true,\n    \"&\": true\n};\nvar uriTemplateSuffices = {\n    \"*\": true\n};\n\nfunction notReallyPercentEncode(string) {\n    return encodeURI(string).replace(/%25[0-9][0-9]/g, function (doubleEncoded) {\n        return \"%\" + doubleEncoded.substring(3);\n    });\n}\n\nfunction uriTemplateSubstitution(spec) {\n    var modifier = \"\";\n    if (uriTemplateGlobalModifiers[spec.charAt(0)]) {\n        modifier = spec.charAt(0);\n        spec = spec.substring(1);\n    }\n    var separator = \"\";\n    var prefix = \"\";\n    var shouldEscape = true;\n    var showVariables = false;\n    var trimEmptyString = false;\n    if (modifier === '+') {\n        shouldEscape = false;\n    } else if (modifier === \".\") {\n        prefix = \".\";\n        separator = \".\";\n    } else if (modifier === \"/\") {\n        prefix = \"/\";\n        separator = \"/\";\n    } else if (modifier === '#') {\n        prefix = \"#\";\n        shouldEscape = false;\n    } else if (modifier === ';') {\n        prefix = \";\";\n        separator = \";\";\n        showVariables = true;\n        trimEmptyString = true;\n    } else if (modifier === '?') {\n        prefix = \"?\";\n        separator = \"&\";\n        showVariables = true;\n    } else if (modifier === '&') {\n        prefix = \"&\";\n        separator = \"&\";\n        showVariables = true;\n    }\n\n    var varNames = [];\n    var varList = spec.split(\",\");\n    var varSpecs = [];\n    var varSpecMap = {};\n    for (var i = 0; i < varList.length; i++) {\n        var varName = varList[i];\n        var truncate = null;\n        if (varName.indexOf(\":\") !== -1) {\n            var parts = varName.split(\":\");\n            varName = parts[0];\n            truncate = parseInt(parts[1], 10);\n        }\n        var suffices = {};\n        while (uriTemplateSuffices[varName.charAt(varName.length - 1)]) {\n            suffices[varName.charAt(varName.length - 1)] = true;\n            varName = varName.substring(0, varName.length - 1);\n        }\n        var varSpec = {\n            truncate: truncate,\n            name: varName,\n            suffices: suffices\n        };\n        varSpecs.push(varSpec);\n        varSpecMap[varName] = varSpec;\n        varNames.push(varName);\n    }\n    var subFunction = function (valueFunction) {\n        var result = \"\";\n        var startIndex = 0;\n        for (var i = 0; i < varSpecs.length; i++) {\n            var varSpec = varSpecs[i];\n            var value = valueFunction(varSpec.name);\n            if (value === null || value === undefined || (Array.isArray(value) && value.length === 0) || (typeof value === 'object' && Object.keys(value).length === 0)) {\n                startIndex++;\n                continue;\n            }\n            if (i === startIndex) {\n                result += prefix;\n            } else {\n                result += (separator || \",\");\n            }\n            if (Array.isArray(value)) {\n                if (showVariables) {\n                    result += varSpec.name + \"=\";\n                }\n                for (var j = 0; j < value.length; j++) {\n                    if (j > 0) {\n                        result += varSpec.suffices['*'] ? (separator || \",\") : \",\";\n                        if (varSpec.suffices['*'] && showVariables) {\n                            result += varSpec.name + \"=\";\n                        }\n                    }\n                    result += shouldEscape ? encodeURIComponent(value[j]).replace(/!/g, \"%21\") : notReallyPercentEncode(value[j]);\n                }\n            } else if (typeof value === \"object\") {\n                if (showVariables && !varSpec.suffices['*']) {\n                    result += varSpec.name + \"=\";\n                }\n                var first = true;\n                for (var key in value) {\n                    if (!first) {\n                        result += varSpec.suffices['*'] ? (separator || \",\") : \",\";\n                    }\n                    first = false;\n                    result += shouldEscape ? encodeURIComponent(key).replace(/!/g, \"%21\") : notReallyPercentEncode(key);\n                    result += varSpec.suffices['*'] ? '=' : \",\";\n                    result += shouldEscape ? encodeURIComponent(value[key]).replace(/!/g, \"%21\") : notReallyPercentEncode(value[key]);\n                }\n            } else {\n                if (showVariables) {\n                    result += varSpec.name;\n                    if (!trimEmptyString || value !== \"\") {\n                        result += \"=\";\n                    }\n                }\n                if (varSpec.truncate != null) {\n                    value = value.substring(0, varSpec.truncate);\n                }\n                result += shouldEscape ? encodeURIComponent(value).replace(/!/g, \"%21\") : notReallyPercentEncode(value);\n            }\n        }\n        return result;\n    };\n    subFunction.varNames = varNames;\n    return {\n        prefix: prefix,\n        substitution: subFunction\n    };\n}\n\nfunction UriTemplate(template) {\n    if (!(this instanceof UriTemplate)) {\n        return new UriTemplate(template);\n    }\n    var parts = template.split(\"{\");\n    var textParts = [parts.shift()];\n    var prefixes = [];\n    var substitutions = [];\n    var varNames = [];\n    while (parts.length > 0) {\n        var part = parts.shift();\n        var spec = part.split(\"}\")[0];\n        var remainder = part.substring(spec.length + 1);\n        var funcs = uriTemplateSubstitution(spec);\n        substitutions.push(funcs.substitution);\n        prefixes.push(funcs.prefix);\n        textParts.push(remainder);\n        varNames = varNames.concat(funcs.substitution.varNames);\n    }\n    this.fill = function (valueFunction) {\n        var result = textParts[0];\n        for (var i = 0; i < substitutions.length; i++) {\n            var substitution = substitutions[i];\n            result += substitution(valueFunction);\n            result += textParts[i + 1];\n        }\n        return result;\n    };\n    this.varNames = varNames;\n    this.template = template;\n}\n\nUriTemplate.prototype = {\n    toString: function () {\n        return this.template;\n    },\n    fillFromObject: function (obj) {\n        return this.fill(function (varName) {\n            return obj[varName];\n        });\n    }\n};\nvar ValidatorContext = function ValidatorContext(parent, collectMultiple, errorReporter, checkRecursive, trackUnknownProperties) {\n    this.missing = [];\n    this.missingMap = {};\n    this.formatValidators = parent ? Object.create(parent.formatValidators) : {};\n    this.schemas = parent ? Object.create(parent.schemas) : {};\n    this.collectMultiple = collectMultiple;\n    this.errors = [];\n    this.handleError = collectMultiple ? this.collectError : this.returnError;\n    if (checkRecursive) {\n        this.checkRecursive = true;\n        this.scanned = [];\n        this.scannedFrozen = [];\n        this.scannedFrozenSchemas = [];\n        this.scannedFrozenValidationErrors = [];\n        this.validatedSchemasKey = 'tv4_validation_id';\n        this.validationErrorsKey = 'tv4_validation_errors_id';\n    }\n    if (trackUnknownProperties) {\n        this.trackUnknownProperties = true;\n        this.knownPropertyPaths = {};\n        this.unknownPropertyPaths = {};\n    }\n    this.errorReporter = errorReporter || defaultErrorReporter('en');\n    if (typeof this.errorReporter === 'string') {\n        throw new Error('debug');\n    }\n    this.definedKeywords = {};\n    if (parent) {\n        for (var key in parent.definedKeywords) {\n            this.definedKeywords[key] = parent.definedKeywords[key].slice(0);\n        }\n    }\n};\nValidatorContext.prototype.defineKeyword = function (keyword, keywordFunction) {\n    this.definedKeywords[keyword] = this.definedKeywords[keyword] || [];\n    this.definedKeywords[keyword].push(keywordFunction);\n};\nValidatorContext.prototype.createError = function (code, messageParams, dataPath, schemaPath, subErrors, data, schema) {\n    var error = new ValidationError(code, messageParams, dataPath, schemaPath, subErrors);\n    error.message = this.errorReporter(error, data, schema);\n    return error;\n};\nValidatorContext.prototype.returnError = function (error) {\n    return error;\n};\nValidatorContext.prototype.collectError = function (error) {\n    if (error) {\n        this.errors.push(error);\n    }\n    return null;\n};\nValidatorContext.prototype.prefixErrors = function (startIndex, dataPath, schemaPath) {\n    for (var i = startIndex; i < this.errors.length; i++) {\n        this.errors[i] = this.errors[i].prefixWith(dataPath, schemaPath);\n    }\n    return this;\n};\nValidatorContext.prototype.banUnknownProperties = function (data, schema) {\n    for (var unknownPath in this.unknownPropertyPaths) {\n        var error = this.createError(ErrorCodes.UNKNOWN_PROPERTY, {path: unknownPath}, unknownPath, \"\", null, data, schema);\n        var result = this.handleError(error);\n        if (result) {\n            return result;\n        }\n    }\n    return null;\n};\n\nValidatorContext.prototype.addFormat = function (format, validator) {\n    if (typeof format === 'object') {\n        for (var key in format) {\n            this.addFormat(key, format[key]);\n        }\n        return this;\n    }\n    this.formatValidators[format] = validator;\n};\nValidatorContext.prototype.resolveRefs = function (schema, urlHistory) {\n    if (schema['$ref'] !== undefined) {\n        urlHistory = urlHistory || {};\n        if (urlHistory[schema['$ref']]) {\n            return this.createError(ErrorCodes.CIRCULAR_REFERENCE, {urls: Object.keys(urlHistory).join(', ')}, '', '', null, undefined, schema);\n        }\n        urlHistory[schema['$ref']] = true;\n        schema = this.getSchema(schema['$ref'], urlHistory);\n    }\n    return schema;\n};\nValidatorContext.prototype.getSchema = function (url, urlHistory) {\n    var schema;\n    if (this.schemas[url] !== undefined) {\n        schema = this.schemas[url];\n        return this.resolveRefs(schema, urlHistory);\n    }\n    var baseUrl = url;\n    var fragment = \"\";\n    if (url.indexOf('#') !== -1) {\n        fragment = url.substring(url.indexOf(\"#\") + 1);\n        baseUrl = url.substring(0, url.indexOf(\"#\"));\n    }\n    if (typeof this.schemas[baseUrl] === 'object') {\n        schema = this.schemas[baseUrl];\n        var pointerPath = decodeURIComponent(fragment);\n        if (pointerPath === \"\") {\n            return this.resolveRefs(schema, urlHistory);\n        } else if (pointerPath.charAt(0) !== \"/\") {\n            return undefined;\n        }\n        var parts = pointerPath.split(\"/\").slice(1);\n        for (var i = 0; i < parts.length; i++) {\n            var component = parts[i].replace(/~1/g, \"/\").replace(/~0/g, \"~\");\n            if (schema[component] === undefined) {\n                schema = undefined;\n                break;\n            }\n            schema = schema[component];\n        }\n        if (schema !== undefined) {\n            return this.resolveRefs(schema, urlHistory);\n        }\n    }\n    if (this.missing[baseUrl] === undefined) {\n        this.missing.push(baseUrl);\n        this.missing[baseUrl] = baseUrl;\n        this.missingMap[baseUrl] = baseUrl;\n    }\n};\nValidatorContext.prototype.searchSchemas = function (schema, url) {\n    if (Array.isArray(schema)) {\n        for (var i = 0; i < schema.length; i++) {\n            this.searchSchemas(schema[i], url);\n        }\n    } else if (schema && typeof schema === \"object\") {\n        if (typeof schema.id === \"string\") {\n            if (isTrustedUrl(url, schema.id)) {\n                if (this.schemas[schema.id] === undefined) {\n                    this.schemas[schema.id] = schema;\n                }\n            }\n        }\n        for (var key in schema) {\n            if (key !== \"enum\") {\n                if (typeof schema[key] === \"object\") {\n                    this.searchSchemas(schema[key], url);\n                } else if (key === \"$ref\") {\n                    var uri = getDocumentUri(schema[key]);\n                    if (uri && this.schemas[uri] === undefined && this.missingMap[uri] === undefined) {\n                        this.missingMap[uri] = uri;\n                    }\n                }\n            }\n        }\n    }\n};\nValidatorContext.prototype.addSchema = function (url, schema) {\n    //overload\n    if (typeof url !== 'string' || typeof schema === 'undefined') {\n        if (typeof url === 'object' && typeof url.id === 'string') {\n            schema = url;\n            url = schema.id;\n        }\n        else {\n            return;\n        }\n    }\n    if (url === getDocumentUri(url) + \"#\") {\n        // Remove empty fragment\n        url = getDocumentUri(url);\n    }\n    this.schemas[url] = schema;\n    delete this.missingMap[url];\n    normSchema(schema, url);\n    this.searchSchemas(schema, url);\n};\n\nValidatorContext.prototype.getSchemaMap = function () {\n    var map = {};\n    for (var key in this.schemas) {\n        map[key] = this.schemas[key];\n    }\n    return map;\n};\n\nValidatorContext.prototype.getSchemaUris = function (filterRegExp) {\n    var list = [];\n    for (var key in this.schemas) {\n        if (!filterRegExp || filterRegExp.test(key)) {\n            list.push(key);\n        }\n    }\n    return list;\n};\n\nValidatorContext.prototype.getMissingUris = function (filterRegExp) {\n    var list = [];\n    for (var key in this.missingMap) {\n        if (!filterRegExp || filterRegExp.test(key)) {\n            list.push(key);\n        }\n    }\n    return list;\n};\n\nValidatorContext.prototype.dropSchemas = function () {\n    this.schemas = {};\n    this.reset();\n};\nValidatorContext.prototype.reset = function () {\n    this.missing = [];\n    this.missingMap = {};\n    this.errors = [];\n};\n\nValidatorContext.prototype.validateAll = function (data, schema, dataPathParts, schemaPathParts, dataPointerPath) {\n    var topLevel;\n    schema = this.resolveRefs(schema);\n    if (!schema) {\n        return null;\n    } else if (schema instanceof ValidationError) {\n        this.errors.push(schema);\n        return schema;\n    }\n\n    var startErrorCount = this.errors.length;\n    var frozenIndex, scannedFrozenSchemaIndex = null, scannedSchemasIndex = null;\n    if (this.checkRecursive && data && typeof data === 'object') {\n        topLevel = !this.scanned.length;\n        if (data[this.validatedSchemasKey]) {\n            var schemaIndex = data[this.validatedSchemasKey].indexOf(schema);\n            if (schemaIndex !== -1) {\n                this.errors = this.errors.concat(data[this.validationErrorsKey][schemaIndex]);\n                return null;\n            }\n        }\n        if (Object.isFrozen(data)) {\n            frozenIndex = this.scannedFrozen.indexOf(data);\n            if (frozenIndex !== -1) {\n                var frozenSchemaIndex = this.scannedFrozenSchemas[frozenIndex].indexOf(schema);\n                if (frozenSchemaIndex !== -1) {\n                    this.errors = this.errors.concat(this.scannedFrozenValidationErrors[frozenIndex][frozenSchemaIndex]);\n                    return null;\n                }\n            }\n        }\n        this.scanned.push(data);\n        if (Object.isFrozen(data)) {\n            if (frozenIndex === -1) {\n                frozenIndex = this.scannedFrozen.length;\n                this.scannedFrozen.push(data);\n                this.scannedFrozenSchemas.push([]);\n            }\n            scannedFrozenSchemaIndex = this.scannedFrozenSchemas[frozenIndex].length;\n            this.scannedFrozenSchemas[frozenIndex][scannedFrozenSchemaIndex] = schema;\n            this.scannedFrozenValidationErrors[frozenIndex][scannedFrozenSchemaIndex] = [];\n        } else {\n            if (!data[this.validatedSchemasKey]) {\n                try {\n                    Object.defineProperty(data, this.validatedSchemasKey, {\n                        value: [],\n                        configurable: true\n                    });\n                    Object.defineProperty(data, this.validationErrorsKey, {\n                        value: [],\n                        configurable: true\n                    });\n                } catch (e) {\n                    //IE 7/8 workaround\n                    data[this.validatedSchemasKey] = [];\n                    data[this.validationErrorsKey] = [];\n                }\n            }\n            scannedSchemasIndex = data[this.validatedSchemasKey].length;\n            data[this.validatedSchemasKey][scannedSchemasIndex] = schema;\n            data[this.validationErrorsKey][scannedSchemasIndex] = [];\n        }\n    }\n\n    var errorCount = this.errors.length;\n    var error = this.validateBasic(data, schema, dataPointerPath)\n        || this.validateNumeric(data, schema, dataPointerPath)\n        || this.validateString(data, schema, dataPointerPath)\n        || this.validateArray(data, schema, dataPointerPath)\n        || this.validateObject(data, schema, dataPointerPath)\n        || this.validateCombinations(data, schema, dataPointerPath)\n        || this.validateHypermedia(data, schema, dataPointerPath)\n        || this.validateFormat(data, schema, dataPointerPath)\n        || this.validateDefinedKeywords(data, schema, dataPointerPath)\n        || null;\n\n    if (topLevel) {\n        while (this.scanned.length) {\n            var item = this.scanned.pop();\n            delete item[this.validatedSchemasKey];\n        }\n        this.scannedFrozen = [];\n        this.scannedFrozenSchemas = [];\n    }\n\n    if (error || errorCount !== this.errors.length) {\n        while ((dataPathParts && dataPathParts.length) || (schemaPathParts && schemaPathParts.length)) {\n            var dataPart = (dataPathParts && dataPathParts.length) ? \"\" + dataPathParts.pop() : null;\n            var schemaPart = (schemaPathParts && schemaPathParts.length) ? \"\" + schemaPathParts.pop() : null;\n            if (error) {\n                error = error.prefixWith(dataPart, schemaPart);\n            }\n            this.prefixErrors(errorCount, dataPart, schemaPart);\n        }\n    }\n\n    if (scannedFrozenSchemaIndex !== null) {\n        this.scannedFrozenValidationErrors[frozenIndex][scannedFrozenSchemaIndex] = this.errors.slice(startErrorCount);\n    } else if (scannedSchemasIndex !== null) {\n        data[this.validationErrorsKey][scannedSchemasIndex] = this.errors.slice(startErrorCount);\n    }\n\n    return this.handleError(error);\n};\nValidatorContext.prototype.validateFormat = function (data, schema) {\n    if (typeof schema.format !== 'string' || !this.formatValidators[schema.format]) {\n        return null;\n    }\n    var errorMessage = this.formatValidators[schema.format].call(null, data, schema);\n    if (typeof errorMessage === 'string' || typeof errorMessage === 'number') {\n        return this.createError(ErrorCodes.FORMAT_CUSTOM, {message: errorMessage}, '', '/format', null, data, schema);\n    } else if (errorMessage && typeof errorMessage === 'object') {\n        return this.createError(ErrorCodes.FORMAT_CUSTOM, {message: errorMessage.message || \"?\"}, errorMessage.dataPath || '', errorMessage.schemaPath || \"/format\", null, data, schema);\n    }\n    return null;\n};\nValidatorContext.prototype.validateDefinedKeywords = function (data, schema, dataPointerPath) {\n    for (var key in this.definedKeywords) {\n        if (typeof schema[key] === 'undefined') {\n            continue;\n        }\n        var validationFunctions = this.definedKeywords[key];\n        for (var i = 0; i < validationFunctions.length; i++) {\n            var func = validationFunctions[i];\n            var result = func(data, schema[key], schema, dataPointerPath);\n            if (typeof result === 'string' || typeof result === 'number') {\n                return this.createError(ErrorCodes.KEYWORD_CUSTOM, {\n                    key: key,\n                    message: result\n                }, '', '', null, data, schema).prefixWith(null, key);\n            } else if (result && typeof result === 'object') {\n                var code = result.code;\n                if (typeof code === 'string') {\n                    if (!ErrorCodes[code]) {\n                        throw new Error('Undefined error code (use defineError): ' + code);\n                    }\n                    code = ErrorCodes[code];\n                } else if (typeof code !== 'number') {\n                    code = ErrorCodes.KEYWORD_CUSTOM;\n                }\n                var messageParams = (typeof result.message === 'object') ? result.message : {\n                    key: key,\n                    message: result.message || \"?\"\n                };\n                var schemaPath = result.schemaPath || (\"/\" + key.replace(/~/g, '~0').replace(/\\//g, '~1'));\n                return this.createError(code, messageParams, result.dataPath || null, schemaPath, null, data, schema);\n            }\n        }\n    }\n    return null;\n};\n\nfunction recursiveCompare(A, B) {\n    if (A === B) {\n        return true;\n    }\n    if (A && B && typeof A === \"object\" && typeof B === \"object\") {\n        if (Array.isArray(A) !== Array.isArray(B)) {\n            return false;\n        } else if (Array.isArray(A)) {\n            if (A.length !== B.length) {\n                return false;\n            }\n            for (var i = 0; i < A.length; i++) {\n                if (!recursiveCompare(A[i], B[i])) {\n                    return false;\n                }\n            }\n        } else {\n            var key;\n            for (key in A) {\n                if (B[key] === undefined && A[key] !== undefined) {\n                    return false;\n                }\n            }\n            for (key in B) {\n                if (A[key] === undefined && B[key] !== undefined) {\n                    return false;\n                }\n            }\n            for (key in A) {\n                if (!recursiveCompare(A[key], B[key])) {\n                    return false;\n                }\n            }\n        }\n        return true;\n    }\n    return false;\n}\n\nValidatorContext.prototype.validateBasic = function validateBasic(data, schema, dataPointerPath) {\n    var error;\n    if (error = this.validateType(data, schema, dataPointerPath)) {\n        return error.prefixWith(null, \"type\");\n    }\n    if (error = this.validateEnum(data, schema, dataPointerPath)) {\n        return error.prefixWith(null, \"type\");\n    }\n    return null;\n};\n\nValidatorContext.prototype.validateType = function validateType(data, schema) {\n    if (schema.type === undefined) {\n        return null;\n    }\n    var dataType = typeof data;\n    if (data === null) {\n        dataType = \"null\";\n    } else if (Array.isArray(data)) {\n        dataType = \"array\";\n    }\n    var allowedTypes = schema.type;\n    if (!Array.isArray(allowedTypes)) {\n        allowedTypes = [allowedTypes];\n    }\n\n    for (var i = 0; i < allowedTypes.length; i++) {\n        var type = allowedTypes[i];\n        if (type === dataType || (type === \"integer\" && dataType === \"number\" && (data % 1 === 0))) {\n            return null;\n        }\n    }\n    return this.createError(ErrorCodes.INVALID_TYPE, {\n        type: dataType,\n        expected: allowedTypes.join(\"/\")\n    }, '', '', null, data, schema);\n};\n\nValidatorContext.prototype.validateEnum = function validateEnum(data, schema) {\n    if (schema[\"enum\"] === undefined) {\n        return null;\n    }\n    for (var i = 0; i < schema[\"enum\"].length; i++) {\n        var enumVal = schema[\"enum\"][i];\n        if (recursiveCompare(data, enumVal)) {\n            return null;\n        }\n    }\n    return this.createError(ErrorCodes.ENUM_MISMATCH, {value: (typeof JSON !== 'undefined') ? JSON.stringify(data) : data}, '', '', null, data, schema);\n};\n\nValidatorContext.prototype.validateNumeric = function validateNumeric(data, schema, dataPointerPath) {\n    return this.validateMultipleOf(data, schema, dataPointerPath)\n        || this.validateMinMax(data, schema, dataPointerPath)\n        || this.validateNaN(data, schema, dataPointerPath)\n        || null;\n};\n\nvar CLOSE_ENOUGH_LOW = Math.pow(2, -51);\nvar CLOSE_ENOUGH_HIGH = 1 - CLOSE_ENOUGH_LOW;\nValidatorContext.prototype.validateMultipleOf = function validateMultipleOf(data, schema) {\n    var multipleOf = schema.multipleOf || schema.divisibleBy;\n    if (multipleOf === undefined) {\n        return null;\n    }\n    if (typeof data === \"number\") {\n        var remainder = (data / multipleOf) % 1;\n        if (remainder >= CLOSE_ENOUGH_LOW && remainder < CLOSE_ENOUGH_HIGH) {\n            return this.createError(ErrorCodes.NUMBER_MULTIPLE_OF, {\n                value: data,\n                multipleOf: multipleOf\n            }, '', '', null, data, schema);\n        }\n    }\n    return null;\n};\n\nValidatorContext.prototype.validateMinMax = function validateMinMax(data, schema) {\n    if (typeof data !== \"number\") {\n        return null;\n    }\n    if (schema.minimum !== undefined) {\n        if (data < schema.minimum) {\n            return this.createError(ErrorCodes.NUMBER_MINIMUM, {\n                value: data,\n                minimum: schema.minimum\n            }, '', '/minimum', null, data, schema);\n        }\n        if (schema.exclusiveMinimum && data === schema.minimum) {\n            return this.createError(ErrorCodes.NUMBER_MINIMUM_EXCLUSIVE, {\n                value: data,\n                minimum: schema.minimum\n            }, '', '/exclusiveMinimum', null, data, schema);\n        }\n    }\n    if (schema.maximum !== undefined) {\n        if (data > schema.maximum) {\n            return this.createError(ErrorCodes.NUMBER_MAXIMUM, {\n                value: data,\n                maximum: schema.maximum\n            }, '', '/maximum', null, data, schema);\n        }\n        if (schema.exclusiveMaximum && data === schema.maximum) {\n            return this.createError(ErrorCodes.NUMBER_MAXIMUM_EXCLUSIVE, {\n                value: data,\n                maximum: schema.maximum\n            }, '', '/exclusiveMaximum', null, data, schema);\n        }\n    }\n    return null;\n};\n\nValidatorContext.prototype.validateNaN = function validateNaN(data, schema) {\n    if (typeof data !== \"number\") {\n        return null;\n    }\n    if (isNaN(data) === true || data === Infinity || data === -Infinity) {\n        return this.createError(ErrorCodes.NUMBER_NOT_A_NUMBER, {value: data}, '', '/type', null, data, schema);\n    }\n    return null;\n};\n\nValidatorContext.prototype.validateString = function validateString(data, schema, dataPointerPath) {\n    return this.validateStringLength(data, schema, dataPointerPath)\n        || this.validateStringPattern(data, schema, dataPointerPath)\n        || null;\n};\n\nValidatorContext.prototype.validateStringLength = function validateStringLength(data, schema) {\n    if (typeof data !== \"string\") {\n        return null;\n    }\n    if (schema.minLength !== undefined) {\n        if (data.length < schema.minLength) {\n            return this.createError(ErrorCodes.STRING_LENGTH_SHORT, {\n                length: data.length,\n                minimum: schema.minLength\n            }, '', '/minLength', null, data, schema);\n        }\n    }\n    if (schema.maxLength !== undefined) {\n        if (data.length > schema.maxLength) {\n            return this.createError(ErrorCodes.STRING_LENGTH_LONG, {\n                length: data.length,\n                maximum: schema.maxLength\n            }, '', '/maxLength', null, data, schema);\n        }\n    }\n    return null;\n};\n\nValidatorContext.prototype.validateStringPattern = function validateStringPattern(data, schema) {\n    if (typeof data !== \"string\" || (typeof schema.pattern !== \"string\" && !(schema.pattern instanceof RegExp))) {\n        return null;\n    }\n    var regexp;\n    if (schema.pattern instanceof RegExp) {\n        regexp = schema.pattern;\n    }\n    else {\n        var body, flags = '';\n        // Check for regular expression literals\n        // @see http://www.ecma-international.org/ecma-262/5.1/#sec-7.8.5\n        var literal = schema.pattern.match(/^\\/(.+)\\/([img]*)$/);\n        if (literal) {\n            body = literal[1];\n            flags = literal[2];\n        }\n        else {\n            body = schema.pattern;\n        }\n        regexp = new RegExp(body, flags);\n    }\n    if (!regexp.test(data)) {\n        return this.createError(ErrorCodes.STRING_PATTERN, {pattern: schema.pattern}, '', '/pattern', null, data, schema);\n    }\n    return null;\n};\n\nValidatorContext.prototype.validateArray = function validateArray(data, schema, dataPointerPath) {\n    if (!Array.isArray(data)) {\n        return null;\n    }\n    return this.validateArrayLength(data, schema, dataPointerPath)\n        || this.validateArrayUniqueItems(data, schema, dataPointerPath)\n        || this.validateArrayItems(data, schema, dataPointerPath)\n        || null;\n};\n\nValidatorContext.prototype.validateArrayLength = function validateArrayLength(data, schema) {\n    var error;\n    if (schema.minItems !== undefined) {\n        if (data.length < schema.minItems) {\n            error = this.createError(ErrorCodes.ARRAY_LENGTH_SHORT, {\n                length: data.length,\n                minimum: schema.minItems\n            }, '', '/minItems', null, data, schema);\n            if (this.handleError(error)) {\n                return error;\n            }\n        }\n    }\n    if (schema.maxItems !== undefined) {\n        if (data.length > schema.maxItems) {\n            error = this.createError(ErrorCodes.ARRAY_LENGTH_LONG, {\n                length: data.length,\n                maximum: schema.maxItems\n            }, '', '/maxItems', null, data, schema);\n            if (this.handleError(error)) {\n                return error;\n            }\n        }\n    }\n    return null;\n};\n\nValidatorContext.prototype.validateArrayUniqueItems = function validateArrayUniqueItems(data, schema) {\n    if (schema.uniqueItems) {\n        for (var i = 0; i < data.length; i++) {\n            for (var j = i + 1; j < data.length; j++) {\n                if (recursiveCompare(data[i], data[j])) {\n                    var error = this.createError(ErrorCodes.ARRAY_UNIQUE, {\n                        match1: i,\n                        match2: j\n                    }, '', '/uniqueItems', null, data, schema);\n                    if (this.handleError(error)) {\n                        return error;\n                    }\n                }\n            }\n        }\n    }\n    return null;\n};\n\nValidatorContext.prototype.validateArrayItems = function validateArrayItems(data, schema, dataPointerPath) {\n    if (schema.items === undefined) {\n        return null;\n    }\n    var error, i;\n    if (Array.isArray(schema.items)) {\n        for (i = 0; i < data.length; i++) {\n            if (i < schema.items.length) {\n                if (error = this.validateAll(data[i], schema.items[i], [i], [\"items\", i], dataPointerPath + \"/\" + i)) {\n                    return error;\n                }\n            } else if (schema.additionalItems !== undefined) {\n                if (typeof schema.additionalItems === \"boolean\") {\n                    if (!schema.additionalItems) {\n                        error = (this.createError(ErrorCodes.ARRAY_ADDITIONAL_ITEMS, {}, '/' + i, '/additionalItems', null, data, schema));\n                        if (this.handleError(error)) {\n                            return error;\n                        }\n                    }\n                } else if (error = this.validateAll(data[i], schema.additionalItems, [i], [\"additionalItems\"], dataPointerPath + \"/\" + i)) {\n                    return error;\n                }\n            }\n        }\n    } else {\n        for (i = 0; i < data.length; i++) {\n            if (error = this.validateAll(data[i], schema.items, [i], [\"items\"], dataPointerPath + \"/\" + i)) {\n                return error;\n            }\n        }\n    }\n    return null;\n};\n\nValidatorContext.prototype.validateObject = function validateObject(data, schema, dataPointerPath) {\n    if (typeof data !== \"object\" || data === null || Array.isArray(data)) {\n        return null;\n    }\n    return this.validateObjectMinMaxProperties(data, schema, dataPointerPath)\n        || this.validateObjectRequiredProperties(data, schema, dataPointerPath)\n        || this.validateObjectProperties(data, schema, dataPointerPath)\n        || this.validateObjectDependencies(data, schema, dataPointerPath)\n        || null;\n};\n\nValidatorContext.prototype.validateObjectMinMaxProperties = function validateObjectMinMaxProperties(data, schema) {\n    var keys = Object.keys(data);\n    var error;\n    if (schema.minProperties !== undefined) {\n        if (keys.length < schema.minProperties) {\n            error = this.createError(ErrorCodes.OBJECT_PROPERTIES_MINIMUM, {\n                propertyCount: keys.length,\n                minimum: schema.minProperties\n            }, '', '/minProperties', null, data, schema);\n            if (this.handleError(error)) {\n                return error;\n            }\n        }\n    }\n    if (schema.maxProperties !== undefined) {\n        if (keys.length > schema.maxProperties) {\n            error = this.createError(ErrorCodes.OBJECT_PROPERTIES_MAXIMUM, {\n                propertyCount: keys.length,\n                maximum: schema.maxProperties\n            }, '', '/maxProperties', null, data, schema);\n            if (this.handleError(error)) {\n                return error;\n            }\n        }\n    }\n    return null;\n};\n\nValidatorContext.prototype.validateObjectRequiredProperties = function validateObjectRequiredProperties(data, schema) {\n    if (schema.required !== undefined) {\n        for (var i = 0; i < schema.required.length; i++) {\n            var key = schema.required[i];\n            if (data[key] === undefined) {\n                var error = this.createError(ErrorCodes.OBJECT_REQUIRED, {key: key}, '', '/required/' + i, null, data, schema);\n                if (this.handleError(error)) {\n                    return error;\n                }\n            }\n        }\n    }\n    return null;\n};\n\nValidatorContext.prototype.validateObjectProperties = function validateObjectProperties(data, schema, dataPointerPath) {\n    var error;\n    for (var key in data) {\n        var keyPointerPath = dataPointerPath + \"/\" + key.replace(/~/g, '~0').replace(/\\//g, '~1');\n        var foundMatch = false;\n        if (schema.properties !== undefined && schema.properties[key] !== undefined) {\n            foundMatch = true;\n            if (error = this.validateAll(data[key], schema.properties[key], [key], [\"properties\", key], keyPointerPath)) {\n                return error;\n            }\n        }\n        if (schema.patternProperties !== undefined) {\n            for (var patternKey in schema.patternProperties) {\n                var regexp = new RegExp(patternKey);\n                if (regexp.test(key)) {\n                    foundMatch = true;\n                    if (error = this.validateAll(data[key], schema.patternProperties[patternKey], [key], [\"patternProperties\", patternKey], keyPointerPath)) {\n                        return error;\n                    }\n                }\n            }\n        }\n        if (!foundMatch) {\n            if (schema.additionalProperties !== undefined) {\n                if (this.trackUnknownProperties) {\n                    this.knownPropertyPaths[keyPointerPath] = true;\n                    delete this.unknownPropertyPaths[keyPointerPath];\n                }\n                if (typeof schema.additionalProperties === \"boolean\") {\n                    if (!schema.additionalProperties) {\n                        error = this.createError(ErrorCodes.OBJECT_ADDITIONAL_PROPERTIES, {key: key}, '', '/additionalProperties', null, data, schema).prefixWith(key, null);\n                        if (this.handleError(error)) {\n                            return error;\n                        }\n                    }\n                } else {\n                    if (error = this.validateAll(data[key], schema.additionalProperties, [key], [\"additionalProperties\"], keyPointerPath)) {\n                        return error;\n                    }\n                }\n            } else if (this.trackUnknownProperties && !this.knownPropertyPaths[keyPointerPath]) {\n                this.unknownPropertyPaths[keyPointerPath] = true;\n            }\n        } else if (this.trackUnknownProperties) {\n            this.knownPropertyPaths[keyPointerPath] = true;\n            delete this.unknownPropertyPaths[keyPointerPath];\n        }\n    }\n    return null;\n};\n\nValidatorContext.prototype.validateObjectDependencies = function validateObjectDependencies(data, schema, dataPointerPath) {\n    var error;\n    if (schema.dependencies !== undefined) {\n        for (var depKey in schema.dependencies) {\n            if (data[depKey] !== undefined) {\n                var dep = schema.dependencies[depKey];\n                if (typeof dep === \"string\") {\n                    if (data[dep] === undefined) {\n                        error = this.createError(ErrorCodes.OBJECT_DEPENDENCY_KEY, {\n                            key: depKey,\n                            missing: dep\n                        }, '', '', null, data, schema).prefixWith(null, depKey).prefixWith(null, \"dependencies\");\n                        if (this.handleError(error)) {\n                            return error;\n                        }\n                    }\n                } else if (Array.isArray(dep)) {\n                    for (var i = 0; i < dep.length; i++) {\n                        var requiredKey = dep[i];\n                        if (data[requiredKey] === undefined) {\n                            error = this.createError(ErrorCodes.OBJECT_DEPENDENCY_KEY, {\n                                key: depKey,\n                                missing: requiredKey\n                            }, '', '/' + i, null, data, schema).prefixWith(null, depKey).prefixWith(null, \"dependencies\");\n                            if (this.handleError(error)) {\n                                return error;\n                            }\n                        }\n                    }\n                } else {\n                    if (error = this.validateAll(data, dep, [], [\"dependencies\", depKey], dataPointerPath)) {\n                        return error;\n                    }\n                }\n            }\n        }\n    }\n    return null;\n};\n\nValidatorContext.prototype.validateCombinations = function validateCombinations(data, schema, dataPointerPath) {\n    return this.validateAllOf(data, schema, dataPointerPath)\n        || this.validateAnyOf(data, schema, dataPointerPath)\n        || this.validateOneOf(data, schema, dataPointerPath)\n        || this.validateNot(data, schema, dataPointerPath)\n        || null;\n};\n\nValidatorContext.prototype.validateAllOf = function validateAllOf(data, schema, dataPointerPath) {\n    if (schema.allOf === undefined) {\n        return null;\n    }\n    var error;\n    for (var i = 0; i < schema.allOf.length; i++) {\n        var subSchema = schema.allOf[i];\n        if (error = this.validateAll(data, subSchema, [], [\"allOf\", i], dataPointerPath)) {\n            return error;\n        }\n    }\n    return null;\n};\n\nValidatorContext.prototype.validateAnyOf = function validateAnyOf(data, schema, dataPointerPath) {\n    if (schema.anyOf === undefined) {\n        return null;\n    }\n    var errors = [];\n    var startErrorCount = this.errors.length;\n    var oldUnknownPropertyPaths, oldKnownPropertyPaths;\n    if (this.trackUnknownProperties) {\n        oldUnknownPropertyPaths = this.unknownPropertyPaths;\n        oldKnownPropertyPaths = this.knownPropertyPaths;\n    }\n    var errorAtEnd = true;\n    for (var i = 0; i < schema.anyOf.length; i++) {\n        if (this.trackUnknownProperties) {\n            this.unknownPropertyPaths = {};\n            this.knownPropertyPaths = {};\n        }\n        var subSchema = schema.anyOf[i];\n\n        var errorCount = this.errors.length;\n        var error = this.validateAll(data, subSchema, [], [\"anyOf\", i], dataPointerPath);\n\n        if (error === null && errorCount === this.errors.length) {\n            this.errors = this.errors.slice(0, startErrorCount);\n\n            if (this.trackUnknownProperties) {\n                for (var knownKey in this.knownPropertyPaths) {\n                    oldKnownPropertyPaths[knownKey] = true;\n                    delete oldUnknownPropertyPaths[knownKey];\n                }\n                for (var unknownKey in this.unknownPropertyPaths) {\n                    if (!oldKnownPropertyPaths[unknownKey]) {\n                        oldUnknownPropertyPaths[unknownKey] = true;\n                    }\n                }\n                // We need to continue looping so we catch all the property definitions, but we don't want to return an error\n                errorAtEnd = false;\n                continue;\n            }\n\n            return null;\n        }\n        if (error) {\n            errors.push(error.prefixWith(null, \"\" + i).prefixWith(null, \"anyOf\"));\n        }\n    }\n    if (this.trackUnknownProperties) {\n        this.unknownPropertyPaths = oldUnknownPropertyPaths;\n        this.knownPropertyPaths = oldKnownPropertyPaths;\n    }\n    if (errorAtEnd) {\n        errors = errors.concat(this.errors.slice(startErrorCount));\n        this.errors = this.errors.slice(0, startErrorCount);\n        return this.createError(ErrorCodes.ANY_OF_MISSING, {}, \"\", \"/anyOf\", errors, data, schema);\n    }\n};\n\nValidatorContext.prototype.validateOneOf = function validateOneOf(data, schema, dataPointerPath) {\n    if (schema.oneOf === undefined) {\n        return null;\n    }\n    var validIndex = null;\n    var errors = [];\n    var startErrorCount = this.errors.length;\n    var oldUnknownPropertyPaths, oldKnownPropertyPaths;\n    if (this.trackUnknownProperties) {\n        oldUnknownPropertyPaths = this.unknownPropertyPaths;\n        oldKnownPropertyPaths = this.knownPropertyPaths;\n    }\n    for (var i = 0; i < schema.oneOf.length; i++) {\n        if (this.trackUnknownProperties) {\n            this.unknownPropertyPaths = {};\n            this.knownPropertyPaths = {};\n        }\n        var subSchema = schema.oneOf[i];\n\n        var errorCount = this.errors.length;\n        var error = this.validateAll(data, subSchema, [], [\"oneOf\", i], dataPointerPath);\n\n        if (error === null && errorCount === this.errors.length) {\n            if (validIndex === null) {\n                validIndex = i;\n            } else {\n                this.errors = this.errors.slice(0, startErrorCount);\n                return this.createError(ErrorCodes.ONE_OF_MULTIPLE, {\n                    index1: validIndex,\n                    index2: i\n                }, \"\", \"/oneOf\", null, data, schema);\n            }\n            if (this.trackUnknownProperties) {\n                for (var knownKey in this.knownPropertyPaths) {\n                    oldKnownPropertyPaths[knownKey] = true;\n                    delete oldUnknownPropertyPaths[knownKey];\n                }\n                for (var unknownKey in this.unknownPropertyPaths) {\n                    if (!oldKnownPropertyPaths[unknownKey]) {\n                        oldUnknownPropertyPaths[unknownKey] = true;\n                    }\n                }\n            }\n        } else if (error) {\n            errors.push(error);\n        }\n    }\n    if (this.trackUnknownProperties) {\n        this.unknownPropertyPaths = oldUnknownPropertyPaths;\n        this.knownPropertyPaths = oldKnownPropertyPaths;\n    }\n    if (validIndex === null) {\n        errors = errors.concat(this.errors.slice(startErrorCount));\n        this.errors = this.errors.slice(0, startErrorCount);\n        return this.createError(ErrorCodes.ONE_OF_MISSING, {}, \"\", \"/oneOf\", errors, data, schema);\n    } else {\n        this.errors = this.errors.slice(0, startErrorCount);\n    }\n    return null;\n};\n\nValidatorContext.prototype.validateNot = function validateNot(data, schema, dataPointerPath) {\n    if (schema.not === undefined) {\n        return null;\n    }\n    var oldErrorCount = this.errors.length;\n    var oldUnknownPropertyPaths, oldKnownPropertyPaths;\n    if (this.trackUnknownProperties) {\n        oldUnknownPropertyPaths = this.unknownPropertyPaths;\n        oldKnownPropertyPaths = this.knownPropertyPaths;\n        this.unknownPropertyPaths = {};\n        this.knownPropertyPaths = {};\n    }\n    var error = this.validateAll(data, schema.not, null, null, dataPointerPath);\n    var notErrors = this.errors.slice(oldErrorCount);\n    this.errors = this.errors.slice(0, oldErrorCount);\n    if (this.trackUnknownProperties) {\n        this.unknownPropertyPaths = oldUnknownPropertyPaths;\n        this.knownPropertyPaths = oldKnownPropertyPaths;\n    }\n    if (error === null && notErrors.length === 0) {\n        return this.createError(ErrorCodes.NOT_PASSED, {}, \"\", \"/not\", null, data, schema);\n    }\n    return null;\n};\n\nValidatorContext.prototype.validateHypermedia = function validateCombinations(data, schema, dataPointerPath) {\n    if (!schema.links) {\n        return null;\n    }\n    var error;\n    for (var i = 0; i < schema.links.length; i++) {\n        var ldo = schema.links[i];\n        if (ldo.rel === \"describedby\") {\n            var template = new UriTemplate(ldo.href);\n            var allPresent = true;\n            for (var j = 0; j < template.varNames.length; j++) {\n                if (!(template.varNames[j] in data)) {\n                    allPresent = false;\n                    break;\n                }\n            }\n            if (allPresent) {\n                var schemaUrl = template.fillFromObject(data);\n                var subSchema = {\"$ref\": schemaUrl};\n                if (error = this.validateAll(data, subSchema, [], [\"links\", i], dataPointerPath)) {\n                    return error;\n                }\n            }\n        }\n    }\n};\n\n// parseURI() and resolveUrl() are from https://gist.github.com/1088850\n//   -  released as public domain by author (\"Yaffle\") - see comments on gist\n\nfunction parseURI(url) {\n    var m = String(url).replace(/^\\s+|\\s+$/g, '').match(/^([^:\\/?#]+:)?(\\/\\/(?:[^:@]*(?::[^:@]*)?@)?(([^:\\/?#]*)(?::(\\d*))?))?([^?#]*)(\\?[^#]*)?(#[\\s\\S]*)?/);\n    // authority = '//' + user + ':' + pass '@' + hostname + ':' port\n    return (m ? {\n        href: m[0] || '',\n        protocol: m[1] || '',\n        authority: m[2] || '',\n        host: m[3] || '',\n        hostname: m[4] || '',\n        port: m[5] || '',\n        pathname: m[6] || '',\n        search: m[7] || '',\n        hash: m[8] || ''\n    } : null);\n}\n\nfunction resolveUrl(base, href) {// RFC 3986\n\n    function removeDotSegments(input) {\n        var output = [];\n        input.replace(/^(\\.\\.?(\\/|$))+/, '')\n            .replace(/\\/(\\.(\\/|$))+/g, '/')\n            .replace(/\\/\\.\\.$/, '/../')\n            .replace(/\\/?[^\\/]*/g, function (p) {\n                if (p === '/..') {\n                    output.pop();\n                } else {\n                    output.push(p);\n                }\n            });\n        return output.join('').replace(/^\\//, input.charAt(0) === '/' ? '/' : '');\n    }\n\n    href = parseURI(href || '');\n    base = parseURI(base || '');\n\n    return !href || !base ? null : (href.protocol || base.protocol) +\n    (href.protocol || href.authority ? href.authority : base.authority) +\n    removeDotSegments(href.protocol || href.authority || href.pathname.charAt(0) === '/' ? href.pathname : (href.pathname ? ((base.authority && !base.pathname ? '/' : '') + base.pathname.slice(0, base.pathname.lastIndexOf('/') + 1) + href.pathname) : base.pathname)) +\n    (href.protocol || href.authority || href.pathname ? href.search : (href.search || base.search)) +\n    href.hash;\n}\n\nfunction getDocumentUri(uri) {\n    return uri.split('#')[0];\n}\n\nfunction normSchema(schema, baseUri) {\n    if (schema && typeof schema === \"object\") {\n        if (baseUri === undefined) {\n            baseUri = schema.id;\n        } else if (typeof schema.id === \"string\") {\n            baseUri = resolveUrl(baseUri, schema.id);\n            schema.id = baseUri;\n        }\n        if (Array.isArray(schema)) {\n            for (var i = 0; i < schema.length; i++) {\n                normSchema(schema[i], baseUri);\n            }\n        } else {\n            if (typeof schema['$ref'] === \"string\") {\n                schema['$ref'] = resolveUrl(baseUri, schema['$ref']);\n            }\n            for (var key in schema) {\n                if (key !== \"enum\") {\n                    normSchema(schema[key], baseUri);\n                }\n            }\n        }\n    }\n}\n\nfunction defaultErrorReporter(language) {\n    language = language || 'en';\n\n    var errorMessages = languages[language];\n\n    return function (error) {\n        var messageTemplate = errorMessages[error.code] || ErrorMessagesDefault[error.code];\n        if (typeof messageTemplate !== 'string') {\n            return \"Unknown error code \" + error.code + \": \" + JSON.stringify(error.messageParams);\n        }\n        var messageParams = error.params;\n        // Adapted from Crockford's supplant()\n        return messageTemplate.replace(/\\{([^{}]*)\\}/g, function (whole, varName) {\n            var subValue = messageParams[varName];\n            return typeof subValue === 'string' || typeof subValue === 'number' ? subValue : whole;\n        });\n    };\n}\n\nvar ErrorCodes = {\n    INVALID_TYPE: 0,\n    ENUM_MISMATCH: 1,\n    ANY_OF_MISSING: 10,\n    ONE_OF_MISSING: 11,\n    ONE_OF_MULTIPLE: 12,\n    NOT_PASSED: 13,\n    // Numeric errors\n    NUMBER_MULTIPLE_OF: 100,\n    NUMBER_MINIMUM: 101,\n    NUMBER_MINIMUM_EXCLUSIVE: 102,\n    NUMBER_MAXIMUM: 103,\n    NUMBER_MAXIMUM_EXCLUSIVE: 104,\n    NUMBER_NOT_A_NUMBER: 105,\n    // String errors\n    STRING_LENGTH_SHORT: 200,\n    STRING_LENGTH_LONG: 201,\n    STRING_PATTERN: 202,\n    // Object errors\n    OBJECT_PROPERTIES_MINIMUM: 300,\n    OBJECT_PROPERTIES_MAXIMUM: 301,\n    OBJECT_REQUIRED: 302,\n    OBJECT_ADDITIONAL_PROPERTIES: 303,\n    OBJECT_DEPENDENCY_KEY: 304,\n    // Array errors\n    ARRAY_LENGTH_SHORT: 400,\n    ARRAY_LENGTH_LONG: 401,\n    ARRAY_UNIQUE: 402,\n    ARRAY_ADDITIONAL_ITEMS: 403,\n    // Custom/user-defined errors\n    FORMAT_CUSTOM: 500,\n    KEYWORD_CUSTOM: 501,\n    // Schema structure\n    CIRCULAR_REFERENCE: 600,\n    // Non-standard validation options\n    UNKNOWN_PROPERTY: 1000\n};\nvar ErrorCodeLookup = {};\nfor (var key in ErrorCodes) {\n    ErrorCodeLookup[ErrorCodes[key]] = key;\n}\nvar ErrorMessagesDefault = {\n    INVALID_TYPE: \"Invalid type: {type} (expected {expected})\",\n    ENUM_MISMATCH: \"No enum match for: {value}\",\n    ANY_OF_MISSING: \"Data does not match any schemas from \\\"anyOf\\\"\",\n    ONE_OF_MISSING: \"Data does not match any schemas from \\\"oneOf\\\"\",\n    ONE_OF_MULTIPLE: \"Data is valid against more than one schema from \\\"oneOf\\\": indices {index1} and {index2}\",\n    NOT_PASSED: \"Data matches schema from \\\"not\\\"\",\n    // Numeric errors\n    NUMBER_MULTIPLE_OF: \"Value {value} is not a multiple of {multipleOf}\",\n    NUMBER_MINIMUM: \"Value {value} is less than minimum {minimum}\",\n    NUMBER_MINIMUM_EXCLUSIVE: \"Value {value} is equal to exclusive minimum {minimum}\",\n    NUMBER_MAXIMUM: \"Value {value} is greater than maximum {maximum}\",\n    NUMBER_MAXIMUM_EXCLUSIVE: \"Value {value} is equal to exclusive maximum {maximum}\",\n    NUMBER_NOT_A_NUMBER: \"Value {value} is not a valid number\",\n    // String errors\n    STRING_LENGTH_SHORT: \"String is too short ({length} chars), minimum {minimum}\",\n    STRING_LENGTH_LONG: \"String is too long ({length} chars), maximum {maximum}\",\n    STRING_PATTERN: \"String does not match pattern: {pattern}\",\n    // Object errors\n    OBJECT_PROPERTIES_MINIMUM: \"Too few properties defined ({propertyCount}), minimum {minimum}\",\n    OBJECT_PROPERTIES_MAXIMUM: \"Too many properties defined ({propertyCount}), maximum {maximum}\",\n    OBJECT_REQUIRED: \"Missing required property: {key}\",\n    OBJECT_ADDITIONAL_PROPERTIES: \"Additional properties not allowed\",\n    OBJECT_DEPENDENCY_KEY: \"Dependency failed - key must exist: {missing} (due to key: {key})\",\n    // Array errors\n    ARRAY_LENGTH_SHORT: \"Array is too short ({length}), minimum {minimum}\",\n    ARRAY_LENGTH_LONG: \"Array is too long ({length}), maximum {maximum}\",\n    ARRAY_UNIQUE: \"Array items are not unique (indices {match1} and {match2})\",\n    ARRAY_ADDITIONAL_ITEMS: \"Additional items not allowed\",\n    // Format errors\n    FORMAT_CUSTOM: \"Format validation failed ({message})\",\n    KEYWORD_CUSTOM: \"Keyword failed: {key} ({message})\",\n    // Schema structure\n    CIRCULAR_REFERENCE: \"Circular $refs: {urls}\",\n    // Non-standard validation options\n    UNKNOWN_PROPERTY: \"Unknown property (not in schema)\"\n};\n\nfunction ValidationError(code, params, dataPath, schemaPath, subErrors) {\n    Error.call(this);\n    if (code === undefined) {\n        throw new Error(\"No error code supplied: \" + schemaPath);\n    }\n    this.message = '';\n    this.params = params;\n    this.code = code;\n    this.dataPath = dataPath || \"\";\n    this.schemaPath = schemaPath || \"\";\n    this.subErrors = subErrors || null;\n\n    var err = new Error(this.message);\n    this.stack = err.stack || err.stacktrace;\n    if (!this.stack) {\n        try {\n            throw err;\n        }\n        catch (err) {\n            this.stack = err.stack || err.stacktrace;\n        }\n    }\n}\n\nValidationError.prototype = Object.create(Error.prototype);\nValidationError.prototype.constructor = ValidationError;\nValidationError.prototype.name = 'ValidationError';\n\nValidationError.prototype.prefixWith = function (dataPrefix, schemaPrefix) {\n    if (dataPrefix !== null) {\n        dataPrefix = dataPrefix.replace(/~/g, \"~0\").replace(/\\//g, \"~1\");\n        this.dataPath = \"/\" + dataPrefix + this.dataPath;\n    }\n    if (schemaPrefix !== null) {\n        schemaPrefix = schemaPrefix.replace(/~/g, \"~0\").replace(/\\//g, \"~1\");\n        this.schemaPath = \"/\" + schemaPrefix + this.schemaPath;\n    }\n    if (this.subErrors !== null) {\n        for (var i = 0; i < this.subErrors.length; i++) {\n            this.subErrors[i].prefixWith(dataPrefix, schemaPrefix);\n        }\n    }\n    return this;\n};\n\nfunction isTrustedUrl(baseUrl, testUrl) {\n    if (testUrl.substring(0, baseUrl.length) === baseUrl) {\n        var remainder = testUrl.substring(baseUrl.length);\n        if ((testUrl.length > 0 && testUrl.charAt(baseUrl.length - 1) === \"/\")\n            || remainder.charAt(0) === \"#\"\n            || remainder.charAt(0) === \"?\") {\n            return true;\n        }\n    }\n    return false;\n}\n\nvar languages = {};\n\nfunction createApi(language) {\n    var globalContext = new ValidatorContext();\n    var currentLanguage;\n    var customErrorReporter;\n    var api = {\n        setErrorReporter: function (reporter) {\n            if (typeof reporter === 'string') {\n                return this.language(reporter);\n            }\n            customErrorReporter = reporter;\n            return true;\n        },\n        addFormat: function () {\n            globalContext.addFormat.apply(globalContext, arguments);\n        },\n        language: function (code) {\n            if (!code) {\n                return currentLanguage;\n            }\n            if (!languages[code]) {\n                code = code.split('-')[0]; // fall back to base language\n            }\n            if (languages[code]) {\n                currentLanguage = code;\n                return code; // so you can tell if fall-back has happened\n            }\n            return false;\n        },\n        addLanguage: function (code, messageMap) {\n            var key;\n            for (key in ErrorCodes) {\n                if (messageMap[key] && !messageMap[ErrorCodes[key]]) {\n                    messageMap[ErrorCodes[key]] = messageMap[key];\n                }\n            }\n            var rootCode = code.split('-')[0];\n            if (!languages[rootCode]) { // use for base language if not yet defined\n                languages[code] = messageMap;\n                languages[rootCode] = messageMap;\n            } else {\n                languages[code] = Object.create(languages[rootCode]);\n                for (key in messageMap) {\n                    if (typeof languages[rootCode][key] === 'undefined') {\n                        languages[rootCode][key] = messageMap[key];\n                    }\n                    languages[code][key] = messageMap[key];\n                }\n            }\n            return this;\n        },\n        freshApi: function (language) {\n            var result = createApi();\n            if (language) {\n                result.language(language);\n            }\n            return result;\n        },\n        validate: function (data, schema, checkRecursive, banUnknownProperties) {\n            var def = defaultErrorReporter(currentLanguage);\n            var errorReporter = customErrorReporter ? function (error, data, schema) {\n                return customErrorReporter(error, data, schema) || def(error, data, schema);\n            } : def;\n            var context = new ValidatorContext(globalContext, false, errorReporter, checkRecursive, banUnknownProperties);\n            if (typeof schema === \"string\") {\n                schema = {\"$ref\": schema};\n            }\n            context.addSchema(\"\", schema);\n            var error = context.validateAll(data, schema, null, null, \"\");\n            if (!error && banUnknownProperties) {\n                error = context.banUnknownProperties(data, schema);\n            }\n            this.error = error;\n            this.missing = context.missing;\n            this.valid = (error === null);\n            return this.valid;\n        },\n        validateResult: function () {\n            var result = {};\n            this.validate.apply(result, arguments);\n            return result;\n        },\n        validateMultiple: function (data, schema, checkRecursive, banUnknownProperties) {\n            var def = defaultErrorReporter(currentLanguage);\n            var errorReporter = customErrorReporter ? function (error, data, schema) {\n                return customErrorReporter(error, data, schema) || def(error, data, schema);\n            } : def;\n            var context = new ValidatorContext(globalContext, true, errorReporter, checkRecursive, banUnknownProperties);\n            if (typeof schema === \"string\") {\n                schema = {\"$ref\": schema};\n            }\n            context.addSchema(\"\", schema);\n            context.validateAll(data, schema, null, null, \"\");\n            if (banUnknownProperties) {\n                context.banUnknownProperties(data, schema);\n            }\n            var result = {};\n            result.errors = context.errors;\n            result.missing = context.missing;\n            result.valid = (result.errors.length === 0);\n            return result;\n        },\n        addSchema: function () {\n            return globalContext.addSchema.apply(globalContext, arguments);\n        },\n        getSchema: function () {\n            return globalContext.getSchema.apply(globalContext, arguments);\n        },\n        getSchemaMap: function () {\n            return globalContext.getSchemaMap.apply(globalContext, arguments);\n        },\n        getSchemaUris: function () {\n            return globalContext.getSchemaUris.apply(globalContext, arguments);\n        },\n        getMissingUris: function () {\n            return globalContext.getMissingUris.apply(globalContext, arguments);\n        },\n        dropSchemas: function () {\n            globalContext.dropSchemas.apply(globalContext, arguments);\n        },\n        defineKeyword: function () {\n            globalContext.defineKeyword.apply(globalContext, arguments);\n        },\n        defineError: function (codeName, codeNumber, defaultMessage) {\n            if (typeof codeName !== 'string' || !/^[A-Z]+(_[A-Z]+)*$/.test(codeName)) {\n                throw new Error('Code name must be a string in UPPER_CASE_WITH_UNDERSCORES');\n            }\n            if (typeof codeNumber !== 'number' || codeNumber % 1 !== 0 || codeNumber < 10000) {\n                throw new Error('Code number must be an integer > 10000');\n            }\n            if (typeof ErrorCodes[codeName] !== 'undefined') {\n                throw new Error('Error already defined: ' + codeName + ' as ' + ErrorCodes[codeName]);\n            }\n            if (typeof ErrorCodeLookup[codeNumber] !== 'undefined') {\n                throw new Error('Error code already used: ' + ErrorCodeLookup[codeNumber] + ' as ' + codeNumber);\n            }\n            ErrorCodes[codeName] = codeNumber;\n            ErrorCodeLookup[codeNumber] = codeName;\n            ErrorMessagesDefault[codeName] = ErrorMessagesDefault[codeNumber] = defaultMessage;\n            for (var langCode in languages) {\n                var language = languages[langCode];\n                if (language[codeName]) {\n                    language[codeNumber] = language[codeNumber] || language[codeName];\n                }\n            }\n        },\n        reset: function () {\n            globalContext.reset();\n            this.error = null;\n            this.missing = [];\n            this.valid = true;\n        },\n        missing: [],\n        error: null,\n        valid: true,\n        normSchema: normSchema,\n        resolveUrl: resolveUrl,\n        getDocumentUri: getDocumentUri,\n        errorCodes: ErrorCodes\n    };\n    api.language(language || 'en');\n    return api;\n}\n\n//export function validator() {\nvar tv4 = createApi();\ntv4.addLanguage('en-gb', ErrorMessagesDefault);\n\n//legacy property\ntv4.tv4 = tv4;\n//return tv4;\nexport default tv4;\n//}"],"sourceRoot":"/source/"}
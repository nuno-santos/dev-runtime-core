/**
* Copyright 2016 PT Inovação e Sistemas SA
* Copyright 2016 INESC-ID
* Copyright 2016 QUOBIS NETWORKS SL
* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V
* Copyright 2016 ORANGE SA
* Copyright 2016 Deutsche Telekom AG
* Copyright 2016 Apizee
* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
**/

// Distribution file for PolicyEngine.js 
// version: 0.6.0
// Last build: Fri Sep 23 2016 15:07:17 GMT+0100 (WEST)

!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.PolicyEngine=e()}}(function(){return function e(t,r,o){function n(s,u){if(!r[s]){if(!t[s]){var l="function"==typeof require&&require;if(!u&&l)return l(s,!0);if(i)return i(s,!0);var a=new Error("Cannot find module '"+s+"'");throw a.code="MODULE_NOT_FOUND",a}var c=r[s]={exports:{}};t[s][0].call(c.exports,function(e){var r=t[s][1][e];return n(r?r:e)},c,c.exports,e,t,r,o)}return r[s].exports}for(var i="function"==typeof require&&require,s=0;s<o.length;s++)n(o[s]);return n}({1:[function(e,t,r){t.exports={default:e("core-js/library/fn/json/stringify"),__esModule:!0}},{"core-js/library/fn/json/stringify":15}],2:[function(e,t,r){t.exports={default:e("core-js/library/fn/object/create"),__esModule:!0}},{"core-js/library/fn/object/create":16}],3:[function(e,t,r){t.exports={default:e("core-js/library/fn/object/define-property"),__esModule:!0}},{"core-js/library/fn/object/define-property":17}],4:[function(e,t,r){t.exports={default:e("core-js/library/fn/object/get-own-property-descriptor"),__esModule:!0}},{"core-js/library/fn/object/get-own-property-descriptor":18}],5:[function(e,t,r){t.exports={default:e("core-js/library/fn/object/get-prototype-of"),__esModule:!0}},{"core-js/library/fn/object/get-prototype-of":19}],6:[function(e,t,r){t.exports={default:e("core-js/library/fn/object/keys"),__esModule:!0}},{"core-js/library/fn/object/keys":20}],7:[function(e,t,r){t.exports={default:e("core-js/library/fn/object/set-prototype-of"),__esModule:!0}},{"core-js/library/fn/object/set-prototype-of":21}],8:[function(e,t,r){t.exports={default:e("core-js/library/fn/symbol"),__esModule:!0}},{"core-js/library/fn/symbol":22}],9:[function(e,t,r){"use strict";r.__esModule=!0,r.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},{}],10:[function(e,t,r){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}r.__esModule=!0;var n=e("../core-js/object/define-property"),i=o(n);r.default=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),(0,i.default)(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}()},{"../core-js/object/define-property":3}],11:[function(e,t,r){"use strict";var o=e("babel-runtime/core-js/object/get-own-property-descriptor").default;r.default=function(e,t,r){for(var n=!0;n;){var i=e,s=t,u=r;n=!1,null===i&&(i=Function.prototype);var l=o(i,s);if(void 0!==l){if("value"in l)return l.value;var a=l.get;if(void 0===a)return;return a.call(u)}var c=Object.getPrototypeOf(i);if(null===c)return;e=c,t=s,r=u,n=!0,l=c=void 0}},r.__esModule=!0},{"babel-runtime/core-js/object/get-own-property-descriptor":4}],12:[function(e,t,r){"use strict";var o=e("babel-runtime/core-js/object/create").default,n=e("babel-runtime/core-js/object/set-prototype-of").default;r.default=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=o(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(n?n(e,t):e.__proto__=t)},r.__esModule=!0},{"babel-runtime/core-js/object/create":2,"babel-runtime/core-js/object/set-prototype-of":7}],13:[function(e,t,r){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}r.__esModule=!0;var n=e("../helpers/typeof"),i=o(n);r.default=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":(0,i.default)(t))&&"function"!=typeof t?e:t}},{"../helpers/typeof":14}],14:[function(e,t,r){"use strict";var o=e("babel-runtime/core-js/symbol").default;r.default=function(e){return e&&e.constructor===o?"symbol":typeof e},r.__esModule=!0},{"babel-runtime/core-js/symbol":8}],15:[function(e,t,r){var o=e("../../modules/$.core");t.exports=function(e){return(o.JSON&&o.JSON.stringify||JSON.stringify).apply(JSON,arguments)}},{"../../modules/$.core":26}],16:[function(e,t,r){var o=e("../../modules/$");t.exports=function(e,t){return o.create(e,t)}},{"../../modules/$":40}],17:[function(e,t,r){var o=e("../../modules/$");t.exports=function(e,t,r){return o.setDesc(e,t,r)}},{"../../modules/$":40}],18:[function(e,t,r){var o=e("../../modules/$");e("../../modules/es6.object.get-own-property-descriptor"),t.exports=function(e,t){return o.getDesc(e,t)}},{"../../modules/$":40,"../../modules/es6.object.get-own-property-descriptor":53}],19:[function(e,t,r){e("../../modules/es6.object.get-prototype-of"),t.exports=e("../../modules/$.core").Object.getPrototypeOf},{"../../modules/$.core":26,"../../modules/es6.object.get-prototype-of":54}],20:[function(e,t,r){e("../../modules/es6.object.keys"),t.exports=e("../../modules/$.core").Object.keys},{"../../modules/$.core":26,"../../modules/es6.object.keys":55}],21:[function(e,t,r){e("../../modules/es6.object.set-prototype-of"),t.exports=e("../../modules/$.core").Object.setPrototypeOf},{"../../modules/$.core":26,"../../modules/es6.object.set-prototype-of":56}],22:[function(e,t,r){e("../../modules/es6.symbol"),e("../../modules/es6.object.to-string"),t.exports=e("../../modules/$.core").Symbol},{"../../modules/$.core":26,"../../modules/es6.object.to-string":57,"../../modules/es6.symbol":58}],23:[function(e,t,r){t.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},{}],24:[function(e,t,r){var o=e("./$.is-object");t.exports=function(e){if(!o(e))throw TypeError(e+" is not an object!");return e}},{"./$.is-object":39}],25:[function(e,t,r){var o={}.toString;t.exports=function(e){return o.call(e).slice(8,-1)}},{}],26:[function(e,t,r){var o=t.exports={version:"1.2.6"};"number"==typeof __e&&(__e=o)},{}],27:[function(e,t,r){var o=e("./$.a-function");t.exports=function(e,t,r){if(o(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,o){return e.call(t,r,o)};case 3:return function(r,o,n){return e.call(t,r,o,n)}}return function(){return e.apply(t,arguments)}}},{"./$.a-function":23}],28:[function(e,t,r){t.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},{}],29:[function(e,t,r){t.exports=!e("./$.fails")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},{"./$.fails":32}],30:[function(e,t,r){var o=e("./$");t.exports=function(e){var t=o.getKeys(e),r=o.getSymbols;if(r)for(var n,i=r(e),s=o.isEnum,u=0;i.length>u;)s.call(e,n=i[u++])&&t.push(n);return t}},{"./$":40}],31:[function(e,t,r){var o=e("./$.global"),n=e("./$.core"),i=e("./$.ctx"),s="prototype",u=function(e,t,r){var l,a,c,f=e&u.F,p=e&u.G,b=e&u.S,d=e&u.P,h=e&u.B,y=e&u.W,m=p?n:n[t]||(n[t]={}),v=p?o:b?o[t]:(o[t]||{})[s];p&&(r=t);for(l in r)a=!f&&v&&l in v,a&&l in m||(c=a?v[l]:r[l],m[l]=p&&"function"!=typeof v[l]?r[l]:h&&a?i(c,o):y&&v[l]==c?function(e){var t=function(t){return this instanceof e?new e(t):e(t)};return t[s]=e[s],t}(c):d&&"function"==typeof c?i(Function.call,c):c,d&&((m[s]||(m[s]={}))[l]=c))};u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,t.exports=u},{"./$.core":26,"./$.ctx":27,"./$.global":34}],32:[function(e,t,r){t.exports=function(e){try{return!!e()}catch(e){return!0}}},{}],33:[function(e,t,r){var o=e("./$.to-iobject"),n=e("./$").getNames,i={}.toString,s="object"==typeof window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],u=function(e){try{return n(e)}catch(e){return s.slice()}};t.exports.get=function(e){return s&&"[object Window]"==i.call(e)?u(e):n(o(e))}},{"./$":40,"./$.to-iobject":49}],34:[function(e,t,r){var o=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=o)},{}],35:[function(e,t,r){var o={}.hasOwnProperty;t.exports=function(e,t){return o.call(e,t)}},{}],36:[function(e,t,r){var o=e("./$"),n=e("./$.property-desc");t.exports=e("./$.descriptors")?function(e,t,r){return o.setDesc(e,t,n(1,r))}:function(e,t,r){return e[t]=r,e}},{"./$":40,"./$.descriptors":29,"./$.property-desc":44}],37:[function(e,t,r){var o=e("./$.cof");t.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==o(e)?e.split(""):Object(e)}},{"./$.cof":25}],38:[function(e,t,r){var o=e("./$.cof");t.exports=Array.isArray||function(e){return"Array"==o(e)}},{"./$.cof":25}],39:[function(e,t,r){t.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},{}],40:[function(e,t,r){var o=Object;t.exports={create:o.create,getProto:o.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:o.getOwnPropertyDescriptor,setDesc:o.defineProperty,setDescs:o.defineProperties,getKeys:o.keys,getNames:o.getOwnPropertyNames,getSymbols:o.getOwnPropertySymbols,each:[].forEach}},{}],41:[function(e,t,r){var o=e("./$"),n=e("./$.to-iobject");t.exports=function(e,t){for(var r,i=n(e),s=o.getKeys(i),u=s.length,l=0;u>l;)if(i[r=s[l++]]===t)return r}},{"./$":40,"./$.to-iobject":49}],42:[function(e,t,r){t.exports=!0},{}],43:[function(e,t,r){var o=e("./$.export"),n=e("./$.core"),i=e("./$.fails");t.exports=function(e,t){var r=(n.Object||{})[e]||Object[e],s={};s[e]=t(r),o(o.S+o.F*i(function(){r(1)}),"Object",s)}},{"./$.core":26,"./$.export":31,"./$.fails":32}],44:[function(e,t,r){t.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},{}],45:[function(e,t,r){t.exports=e("./$.hide")},{"./$.hide":36}],46:[function(e,t,r){var o=e("./$").getDesc,n=e("./$.is-object"),i=e("./$.an-object"),s=function(e,t){if(i(e),!n(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,r,n){try{n=e("./$.ctx")(Function.call,o(Object.prototype,"__proto__").set,2),n(t,[]),r=!(t instanceof Array)}catch(e){r=!0}return function(e,t){return s(e,t),r?e.__proto__=t:n(e,t),e}}({},!1):void 0),check:s}},{"./$":40,"./$.an-object":24,"./$.ctx":27,"./$.is-object":39}],47:[function(e,t,r){var o=e("./$").setDesc,n=e("./$.has"),i=e("./$.wks")("toStringTag");t.exports=function(e,t,r){e&&!n(e=r?e:e.prototype,i)&&o(e,i,{configurable:!0,value:t})}},{"./$":40,"./$.has":35,"./$.wks":52}],48:[function(e,t,r){var o=e("./$.global"),n="__core-js_shared__",i=o[n]||(o[n]={});t.exports=function(e){return i[e]||(i[e]={})}},{"./$.global":34}],49:[function(e,t,r){var o=e("./$.iobject"),n=e("./$.defined");t.exports=function(e){return o(n(e))}},{"./$.defined":28,"./$.iobject":37}],50:[function(e,t,r){var o=e("./$.defined");t.exports=function(e){return Object(o(e))}},{"./$.defined":28}],51:[function(e,t,r){var o=0,n=Math.random();t.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++o+n).toString(36))}},{}],52:[function(e,t,r){var o=e("./$.shared")("wks"),n=e("./$.uid"),i=e("./$.global").Symbol;t.exports=function(e){return o[e]||(o[e]=i&&i[e]||(i||n)("Symbol."+e))}},{"./$.global":34,"./$.shared":48,"./$.uid":51}],53:[function(e,t,r){var o=e("./$.to-iobject");e("./$.object-sap")("getOwnPropertyDescriptor",function(e){return function(t,r){return e(o(t),r)}})},{"./$.object-sap":43,"./$.to-iobject":49}],54:[function(e,t,r){var o=e("./$.to-object");e("./$.object-sap")("getPrototypeOf",function(e){return function(t){return e(o(t))}})},{"./$.object-sap":43,"./$.to-object":50}],55:[function(e,t,r){var o=e("./$.to-object");e("./$.object-sap")("keys",function(e){return function(t){return e(o(t))}})},{"./$.object-sap":43,"./$.to-object":50}],56:[function(e,t,r){var o=e("./$.export");o(o.S,"Object",{setPrototypeOf:e("./$.set-proto").set})},{"./$.export":31,"./$.set-proto":46}],57:[function(e,t,r){},{}],58:[function(e,t,r){"use strict";var o=e("./$"),n=e("./$.global"),i=e("./$.has"),s=e("./$.descriptors"),u=e("./$.export"),l=e("./$.redefine"),a=e("./$.fails"),c=e("./$.shared"),f=e("./$.set-to-string-tag"),p=e("./$.uid"),b=e("./$.wks"),d=e("./$.keyof"),h=e("./$.get-names"),y=e("./$.enum-keys"),m=e("./$.is-array"),v=e("./$.an-object"),g=e("./$.to-iobject"),j=e("./$.property-desc"),$=o.getDesc,_=o.setDesc,x=o.create,P=h.get,C=n.Symbol,k=n.JSON,O=k&&k.stringify,w=!1,R=b("_hidden"),S=o.isEnum,M=c("symbol-registry"),U=c("symbols"),A="function"==typeof C,E=Object.prototype,D=s&&a(function(){return 7!=x(_({},"a",{get:function(){return _(this,"a",{value:7}).a}})).a})?function(e,t,r){var o=$(E,t);o&&delete E[t],_(e,t,r),o&&e!==E&&_(E,t,o)}:_,L=function(e){var t=U[e]=x(C.prototype);return t._k=e,s&&w&&D(E,e,{configurable:!0,set:function(t){i(this,R)&&i(this[R],e)&&(this[R][e]=!1),D(this,e,j(1,t))}}),t},N=function(e){return"symbol"==typeof e},F=function(e,t,r){return r&&i(U,t)?(r.enumerable?(i(e,R)&&e[R][t]&&(e[R][t]=!1),r=x(r,{enumerable:j(0,!1)})):(i(e,R)||_(e,R,j(1,{})),e[R][t]=!0),D(e,t,r)):_(e,t,r)},G=function(e,t){v(e);for(var r,o=y(t=g(t)),n=0,i=o.length;i>n;)F(e,r=o[n++],t[r]);return e},T=function(e,t){return void 0===t?x(e):G(x(e),t)},I=function(e){var t=S.call(this,e);return!(t||!i(this,e)||!i(U,e)||i(this,R)&&this[R][e])||t},J=function(e,t){var r=$(e=g(e),t);return!r||!i(U,t)||i(e,R)&&e[R][t]||(r.enumerable=!0),r},H=function(e){for(var t,r=P(g(e)),o=[],n=0;r.length>n;)i(U,t=r[n++])||t==R||o.push(t);return o},V=function(e){for(var t,r=P(g(e)),o=[],n=0;r.length>n;)i(U,t=r[n++])&&o.push(U[t]);return o},q=function(e){if(void 0!==e&&!N(e)){for(var t,r,o=[e],n=1,i=arguments;i.length>n;)o.push(i[n++]);return t=o[1],"function"==typeof t&&(r=t),!r&&m(t)||(t=function(e,t){if(r&&(t=r.call(this,e,t)),!N(t))return t}),o[1]=t,O.apply(k,o)}},z=a(function(){var e=C();return"[null]"!=O([e])||"{}"!=O({a:e})||"{}"!=O(Object(e))});A||(C=function(){if(N(this))throw TypeError("Symbol is not a constructor");return L(p(arguments.length>0?arguments[0]:void 0))},l(C.prototype,"toString",function(){return this._k}),N=function(e){return e instanceof C},o.create=T,o.isEnum=I,o.getDesc=J,o.setDesc=F,o.setDescs=G,o.getNames=h.get=H,o.getSymbols=V,s&&!e("./$.library")&&l(E,"propertyIsEnumerable",I,!0));var W={for:function(e){return i(M,e+="")?M[e]:M[e]=C(e)},keyFor:function(e){return d(M,e)},useSetter:function(){w=!0},useSimple:function(){w=!1}};o.each.call("hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),function(e){var t=b(e);W[e]=A?t:L(t)}),w=!0,u(u.G+u.W,{Symbol:C}),u(u.S,"Symbol",W),u(u.S+u.F*!A,"Object",{create:T,defineProperty:F,defineProperties:G,getOwnPropertyDescriptor:J,getOwnPropertyNames:H,getOwnPropertySymbols:V}),k&&u(u.S+u.F*(!A||z),"JSON",{stringify:q}),f(C,"Symbol"),f(Math,"Math",!0),f(n.JSON,"JSON",!0)},{"./$":40,"./$.an-object":24,"./$.descriptors":29,"./$.enum-keys":30,"./$.export":31,"./$.fails":32,"./$.get-names":33,"./$.global":34,"./$.has":35,"./$.is-array":38,"./$.keyof":41,"./$.library":42,"./$.property-desc":44,"./$.redefine":45,"./$.set-to-string-tag":47,"./$.shared":48,"./$.to-iobject":49,"./$.uid":51,"./$.wks":52}],59:[function(e,t,r){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("babel-runtime/helpers/classCallCheck"),i=o(n),s=function e(){(0,i.default)(this,e)};r.default=s,t.exports=r.default},{"babel-runtime/helpers/classCallCheck":9}],60:[function(e,t,r){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("babel-runtime/helpers/classCallCheck"),i=o(n),s=e("babel-runtime/helpers/createClass"),u=o(s),l=function(){function e(){(0,i.default)(this,e)}return(0,u.default)(e,[{key:"and",value:function(e){return e[0]&&e[1]}},{key:"between",value:function(e){var t=parseInt(e[0][0]),r=parseInt(e[0][1]),o=e[1];return r<t&&(o=o<t?o+=2400:o,r+=2400),o>t&&o<r}},{key:"equals",value:function(e){return"*"==e[0]||e[0]==e[1]}},{key:"greaterThan",value:function(e){return e[1]>e[0]}},{key:"in",value:function(e){return e[0].indexOf(e[1])>-1}},{key:"lessThan",value:function(e){return e[1]<e[0]}},{key:"not",value:function(e){return!e[0]}},{key:"or",value:function(e){return e[0]||e[1]}}]),e}();r.default=l,t.exports=r.default},{"babel-runtime/helpers/classCallCheck":9,"babel-runtime/helpers/createClass":10}],61:[function(e,t,r){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("babel-runtime/helpers/classCallCheck"),i=o(n),s=e("babel-runtime/helpers/createClass"),u=o(s),l=e("./Operators"),a=o(l),c=function(){function e(t){(0,i.default)(this,e),this.context=t,this.operators=new a.default}return(0,u.default)(e,[{key:"applyPolicies",value:function(e,t){var r=this.evaluateSPPolicy(e,t.serviceProviderPolicy);if(r||void 0===r||"Not Applicable"===r){var o=this.evaluateUserPolicy(e,t.userPolicy);void 0!==o&&(r=o)}return r}},{key:"evaluateSPPolicy",value:function(e,t){var r=void 0;return t&&(r=t.evaluate(this.context,e)),r}},{key:"evaluateUserPolicy",value:function(e,t){var r=void 0;if(void 0!==t){var o=this.context.userPolicies[t];o&&(r=o.evaluate(this.context,e))}return r}},{key:"context",get:function(){return this._context},set:function(e){this._context=e}},{key:"operators",get:function(){return this._operators},set:function(e){this._operators=e}}]),e}();r.default=c,t.exports=r.default},{"./Operators":60,"babel-runtime/helpers/classCallCheck":9,"babel-runtime/helpers/createClass":10}],62:[function(e,t,r){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("babel-runtime/helpers/classCallCheck"),i=o(n),s=e("babel-runtime/helpers/createClass"),u=o(s),l=function(){function e(t){(0,i.default)(this,e),this.context=t}return(0,u.default)(e,[{key:"enforcePolicies",value:function(e,t,r){var o=void 0;t.userPolicy&&(o=this.context.userPolicies[t.userPolicy],o&&o.enforceActions(this.context,e,r)),o=this.context.serviceProviderPolicy,o&&o.enforceActions(this.context,e,r)}}]),e}();r.default=l,t.exports=r.default},{"babel-runtime/helpers/classCallCheck":9,"babel-runtime/helpers/createClass":10}],63:[function(e,t,r){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("babel-runtime/helpers/classCallCheck"),i=o(n),s=e("babel-runtime/helpers/createClass"),u=o(s),l=e("./combiningAlgorithms/DenyOverrides"),a=o(l),c=e("./combiningAlgorithms/FirstApplicable"),f=o(c),p=function(){function e(t,r,o,n){(0,i.default)(this,e),this.actions=o,this.key=t,this.rules=r,this.combiningAlgorithm=n}return(0,u.default)(e,[{key:"enforceActions",value:function(e,t,r){for(var o in this.actions)e[this.actions[o]](t,r)}},{key:"evaluate",value:function(e,t){var r=[];for(var o in this.rules)r.push(this.rules[o].evaluate(e,t));return this.combiningAlgorithm.evaluate(r)}},{key:"combiningAlgorithm",get:function(){return this._combiningAlgorithm},set:function(e){if("denyOverrides"===e)this._combiningAlgorithm=new a.default;else{if("firstApplicable"!==e)throw Error("Unknown algorithm: "+e);this._combiningAlgorithm=new f.default}}}]),e}();r.default=p,t.exports=r.default},{"./combiningAlgorithms/DenyOverrides":66,"./combiningAlgorithms/FirstApplicable":67,"babel-runtime/helpers/classCallCheck":9,"babel-runtime/helpers/createClass":10}],64:[function(e,t,r){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("babel-runtime/helpers/classCallCheck"),i=o(n),s=e("babel-runtime/helpers/createClass"),u=o(s),l=e("./PEP"),a=o(l),c=e("./PDP"),f=o(c),p=e("./policies/UserPolicy"),b=o(p),d=function(){function e(t){(0,i.default)(this,e),this.context=t,t.policyEngine=this,t.loadActivePolicy(),t.loadGroups(),t.loadSPPolicies(),t.loadUserPolicies(),this.pdp=new f.default(t),this.pep=new a.default(t)}return(0,u.default)(e,[{key:"addPolicy",value:function(e,t,r){if("SERVICE_PROVIDER"===e)this.context.serviceProviderPolicies[t]=r,this.context.savePolicies(e);else{if("USER"!==e)throw Error("Unknown policy source: "+e);r||(r=new b.default(t,[],[])),this.context.userPolicies[t]=r,this.context.savePolicies(e)}}},{key:"removePolicy",value:function(e,t){if("*"===e)this.context.serviceProviderPolicies={},this.context.userPolicies={},this.context.activeUserPolicy=void 0;else if("SERVICE_PROVIDER"===e)delete this.context.serviceProviderPolicies[t];else{if("USER"!==e)throw Error("Unknown policy source: "+e);delete this.context.userPolicies[t],t===this.context.activeUserPolicy&&(this.context.activeUserPolicy=void 0)}this.context.savePolicies("USER"),this.context.savePolicies("SERVICE_PROVIDER"),this.context.saveActivePolicy()}},{key:"removeRule",value:function(e,t){delete this.context.userPolicies[e][t.scope][t.target][t.condition]}},{key:"authorise",value:function(e){var t=this;return t.context.authorise(e)}},{key:"getGroupsNames",value:function(){var e=this.context.groups,t=[];if(void 0!==e)for(var r in e)t.push(r);return t}},{key:"getGroup",value:function(e){var t=this.context.groups,r=[];return void 0!==t[e]&&(r=t[e]),r}},{key:"createGroup",value:function(e){this.context.groups[e]=[],this.context.saveGroups()}},{key:"deleteGroup",value:function(e){delete this.context.groups[e],this.context.saveGroups()}},{key:"addToGroup",value:function(e,t){var r=this.context.groups;if(void 0===r[e])throw Error('Group "'+e+'" does not exist!');r[e].indexOf(t)===-1&&(r[e].push(t),this.context.saveGroups())}},{key:"removeFromGroup",value:function(e,t){var r=this.context.groups[e];r.splice(r.indexOf(t),1),this.context.saveGroups()}}]),e}();r.default=d,t.exports=r.default},{"./PDP":61,"./PEP":62,"./policies/UserPolicy":71,"babel-runtime/helpers/classCallCheck":9,"babel-runtime/helpers/createClass":10}],65:[function(e,t,r){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("babel-runtime/helpers/classCallCheck"),i=o(n),s=e("babel-runtime/helpers/createClass"),u=o(s),l=e("../utils/utils"),a=e("./Operators"),c=o(a),f=function(){function e(t,r,o,n,s){(0,i.default)(this,e),this.operators=new c.default,this.authorise=t,this.condition=r,this.priority=o,this.scope=n,this.target=s}return(0,u.default)(e,[{key:"evaluate",value:function(e,t){var r=void 0;switch(this.scope){case"global":break;case"hyperty":if((0,l.isDataObjectURL)(t.from)){var o=e.runtimeRegistry.getReporterURLSynchonous((0,l.removePathFromURL)(t.from));void 0!==o&&(r=e.runtimeRegistry.getHypertyName(o))}else"hyperty"===t.from.split("://")[0]&&(r=e.runtimeRegistry.getHypertyName((0,l.removePathFromURL)(t.from)));if(r===this.target)break;if((0,l.isDataObjectURL)(t.to)){var n=e.runtimeRegistry.getReporterURLSynchonous((0,l.removePathFromURL)(t.to));void 0!==n&&(r=e.runtimeRegistry.getHypertyName(n))}else"hyperty"===t.to.split("://")[0]&&(r=e.runtimeRegistry.getHypertyName((0,l.removePathFromURL)(t.to)));if(r===this.target)break;return"Not Applicable";case"user":var i=void 0;if((0,l.isDataObjectURL)(t.from)){var s=e.runtimeRegistry.getReporterURLSynchonous((0,l.removePathFromURL)(t.from));i=e.runtimeRegistry.getHypertyOwner(s)}else"hyperty"===t.from.split("://")[0]&&(i=e.runtimeRegistry.getHypertyOwner((0,l.removePathFromURL)(t.from)));if(void 0!==i&&(i=(0,l.getUserEmailFromURL)(i)),i===this.target)break;if((0,l.isDataObjectURL)(t.to)){var u=e.runtimeRegistry.getReporterURLSynchonous((0,l.removePathFromURL)(t.to));i=e.runtimeRegistry.getHypertyOwner(u),void 0!==i&&(i=(0,l.getUserEmailFromURL)(i))}else"hyperty"===t.to.split("://")[0]&&(i=e.runtimeRegistry.getHypertyOwner((0,l.removePathFromURL)(t.to)),void 0!==i&&(i=(0,l.getUserEmailFromURL)(i)));if(i===this.target)break;return"Not Applicable"}return this.condition.isApplicable(e,t,this.scope,this.target)?this.authorise:"Not Applicable"}}]),e}();r.default=f,t.exports=r.default},{"../utils/utils":72,"./Operators":60,"babel-runtime/helpers/classCallCheck":9,"babel-runtime/helpers/createClass":10}],66:[function(e,t,r){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("babel-runtime/core-js/object/get-prototype-of"),i=o(n),s=e("babel-runtime/helpers/classCallCheck"),u=o(s),l=e("babel-runtime/helpers/createClass"),a=o(l),c=e("babel-runtime/helpers/possibleConstructorReturn"),f=o(c),p=e("babel-runtime/helpers/inherits"),b=o(p),d=e("../CombiningAlgorithm"),h=o(d),y=function(e){function t(){return(0,u.default)(this,t),(0,f.default)(this,(0,i.default)(t).apply(this,arguments))}return(0,b.default)(t,e),(0,a.default)(t,[{key:"evaluate",value:function(e){return e.indexOf(!1)===-1&&(e.indexOf(!0)!==-1||"Not Applicable")}}]),t}(h.default);r.default=y,t.exports=r.default},{"../CombiningAlgorithm":59,"babel-runtime/core-js/object/get-prototype-of":5,"babel-runtime/helpers/classCallCheck":9,"babel-runtime/helpers/createClass":10,"babel-runtime/helpers/inherits":12,"babel-runtime/helpers/possibleConstructorReturn":13}],67:[function(e,t,r){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("babel-runtime/core-js/object/get-prototype-of"),i=o(n),s=e("babel-runtime/helpers/classCallCheck"),u=o(s),l=e("babel-runtime/helpers/createClass"),a=o(l),c=e("babel-runtime/helpers/possibleConstructorReturn"),f=o(c),p=e("babel-runtime/helpers/inherits"),b=o(p),d=e("../CombiningAlgorithm"),h=o(d),y=function(e){function t(){return(0,u.default)(this,t),(0,f.default)(this,(0,i.default)(t).apply(this,arguments))}return(0,b.default)(t,e),(0,a.default)(t,[{key:"evaluate",value:function(e){for(var t in e)if("Not Applicable"!==e[t])return e[t];return"Not Applicable"}}]),t}(h.default);r.default=y,t.exports=r.default},{"../CombiningAlgorithm":59,"babel-runtime/core-js/object/get-prototype-of":5,"babel-runtime/helpers/classCallCheck":9,"babel-runtime/helpers/createClass":10,"babel-runtime/helpers/inherits":12,"babel-runtime/helpers/possibleConstructorReturn":13}],68:[function(e,t,r){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("babel-runtime/helpers/classCallCheck"),i=o(n),s=e("babel-runtime/helpers/createClass"),u=o(s),l=e("./Condition"),a=o(l),c=e("../Operators"),f=o(c),p=e("./SubscriptionCondition"),b=o(p),d=function(){function e(t){(0,i.default)(this,e),this.operators=new f.default,this.condition=t}return(0,u.default)(e,[{key:"isApplicable",value:function(e,t,r,o,n,i,s){for(n||(n=this.condition[0],i=this.condition[1],s=this.condition[2]);!(i instanceof a.default)&!(i instanceof b.default)&"boolean"!=typeof i;)i=this.isApplicable(e,t,r,o,i[0],i[1],i[2]);if(void 0!==s)for(;!(s instanceof a.default)&!(s instanceof b.default)&"boolean"!=typeof s;)s=this.isApplicable(e,t,r,o,s[0],s[1],s[2]);var u="boolean"==typeof i?i:i.isApplicable(e,t,r,o),l=void 0;return void 0!==s&&(l="boolean"==typeof s?s:s.isApplicable(e,t,r,o)),this.operators[n]([u,l])}}]),e}();r.default=d,t.exports=r.default},{"../Operators":60,"./Condition":69,"./SubscriptionCondition":70,"babel-runtime/helpers/classCallCheck":9,"babel-runtime/helpers/createClass":10}],69:[function(e,t,r){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("babel-runtime/helpers/classCallCheck"),i=o(n),s=e("babel-runtime/helpers/createClass"),u=o(s),l=e("../Operators"),a=o(l),c=function(){function e(t,r,o){(0,i.default)(this,e),this.attribute=t,this.operator=r,this.params=o,this.operators=new a.default}return(0,u.default)(e,[{key:"isApplicable",value:function(e,t){e[this.attribute]={message:t};var r=e[this.attribute],o=void 0;if("in"===this.operator)if("preauthorised"===this.params){var n=t.to.split("/");n.pop(),n=n[0]+"//"+n[2],o=e.runtimeRegistry.getPreAuthSubscribers(n)}else o=e.policyEngine.getGroup(this.params);return o?this.operators[this.operator]([o,r]):this.operators[this.operator]([this.params,r])}}]),e}();r.default=c,t.exports=r.default},{"../Operators":60,"babel-runtime/helpers/classCallCheck":9,"babel-runtime/helpers/createClass":10}],70:[function(e,t,r){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("babel-runtime/core-js/object/get-prototype-of"),i=o(n),s=e("babel-runtime/helpers/classCallCheck"),u=o(s),l=e("babel-runtime/helpers/createClass"),a=o(l),c=e("babel-runtime/helpers/possibleConstructorReturn"),f=o(c),p=e("babel-runtime/helpers/get"),b=o(p),d=e("babel-runtime/helpers/inherits"),h=o(d),y=e("./Condition"),m=o(y),v=function(e){function t(e,r,o){return(0,u.default)(this,t),(0,f.default)(this,(0,i.default)(t).call(this,e,r,o))}return(0,h.default)(t,e),(0,a.default)(t,[{key:"isApplicable",value:function(e,r,o,n){var s="subscribe"===r.type,u=e.isFromRemoteSM(r.from);return!!(s&u)&&(0,b.default)((0,i.default)(t.prototype),"isApplicable",this).call(this,e,r)}}]),t}(m.default);r.default=v,t.exports=r.default},{"./Condition":69,"babel-runtime/core-js/object/get-prototype-of":5,"babel-runtime/helpers/classCallCheck":9,"babel-runtime/helpers/createClass":10,"babel-runtime/helpers/get":11,"babel-runtime/helpers/inherits":12,"babel-runtime/helpers/possibleConstructorReturn":13}],71:[function(e,t,r){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("babel-runtime/core-js/object/get-prototype-of"),i=o(n),s=e("babel-runtime/helpers/classCallCheck"),u=o(s),l=e("babel-runtime/helpers/createClass"),a=o(l),c=e("babel-runtime/helpers/possibleConstructorReturn"),f=o(c),p=e("babel-runtime/helpers/inherits"),b=o(p),d=e("../conditions/AdvancedCondition"),h=o(d),y=e("../conditions/Condition"),m=o(y),v=e("../Policy"),g=o(v),j=e("../Rule"),$=o(j),_=e("../conditions/SubscriptionCondition"),x=o(_),P=function(e){function t(e,r,o,n){return(0,u.default)(this,t),n||(n="denyOverrides"),(0,f.default)(this,(0,i.default)(t).call(this,e,r,o,n))}return(0,b.default)(t,e),(0,a.default)(t,[{key:"createRule",value:function(e,t,r,o,n,i){if(!(r instanceof m.default))switch(e){case"advanced":r=new h.default(r);break;case"simple":r=new m.default(r[0],r[1],r[2]);break;case"subscription":r=new x.default(r[0],r[1],r[2])}void 0===i&&(i=this.getLastPriority()+1);var s=new $.default(t,r,i,o,n);this.rules.push(s)}},{key:"deleteRule",value:function(e){var t=this.rules.indexOf(e);this.rules.splice(t,1)}},{key:"getLastPriority",value:function(){var e=[];if(0!==this.rules.length){for(var t in this.rules)e.push(this.rules[t].priority);return Math.max.apply(Math,e)}return-1}},{key:"getRuleByPriority",value:function(e){for(var t in this.rules)if(this.rules[t].priority==e)return this.rules[t];throw Error("Rule with priority "+e+" does not exist!")}},{key:"hasSubscriptionRule",value:function(){for(var e in this.rules)if("global"===this.rules[e].scope){if(this.rules[e].condition instanceof x.default)return!0;if(this.rules[e].condition instanceof h.default)for(var t in this.rules[e].condition.condition)if(this.rules[e].condition.condition[t]instanceof x.default)return!0}return!1}},{key:"sortRules",value:function(){return this.rules.sort(function(e,t){var r=e.priority,o=t.priority;return r<o?-1:r>o?1:0})}}]),t}(g.default);r.default=P,t.exports=r.default},{"../Policy":63,"../Rule":65,"../conditions/AdvancedCondition":68,"../conditions/Condition":69,"../conditions/SubscriptionCondition":70,"babel-runtime/core-js/object/get-prototype-of":5,"babel-runtime/helpers/classCallCheck":9,"babel-runtime/helpers/createClass":10,"babel-runtime/helpers/inherits":12,"babel-runtime/helpers/possibleConstructorReturn":13}],72:[function(e,t,r){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function n(e){if(!e)throw Error("URL is needed to split");var t=/([a-zA-Z-]*):\/\/(?:\.)?([-a-zA-Z0-9@:%._\+~#=]{2,256})([-a-zA-Z0-9@:%._\+~#=\/]*)/gi,r="$1,$2,$3",o=e.replace(t,r).split(",");o[0]===e&&(o[0]="https",o[1]=e);var n={type:o[0],domain:o[1],identity:o[2]};return n}function i(e){var t=e.indexOf("@"),r={
username:e.substring(0,t),domain:e.substring(t+1,e.length)};return r}function s(e){return!((0,y.default)(e).length>0)}function u(e){if(e)return JSON.parse((0,d.default)(e))}function l(e){var t=e.split("/");return t[0]+"//"+t[2]+"/"+t[3]}function a(e){var t=e.indexOf("@");return"user://"+e.substring(t+1,e.length)+"/"+e.substring(0,t)}function c(e){var t=n(e);return t.identity.replace("/","")+"@"+t.domain}function f(e){if("user://"===e.substring(0,7)){var t=n(e);if(t.domain&&t.identity)return e;throw"userURL with wrong format"}return a(e)}function p(e){var t=["domain-idp","runtime","domain","hyperty"],r=e.split("://"),o=r[0];return t.indexOf(o)===-1}Object.defineProperty(r,"__esModule",{value:!0});var b=e("babel-runtime/core-js/json/stringify"),d=o(b),h=e("babel-runtime/core-js/object/keys"),y=o(h);r.divideURL=n,r.divideEmail=i,r.emptyObject=s,r.deepClone=u,r.removePathFromURL=l,r.getUserURLFromEmail=a,r.getUserEmailFromURL=c,r.convertToUserURL=f,r.isDataObjectURL=p},{"babel-runtime/core-js/json/stringify":1,"babel-runtime/core-js/object/keys":6}]},{},[64])(64)});
//# sourceMappingURL=PolicyEngine.js.map

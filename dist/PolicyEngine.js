/**
* Copyright 2016 PT Inovação e Sistemas SA
* Copyright 2016 INESC-ID
* Copyright 2016 QUOBIS NETWORKS SL
* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V
* Copyright 2016 ORANGE SA
* Copyright 2016 Deutsche Telekom AG
* Copyright 2016 Apizee
* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
**/

// Distribution file for PolicyEngine.js 
// version: 0.5.0
// Last build: Sat Jul 02 2016 00:21:46 GMT+0100 (WEST)

!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.PolicyEngine=e()}}(function(){return function e(t,n,r){function o(u,s){if(!n[u]){if(!t[u]){var a="function"==typeof require&&require;if(!s&&a)return a(u,!0);if(i)return i(u,!0);var c=new Error("Cannot find module '"+u+"'");throw c.code="MODULE_NOT_FOUND",c}var f=n[u]={exports:{}};t[u][0].call(f.exports,function(e){var n=t[u][1][e];return o(n?n:e)},f,f.exports,e,t,n,r)}return n[u].exports}for(var i="function"==typeof require&&require,u=0;u<r.length;u++)o(r[u]);return o}({1:[function(e,t,n){t.exports={"default":e("core-js/library/fn/object/define-property"),__esModule:!0}},{"core-js/library/fn/object/define-property":6}],2:[function(e,t,n){t.exports={"default":e("core-js/library/fn/symbol"),__esModule:!0}},{"core-js/library/fn/symbol":7}],3:[function(e,t,n){"use strict";n.__esModule=!0,n["default"]=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},{}],4:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}n.__esModule=!0;var o=e("../core-js/object/define-property"),i=r(o);n["default"]=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),(0,i["default"])(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}()},{"../core-js/object/define-property":1}],5:[function(e,t,n){"use strict";var r=e("babel-runtime/core-js/symbol")["default"];n["default"]=function(e){return e&&e.constructor===r?"symbol":typeof e},n.__esModule=!0},{"babel-runtime/core-js/symbol":2}],6:[function(e,t,n){var r=e("../../modules/$");t.exports=function(e,t,n){return r.setDesc(e,t,n)}},{"../../modules/$":25}],7:[function(e,t,n){e("../../modules/es6.symbol"),e("../../modules/es6.object.to-string"),t.exports=e("../../modules/$.core").Symbol},{"../../modules/$.core":11,"../../modules/es6.object.to-string":35,"../../modules/es6.symbol":36}],8:[function(e,t,n){t.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},{}],9:[function(e,t,n){var r=e("./$.is-object");t.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},{"./$.is-object":24}],10:[function(e,t,n){var r={}.toString;t.exports=function(e){return r.call(e).slice(8,-1)}},{}],11:[function(e,t,n){var r=t.exports={version:"1.2.6"};"number"==typeof __e&&(__e=r)},{}],12:[function(e,t,n){var r=e("./$.a-function");t.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,o){return e.call(t,n,r,o)}}return function(){return e.apply(t,arguments)}}},{"./$.a-function":8}],13:[function(e,t,n){t.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},{}],14:[function(e,t,n){t.exports=!e("./$.fails")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},{"./$.fails":17}],15:[function(e,t,n){var r=e("./$");t.exports=function(e){var t=r.getKeys(e),n=r.getSymbols;if(n)for(var o,i=n(e),u=r.isEnum,s=0;i.length>s;)u.call(e,o=i[s++])&&t.push(o);return t}},{"./$":25}],16:[function(e,t,n){var r=e("./$.global"),o=e("./$.core"),i=e("./$.ctx"),u="prototype",s=function(e,t,n){var a,c,f,l=e&s.F,p=e&s.G,d=e&s.S,v=e&s.P,b=e&s.B,y=e&s.W,h=p?o:o[t]||(o[t]={}),m=p?r:d?r[t]:(r[t]||{})[u];p&&(n=t);for(a in n)c=!l&&m&&a in m,c&&a in h||(f=c?m[a]:n[a],h[a]=p&&"function"!=typeof m[a]?n[a]:b&&c?i(f,r):y&&m[a]==f?function(e){var t=function(t){return this instanceof e?new e(t):e(t)};return t[u]=e[u],t}(f):v&&"function"==typeof f?i(Function.call,f):f,v&&((h[u]||(h[u]={}))[a]=f))};s.F=1,s.G=2,s.S=4,s.P=8,s.B=16,s.W=32,t.exports=s},{"./$.core":11,"./$.ctx":12,"./$.global":19}],17:[function(e,t,n){t.exports=function(e){try{return!!e()}catch(t){return!0}}},{}],18:[function(e,t,n){var r=e("./$.to-iobject"),o=e("./$").getNames,i={}.toString,u="object"==typeof window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],s=function(e){try{return o(e)}catch(t){return u.slice()}};t.exports.get=function(e){return u&&"[object Window]"==i.call(e)?s(e):o(r(e))}},{"./$":25,"./$.to-iobject":32}],19:[function(e,t,n){var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},{}],20:[function(e,t,n){var r={}.hasOwnProperty;t.exports=function(e,t){return r.call(e,t)}},{}],21:[function(e,t,n){var r=e("./$"),o=e("./$.property-desc");t.exports=e("./$.descriptors")?function(e,t,n){return r.setDesc(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},{"./$":25,"./$.descriptors":14,"./$.property-desc":28}],22:[function(e,t,n){var r=e("./$.cof");t.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},{"./$.cof":10}],23:[function(e,t,n){var r=e("./$.cof");t.exports=Array.isArray||function(e){return"Array"==r(e)}},{"./$.cof":10}],24:[function(e,t,n){t.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},{}],25:[function(e,t,n){var r=Object;t.exports={create:r.create,getProto:r.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:r.getOwnPropertyDescriptor,setDesc:r.defineProperty,setDescs:r.defineProperties,getKeys:r.keys,getNames:r.getOwnPropertyNames,getSymbols:r.getOwnPropertySymbols,each:[].forEach}},{}],26:[function(e,t,n){var r=e("./$"),o=e("./$.to-iobject");t.exports=function(e,t){for(var n,i=o(e),u=r.getKeys(i),s=u.length,a=0;s>a;)if(i[n=u[a++]]===t)return n}},{"./$":25,"./$.to-iobject":32}],27:[function(e,t,n){t.exports=!0},{}],28:[function(e,t,n){t.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},{}],29:[function(e,t,n){t.exports=e("./$.hide")},{"./$.hide":21}],30:[function(e,t,n){var r=e("./$").setDesc,o=e("./$.has"),i=e("./$.wks")("toStringTag");t.exports=function(e,t,n){e&&!o(e=n?e:e.prototype,i)&&r(e,i,{configurable:!0,value:t})}},{"./$":25,"./$.has":20,"./$.wks":34}],31:[function(e,t,n){var r=e("./$.global"),o="__core-js_shared__",i=r[o]||(r[o]={});t.exports=function(e){return i[e]||(i[e]={})}},{"./$.global":19}],32:[function(e,t,n){var r=e("./$.iobject"),o=e("./$.defined");t.exports=function(e){return r(o(e))}},{"./$.defined":13,"./$.iobject":22}],33:[function(e,t,n){var r=0,o=Math.random();t.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++r+o).toString(36))}},{}],34:[function(e,t,n){var r=e("./$.shared")("wks"),o=e("./$.uid"),i=e("./$.global").Symbol;t.exports=function(e){return r[e]||(r[e]=i&&i[e]||(i||o)("Symbol."+e))}},{"./$.global":19,"./$.shared":31,"./$.uid":33}],35:[function(e,t,n){},{}],36:[function(e,t,n){"use strict";var r=e("./$"),o=e("./$.global"),i=e("./$.has"),u=e("./$.descriptors"),s=e("./$.export"),a=e("./$.redefine"),c=e("./$.fails"),f=e("./$.shared"),l=e("./$.set-to-string-tag"),p=e("./$.uid"),d=e("./$.wks"),v=e("./$.keyof"),b=e("./$.get-names"),y=e("./$.enum-keys"),h=e("./$.is-array"),m=e("./$.an-object"),$=e("./$.to-iobject"),g=e("./$.property-desc"),x=r.getDesc,j=r.setDesc,w=r.create,_=b.get,k=o.Symbol,O=o.JSON,S=O&&O.stringify,C=!1,P=d("_hidden"),M=r.isEnum,E=f("symbol-registry"),D=f("symbols"),N="function"==typeof k,A=Object.prototype,T=u&&c(function(){return 7!=w(j({},"a",{get:function(){return j(this,"a",{value:7}).a}})).a})?function(e,t,n){var r=x(A,t);r&&delete A[t],j(e,t,n),r&&e!==A&&j(A,t,r)}:j,F=function(e){var t=D[e]=w(k.prototype);return t._k=e,u&&C&&T(A,e,{configurable:!0,set:function(t){i(this,P)&&i(this[P],e)&&(this[P][e]=!1),T(this,e,g(1,t))}}),t},q=function(e){return"symbol"==typeof e},I=function(e,t,n){return n&&i(D,t)?(n.enumerable?(i(e,P)&&e[P][t]&&(e[P][t]=!1),n=w(n,{enumerable:g(0,!1)})):(i(e,P)||j(e,P,g(1,{})),e[P][t]=!0),T(e,t,n)):j(e,t,n)},G=function(e,t){m(e);for(var n,r=y(t=$(t)),o=0,i=r.length;i>o;)I(e,n=r[o++],t[n]);return e},B=function(e,t){return void 0===t?w(e):G(w(e),t)},L=function(e){var t=M.call(this,e);return!(t||!i(this,e)||!i(D,e)||i(this,P)&&this[P][e])||t},J=function(e,t){var n=x(e=$(e),t);return!n||!i(D,t)||i(e,P)&&e[P][t]||(n.enumerable=!0),n},W=function(e){for(var t,n=_($(e)),r=[],o=0;n.length>o;)i(D,t=n[o++])||t==P||r.push(t);return r},K=function(e){for(var t,n=_($(e)),r=[],o=0;n.length>o;)i(D,t=n[o++])&&r.push(D[t]);return r},U=function(e){if(void 0!==e&&!q(e)){for(var t,n,r=[e],o=1,i=arguments;i.length>o;)r.push(i[o++]);return t=r[1],"function"==typeof t&&(n=t),!n&&h(t)||(t=function(e,t){if(n&&(t=n.call(this,e,t)),!q(t))return t}),r[1]=t,S.apply(O,r)}},z=c(function(){var e=k();return"[null]"!=S([e])||"{}"!=S({a:e})||"{}"!=S(Object(e))});N||(k=function(){if(q(this))throw TypeError("Symbol is not a constructor");return F(p(arguments.length>0?arguments[0]:void 0))},a(k.prototype,"toString",function(){return this._k}),q=function(e){return e instanceof k},r.create=B,r.isEnum=L,r.getDesc=J,r.setDesc=I,r.setDescs=G,r.getNames=b.get=W,r.getSymbols=K,u&&!e("./$.library")&&a(A,"propertyIsEnumerable",L,!0));var H={"for":function(e){return i(E,e+="")?E[e]:E[e]=k(e)},keyFor:function(e){return v(E,e)},useSetter:function(){C=!0},useSimple:function(){C=!1}};r.each.call("hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),function(e){var t=d(e);H[e]=N?t:F(t)}),C=!0,s(s.G+s.W,{Symbol:k}),s(s.S,"Symbol",H),s(s.S+s.F*!N,"Object",{create:B,defineProperty:I,defineProperties:G,getOwnPropertyDescriptor:J,getOwnPropertyNames:W,getOwnPropertySymbols:K}),O&&s(s.S+s.F*(!N||z),"JSON",{stringify:U}),l(k,"Symbol"),l(Math,"Math",!0),l(o.JSON,"JSON",!0)},{"./$":25,"./$.an-object":9,"./$.descriptors":14,"./$.enum-keys":15,"./$.export":16,"./$.fails":17,"./$.get-names":18,"./$.global":19,"./$.has":20,"./$.is-array":23,"./$.keyof":26,"./$.library":27,"./$.property-desc":28,"./$.redefine":29,"./$.set-to-string-tag":30,"./$.shared":31,"./$.to-iobject":32,"./$.uid":33,"./$.wks":34}],37:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var o=e("babel-runtime/helpers/classCallCheck"),i=r(o),u=e("babel-runtime/helpers/createClass"),s=r(u),a=function(){function e(){(0,i["default"])(this,e);var t=this;t.operators=t.setOperators()}return(0,s["default"])(e,[{key:"setOperators",value:function(){var e=this,t={between:function(t){return e.isBetween(t[0][0],t[0][1],t[1])},"in":function(e){return e[0].indexOf(e[1])>-1},equals:function(e){return"*"===e[0][0]||e[0][0]===e[1]},or:function(e){return e[0]||e[1]},and:function(e){return e[0]&&e[1]},not:function(e){return!e[0]}};return t}},{key:"isBetween",value:function(e,t,n){return e=parseInt(e),t=parseInt(t),t<e&&(n=n<e?n+=2400:n,t+=2400),n>e&&n<t}}]),e}();n["default"]=a,t.exports=n["default"]},{"babel-runtime/helpers/classCallCheck":3,"babel-runtime/helpers/createClass":4}],38:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var o=e("babel-runtime/helpers/typeof"),i=r(o),u=e("babel-runtime/helpers/classCallCheck"),s=r(u),a=e("babel-runtime/helpers/createClass"),c=r(a),f=e("./Operators"),l=r(f),p=function(){function e(t){(0,s["default"])(this,e);var n=this;n.context=t,n.operators=new l["default"](t)}return(0,c["default"])(e,[{key:"evaluate",value:function(e,t){var n=this,r=[!0],o=[];for(var u in t){var s=t[u],a=s.condition,c=!1;if(c="object"===("undefined"==typeof a?"undefined":(0,i["default"])(a))?n.verifiesAdvancedCondition(a[0],a[1],a[2],s.scope,e):n.verifiesSimpleCondition(a,s.scope,e),c&&r.push(s.authorise),s.actions!==[])for(var f in s.actions){var l={method:s.actions[f].method,params:e};o.push(l)}}var p=r.indexOf(!1)===-1;return[p,o]}},{key:"verifiesSimpleCondition",value:function(e,t,n){var r=this,o=e.split(" "),i=o[0],u=o[1],s=void 0;"in"===u?(r.context.group={scope:t,group:o[2],destination:n.to},s=r.context.group):s=o.slice(2),r.context[i]={message:n};var a=r.context[i];return r.operators.operators[u]([s,a])}},{key:"verifiesAdvancedCondition",value:function(e,t,n,r,o){for(var u=this;"object"===("undefined"==typeof t?"undefined":(0,i["default"])(t));)t=u.verifiesAdvancedCondition(t[0],t[1],t[2],r,o);if(void 0!==n)for(;"object"===("undefined"==typeof n?"undefined":(0,i["default"])(n));)n=u.verifiesAdvancedCondition(n[0],n[1],n[2],r,o);var s="boolean"==typeof t?t:u.verifiesSimpleCondition(t,r,o),a=void 0;return void 0!==n&&(a="boolean"==typeof n?n:u.verifiesSimpleCondition(n,r,o)),u.operators.operators[e]([s,a])}}]),e}();n["default"]=p,t.exports=n["default"]},{"./Operators":37,"babel-runtime/helpers/classCallCheck":3,"babel-runtime/helpers/createClass":4,"babel-runtime/helpers/typeof":5}],39:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var o=e("babel-runtime/helpers/classCallCheck"),i=r(o),u=e("babel-runtime/helpers/createClass"),s=r(u),a=function(){function e(t){(0,i["default"])(this,e);var n=this;n.context=t}return(0,s["default"])(e,[{key:"enforce",value:function(e){var t=this,n=e[0],r=e[1];for(var o in r)t.context[r[o].method](r[o].params,n)}}]),e}();n["default"]=a,t.exports=n["default"]},{"babel-runtime/helpers/classCallCheck":3,"babel-runtime/helpers/createClass":4}],40:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var o=e("babel-runtime/helpers/typeof"),i=r(o),u=e("babel-runtime/helpers/classCallCheck"),s=r(u),a=e("babel-runtime/helpers/createClass"),c=r(a),f=e("./PEP"),l=r(f),p=e("./PDP"),d=r(p),v=function(){function e(t){(0,s["default"])(this,e);var n=this;n.context=t,n.context.pdp=new d["default"](t),n.context.pep=new l["default"](t)}return(0,c["default"])(e,[{key:"addPolicies",value:function(e){var t=this,n=t.context.policies;void 0===n&&(n={});for(var r in e){var o=e[r],i=o.scope;void 0===n[i]&&(n[i]=[]);for(var u in n[i]){var s=n[i][u];if(s.condition===o.condition){t.removePolicies(e[r].condition);break}}n[i].push(e[r])}t.context.policies=n}},{key:"removePolicies",value:function(e,t){var n=this,r=n.context.policies;if("*"!==e){if(e in r){if("*"!==t){var o=r[e],u="undefined"==typeof t?"undefined":(0,i["default"])(t);for(var s in o){var a=(0,i["default"])(o[s].condition);if(u===a)if("string"===u){if(o[s].condition===t){o.splice(s,1);break}}else n.areEqualArrays(o[s].condition,t)&&o.splice(s,1)}}else delete r[e];n.context.policies=r}}else n.context.policies={}}},{key:"areEqualArrays",value:function(e,t){if(e.length!==t.length)return!1;for(var n=e.length,r=0;r<n;r++)if(e[r]instanceof Array&&t[r]instanceof Array){if(!e[r].equals(t[r]))return!1}else if(e[r]!==t[r])return!1;return!0}},{key:"authorise",value:function(e){var t=this;return t.context.authorise(e)}},{key:"getGroupsNames",value:function(e){var t=this,n=t.context.groups,r=[];if(n[e]!=={})for(var o in n[e])r.push(o);return r}},{key:"getList",value:function(e,t){var n=this,r=n.context.groups,o=[];return void 0!==r[e]&&void 0!==r[e][t]&&(o=r[e][t]),o}},{key:"createList",value:function(e,t,n){var r=this,o=r.context.groups;void 0===o[e]&&(o[e]={}),o[e][n]=[];var i={authorise:!1,condition:t+" in "+n,scope:e,actions:[]};return r.addPolicies([i]),o}},{key:"deleteGroup",value:function(e,t){var n=this,r=n.context.groups;delete r[e][t];var o=n.context.policies,i=o[e];for(var u in i){var s=i[u].condition.split(" ");s.shift();var a=s.join(" ");if(a===t){delete i[u];break}}}},{key:"addToList",value:function(e,t,n,r){var o=this,i=o.context.groups;void 0===i[e]&&(i[e]={}),void 0===i[e][n]&&(i=o.createList(e,t,n)),i[e][n].indexOf(r)===-1&&i[e][n].push(r)}},{key:"removeFromGroup",value:function(e,t,n){var r=this,o=r.context.groups,i=o[e][t];for(var u in i)if(i[u]===n){i.splice(u,1);break}}},{key:"getTimeslots",value:function(){var e=this,t=e.context.policies.user,n=[];for(var r in t)"time"===t[r].condition.split(" ")[0]&&n.push(t[r].condition);return n}},{key:"getTimeslotById",value:function(e){var t=this,n=t.context.policies.user;for(var r in n)if(n[r].condition===e)return n[r]}}]),e}();n["default"]=v,t.exports=n["default"]},{"./PDP":38,"./PEP":39,"babel-runtime/helpers/classCallCheck":3,"babel-runtime/helpers/createClass":4,"babel-runtime/helpers/typeof":5}]},{},[40])(40)});
//# sourceMappingURL=PolicyEngine.js.map

"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var _promise=require("babel-runtime/core-js/promise"),_promise2=_interopRequireDefault(_promise),_classCallCheck2=require("babel-runtime/helpers/classCallCheck"),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=require("babel-runtime/helpers/createClass"),_createClass3=_interopRequireDefault(_createClass2),IdpProxyStub=function(){function e(r,s,o){(0,_classCallCheck3.default)(this,e);var a=this;a.messageBus=r,a.domain=s,a.idpProxy=o,a.messageBus.addListener("domain://"+o,function(e){a.requestToIdp(e)}),a.start(o)}return(0,_createClass3.default)(e,[{key:"requestToIdp",value:function(e){var r=this,s=e.body.params;switch(e.body.method){case"login":r.login(s).then(function(s){r.replyMessage(e,s)});break;case"generateAssertion":r.generate(s).then(function(s){r.replyMessage(e,s)});break;case"validateAssertion":r.validate(s).then(function(s){r.replyMessage(e,s)})}}},{key:"start",value:function(e){var r=this;if(!window.Worker)return"error";var s=new Worker("/src/identity/IdpProxy.js");r.myWorker=s,r.myWorker.postMessage(["create","IdpProxy"])}},{key:"generate",value:function(e){var r=this;return new _promise2.default(function(s,o){window.Worker?(r.myWorker.postMessage(["generate",e]),r.myWorker.onmessage=function(e){s(e.data),console.log("Message received from worker",e.data)}):o("error")})}},{key:"validate",value:function(e){var r=this;return new _promise2.default(function(s,o){window.Worker?(r.myWorker.postMessage(["validate",e]),r.myWorker.onmessage=function(e){s(e.data),console.log("Message received from worker",e.data)}):o("error")})}},{key:"login",value:function(e){var r=this;return new _promise2.default(function(s,o){window.Worker?(r.myWorker.postMessage(["login",e]),r.myWorker.onmessage=function(e){s(e.data),console.log("Message received from worker",e.data)}):o("error")})}},{key:"replyMessage",value:function(e,r){var s=this,o={id:e.id,type:"response",to:e.from,from:e.to,body:{code:200,value:r}};s.messageBus.postMessage(o)}}]),e}();exports.default=IdpProxyStub,module.exports=exports.default;
//# sourceMappingURL=IdpProxyStub.js.map

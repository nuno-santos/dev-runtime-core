// Runtime User Agent 

// version: 0.4.0

!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.RuntimeUA=e()}}(function(){var e;return function t(e,r,n){function o(s,a){if(!r[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(i)return i(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var l=r[s]={exports:{}};e[s][0].call(l.exports,function(t){var r=e[s][1][t];return o(r?r:t)},l,l.exports,t,e,r,n)}return r[s].exports}for(var i="function"==typeof require&&require,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(e,t,r){function n(){l=!1,a.length?c=a.concat(c):f=-1,c.length&&o()}function o(){if(!l){var e=setTimeout(n);l=!0;for(var t=c.length;t;){for(a=c,c=[];++f<t;)a&&a[f].run();f=-1,t=c.length}a=null,l=!1,clearTimeout(e)}}function i(e,t){this.fun=e,this.array=t}function s(){}var a,u=t.exports={},c=[],l=!1,f=-1;u.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new i(e,t)),1!==c.length||l||setTimeout(o,0)},i.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=s,u.addListener=s,u.once=s,u.off=s,u.removeListener=s,u.removeAllListeners=s,u.emit=s,u.binding=function(e){throw new Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(e){throw new Error("process.chdir is not supported")},u.umask=function(){return 0}},{}],2:[function(t,r,n){(function(t){Object.create||(Object.create=function(){function e(){}return function(t){if(1!=arguments.length)throw new Error("Object.create implementation only accepts one parameter.");return e.prototype=t,new e}}()),Object.keys||(Object.keys=function(e,t,r){r=[];for(t in e)r.hasOwnProperty.call(e,t)&&r.push(t);return r}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return t;return-1}),Array.prototype.forEach||(Array.prototype.forEach=function(e){if(void 0===this||null===this)throw new TypeError;var t=Object(this),r=t.length>>>0;if("function"!=typeof e)throw new TypeError;for(var n=arguments.length>=2?arguments[1]:void 0,o=0;r>o;o++)o in t&&e.call(n,t[o],o,t);return this}),Array.prototype.filter||(Array.prototype.filter=function(e,t){var r=[];return this.forEach(function(n,o,i){e.call(t||void 0,n,o,i)&&r.push(n)}),r}),Array.prototype.map||(Array.prototype.map=function(e,t){var r=[];return this.forEach(function(n,o,i){r.push(e.call(t||void 0,n,o,i))}),r}),Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),"object"!=typeof window||"object"!=typeof window.location||window.location.assign||(window.location.assign=function(e){window.location=e}),Function.prototype.bind||(Function.prototype.bind=function(e){function t(){}if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var r=[].slice,n=r.call(arguments,1),o=this,i=function(){return o.apply(this instanceof t?this:e||window,n.concat(r.call(arguments)))};return t.prototype=this.prototype,i.prototype=new t,i});var n=function(e){return n.use(e)};n.utils={extend:function(e){return Array.prototype.slice.call(arguments,1).forEach(function(t){if(e instanceof Object&&t instanceof Object&&e!==t)for(var r in t)e[r]=n.utils.extend(e[r],t[r]);else e=t}),e}},n.utils.extend(n,{settings:{redirect_uri:window.location.href.split("#")[0],response_type:"token",display:"popup",state:"",oauth_proxy:"https://auth-server.herokuapp.com/proxy",timeout:2e4,popup:{resizable:1,scrollbars:1,width:500,height:550},default_service:null,force:null,page_uri:window.location.href},services:{},use:function(e){var t=Object.create(this);return t.settings=Object.create(this.settings),e&&(t.settings.default_service=e),t.utils.Event.call(t),t},init:function(e,t){var r=this.utils;if(!e)return this.services;for(var n in e)e.hasOwnProperty(n)&&"object"!=typeof e[n]&&(e[n]={id:e[n]});r.extend(this.services,e);for(n in this.services)this.services.hasOwnProperty(n)&&(this.services[n].scope=this.services[n].scope||{});return t&&(r.extend(this.settings,t),"redirect_uri"in t&&(this.settings.redirect_uri=r.url(t.redirect_uri).href)),this},login:function(){function e(e,t){n.emit(e,t)}function t(e){return e}function r(e){return!!e}var o,i=this,s=i.utils,a=s.error,u=s.Promise(),c=s.args({network:"s",options:"o",callback:"f"},arguments),l=s.diffKey(c.options,i.settings),f=c.options=s.merge(i.settings,c.options||{});if(f.popup=s.merge(i.settings.popup,c.options.popup||{}),c.network=c.network||i.settings.default_service,u.proxy.then(c.callback,c.callback),u.proxy.then(e.bind(this,"auth.login auth"),e.bind(this,"auth.failed auth")),"string"!=typeof c.network||!(c.network in i.services))return u.reject(a("invalid_network","The provided network was not recognized"));var d=i.services[c.network],p=s.globalEvent(function(e){var t;t=e?JSON.parse(e):a("cancelled","The authentication was not completed"),t.error?u.reject(t):(s.store(t.network,t),u.fulfill({network:t.network,authResponse:t}))}),h=s.url(f.redirect_uri).href,m=d.oauth.response_type||f.response_type;/\bcode\b/.test(m)&&!d.oauth.grant&&(m=m.replace(/\bcode\b/,"token")),c.qs=s.merge(l,{client_id:encodeURIComponent(d.id),response_type:encodeURIComponent(m),redirect_uri:encodeURIComponent(h),display:f.display,state:{client_id:d.id,network:c.network,display:f.display,callback:p,state:f.state,redirect_uri:h}});var y=s.store(c.network),v=/[,\s]+/,b=[];if(f.scope&&b.push(f.scope.toString()),"basic"in d.scope&&b.push("basic"),y&&"scope"in y&&y.scope instanceof String&&b.push(y.scope),b=b.join(",").split(v),b=s.unique(b).filter(r),c.qs.state.scope=b.join(","),b=b.map(function(e){if(e in d.scope)return d.scope[e];for(var t in i.services){var r=i.services[t].scope;if(r&&e in r)return""}return e}),b=b.join(",").split(v),b=s.unique(b).filter(r),c.qs.scope=b.join(d.scope_delim||","),f.force===!1&&y&&"access_token"in y&&y.access_token&&"expires"in y&&y.expires>(new Date).getTime()/1e3){var g=s.diff((y.scope||"").split(v),(c.qs.state.scope||"").split(v));if(0===g.length)return u.fulfill({unchanged:!0,network:c.network,authResponse:y}),u}if("page"===f.display&&f.page_uri&&(c.qs.state.page_uri=s.url(f.page_uri).href),"login"in d&&"function"==typeof d.login&&d.login(c),(!/\btoken\b/.test(m)||parseInt(d.oauth.version,10)<2||"none"===f.display&&d.oauth.grant&&y&&y.refresh_token)&&(c.qs.state.oauth=d.oauth,c.qs.state.oauth_proxy=f.oauth_proxy),c.qs.state=encodeURIComponent(JSON.stringify(c.qs.state)),1===parseInt(d.oauth.version,10)?o=s.qs(f.oauth_proxy,c.qs,t):"none"===f.display&&d.oauth.grant&&y&&y.refresh_token?(c.qs.refresh_token=y.refresh_token,o=s.qs(f.oauth_proxy,c.qs,t)):o=s.qs(d.oauth.auth,c.qs,t),e("auth.init",c),"none"===f.display)s.iframe(o,h);else if("popup"===f.display)var _=s.popup(o,h,f.popup),w=setInterval(function(){if((!_||_.closed)&&(clearInterval(w),!u.state)){var e=a("cancelled","Login has been cancelled");_||(e=a("blocked","Popup was blocked")),e.network=c.network,u.reject(e)}},100);else window.location=o;return u.proxy},logout:function(){function e(e,t){n.emit(e,t)}var t=this,r=t.utils,o=r.error,i=r.Promise(),s=r.args({name:"s",options:"o",callback:"f"},arguments);if(s.options=s.options||{},i.proxy.then(s.callback,s.callback),i.proxy.then(e.bind(this,"auth.logout auth"),e.bind(this,"error")),s.name=s.name||this.settings.default_service,s.authResponse=r.store(s.name),!s.name||s.name in t.services)if(s.name&&s.authResponse){var a=function(e){r.store(s.name,null),i.fulfill(n.utils.merge({network:s.name},e||{}))},u={};if(s.options.force){var c=t.services[s.name].logout;if(c)if("function"==typeof c&&(c=c(a,s)),"string"==typeof c)r.iframe(c),u.force=null,u.message="Logout success on providers site was indeterminate";else if(void 0===c)return i.proxy}a(u)}else i.reject(o("invalid_session","There was no session to remove"));else i.reject(o("invalid_network","The network was unrecognized"));return i.proxy},getAuthResponse:function(e){return e=e||this.settings.default_service,e&&e in this.services?this.utils.store(e)||null:null},events:{}}),n.utils.extend(n.utils,{error:function(e,t){return{error:{code:e,message:t}}},qs:function(e,t,r){if(t){r=r||encodeURIComponent;for(var n in t){var o="([\\?\\&])"+n+"=[^\\&]*",i=new RegExp(o);e.match(i)&&(e=e.replace(i,"$1"+n+"="+r(t[n])),delete t[n])}}return this.isEmpty(t)?e:e+(e.indexOf("?")>-1?"&":"?")+this.param(t,r)},param:function(e,t){var r,n,o={};if("string"==typeof e){if(t=t||decodeURIComponent,n=e.replace(/^[\#\?]/,"").match(/([^=\/\&]+)=([^\&]+)/g))for(var i=0;i<n.length;i++)r=n[i].match(/([^=]+)=(.*)/),o[r[1]]=t(r[2]);return o}t=t||encodeURIComponent;var s=e;o=[];for(var a in s)s.hasOwnProperty(a)&&s.hasOwnProperty(a)&&o.push([a,"?"===s[a]?"?":t(s[a])].join("="));return o.join("&")},store:function(){function e(){var e={};try{e=JSON.parse(r.getItem("hello"))||{}}catch(t){}return e}function t(e){r.setItem("hello",JSON.stringify(e))}for(var r,n=["localStorage","sessionStorage"],o=-1,i="test";n[++o];)try{r=window[n[o]],r.setItem(i+o,o),r.removeItem(i+o);break}catch(s){r=null}if(!r){var a=null;r={getItem:function(e){e+="=";for(var t=document.cookie.split(";"),r=0;r<t.length;r++){var n=t[r].replace(/(^\s+|\s+$)/,"");if(n&&0===n.indexOf(e))return n.substr(e.length)}return a},setItem:function(e,t){a=t,document.cookie=e+"="+t}},a=r.getItem("hello")}return function(r,n,o){var i=e();if(r&&void 0===n)return i[r]||null;if(r&&null===n)try{delete i[r]}catch(s){i[r]=null}else{if(!r)return i;i[r]=n}return t(i),i||null}}(),append:function(e,t,r){var n="string"==typeof e?document.createElement(e):e;if("object"==typeof t)if("tagName"in t)r=t;else for(var o in t)if(t.hasOwnProperty(o))if("object"==typeof t[o])for(var i in t[o])t[o].hasOwnProperty(i)&&(n[o][i]=t[o][i]);else"html"===o?n.innerHTML=t[o]:/^on/.test(o)?n[o]=t[o]:n.setAttribute(o,t[o]);return"body"===r?!function s(){document.body?document.body.appendChild(n):setTimeout(s,16)}():"object"==typeof r?r.appendChild(n):"string"==typeof r&&document.getElementsByTagName(r)[0].appendChild(n),n},iframe:function(e){this.append("iframe",{src:e,style:{position:"absolute",left:"-1000px",bottom:0,height:"1px",width:"1px"}},"body")},merge:function(){var e=Array.prototype.slice.call(arguments);return e.unshift({}),this.extend.apply(null,e)},args:function(e,t){var r={},n=0,o=null,i=null;for(i in e)if(e.hasOwnProperty(i))break;if(1===t.length&&"object"==typeof t[0]&&"o!"!=e[i])for(i in t[0])if(e.hasOwnProperty(i)&&i in e)return t[0];for(i in e)if(e.hasOwnProperty(i))if(o=typeof t[n],"function"==typeof e[i]&&e[i].test(t[n])||"string"==typeof e[i]&&(e[i].indexOf("s")>-1&&"string"===o||e[i].indexOf("o")>-1&&"object"===o||e[i].indexOf("i")>-1&&"number"===o||e[i].indexOf("a")>-1&&"object"===o||e[i].indexOf("f")>-1&&"function"===o))r[i]=t[n++];else if("string"==typeof e[i]&&e[i].indexOf("!")>-1)return!1;return r},url:function(e){if(e){if(window.URL&&URL instanceof Function&&0!==URL.length)return new URL(e,window.location);var t=document.createElement("a");return t.href=e,t.cloneNode(!1)}return window.location},diff:function(e,t){return t.filter(function(t){return-1===e.indexOf(t)})},diffKey:function(e,t){if(e||!t){var r={};for(var n in e)n in t||(r[n]=e[n]);return r}return e},unique:function(e){return Array.isArray(e)?e.filter(function(t,r){return e.indexOf(t)===r}):[]},isEmpty:function(e){if(!e)return!0;if(Array.isArray(e))return!e.length;if("object"==typeof e)for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},Promise:function(){var e=0,r=1,n=2,o=function(t){return this instanceof o?(this.id="Thenable/1.0.6",this.state=e,this.fulfillValue=void 0,this.rejectReason=void 0,this.onFulfilled=[],this.onRejected=[],this.proxy={then:this.then.bind(this)},void("function"==typeof t&&t.call(this,this.fulfill.bind(this),this.reject.bind(this)))):new o(t)};o.prototype={fulfill:function(e){return i(this,r,"fulfillValue",e)},reject:function(e){return i(this,n,"rejectReason",e)},then:function(e,t){var r=this,n=new o;return r.onFulfilled.push(u(e,n,"fulfill")),r.onRejected.push(u(t,n,"reject")),s(r),n.proxy}};var i=function(t,r,n,o){return t.state===e&&(t.state=r,t[n]=o,s(t)),t},s=function(e){e.state===r?a(e,"onFulfilled",e.fulfillValue):e.state===n&&a(e,"onRejected",e.rejectReason)},a=function(e,r,n){if(0!==e[r].length){var o=e[r];e[r]=[];var i=function(){for(var e=0;e<o.length;e++)o[e](n)};"object"==typeof t&&"function"==typeof t.nextTick?t.nextTick(i):"function"==typeof setImmediate?setImmediate(i):setTimeout(i,0)}},u=function(e,t,r){return function(n){if("function"!=typeof e)t[r].call(t,n);else{var o;try{o=e(n)}catch(i){return void t.reject(i)}c(t,o)}}},c=function(e,t){if(e===t||e.proxy===t)return void e.reject(new TypeError("cannot resolve promise with itself"));var r;if("object"==typeof t&&null!==t||"function"==typeof t)try{r=t.then}catch(n){return void e.reject(n)}if("function"!=typeof r)e.fulfill(t);else{var o=!1;try{r.call(t,function(r){o||(o=!0,r===t?e.reject(new TypeError("circular thenable chain")):c(e,r))},function(t){o||(o=!0,e.reject(t))})}catch(n){o||e.reject(n)}}};return o}(),Event:function(){var e=/[\s\,]+/;return this.parent={events:this.events,findEvents:this.findEvents,parent:this.parent,utils:this.utils},this.events={},this.on=function(t,r){if(r&&"function"==typeof r)for(var n=t.split(e),o=0;o<n.length;o++)this.events[n[o]]=[r].concat(this.events[n[o]]||[]);return this},this.off=function(e,t){return this.findEvents(e,function(e,r){t&&this.events[e][r]!==t||(this.events[e][r]=null)}),this},this.emit=function(e){var t=Array.prototype.slice.call(arguments,1);t.push(e);for(var r=function(r,n){t[t.length-1]="*"===r?e:r,this.events[r][n].apply(this,t)},n=this;n&&n.findEvents;)n.findEvents(e+",*",r),n=n.parent;return this},this.emitAfter=function(){var e=this,t=arguments;return setTimeout(function(){e.emit.apply(e,t)},0),this},this.findEvents=function(t,r){var n=t.split(e);for(var o in this.events)if(this.events.hasOwnProperty(o)&&n.indexOf(o)>-1)for(var i=0;i<this.events[o].length;i++)this.events[o][i]&&r.call(this,o,i)},this},globalEvent:function(e,t){return t=t||"_hellojs_"+parseInt(1e12*Math.random(),10).toString(36),window[t]=function(){try{e.apply(this,arguments)&&delete window[t]}catch(r){console.error(r)}},t},popup:function(e,t,r){var o=document.documentElement;if(r.height){var i=void 0!==window.screenTop?window.screenTop:screen.top,s=screen.height||window.innerHeight||o.clientHeight;r.top=parseInt((s-r.height)/2,10)+i}if(r.width){var a=void 0!==window.screenLeft?window.screenLeft:screen.left,u=screen.width||window.innerWidth||o.clientWidth;r.left=parseInt((u-r.width)/2,10)+a}var c=[];Object.keys(r).forEach(function(e){var t=r[e];c.push(e+(null!==t?"="+t:""))});var l=function(e){var r=window.open(e,"_blank",c.join(","));try{if(r&&r.addEventListener){var o=n.utils.url(t),i=o.origin||o.protocol+"//"+o.hostname;r.addEventListener("loadstart",function(e){var t=e.url;if(0===t.indexOf(i)){var o=n.utils.url(t),s={location:{assign:function(e){r.addEventListener("exit",function(){setTimeout(function(){l(e)},1e3)})},search:o.search,hash:o.hash,href:o.href},close:function(){r.close&&r.close()}};n.utils.responseHandler(s,window),s.close()}})}}catch(s){}return r&&r.focus&&r.focus(),r};return-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")&&(e=t+"#oauth_redirect="+encodeURIComponent(encodeURIComponent(e))),l(e)},responseHandler:function(e,t){function r(e,t,r){var o=e.callback,s=e.network;if(i.store(s,e),!("display"in e&&"page"===e.display)){if(r&&o&&o in r){try{delete e.callback}catch(a){}i.store(s,e);var u=JSON.stringify(e);try{r[o](u)}catch(a){}}n()}}function n(){if(e.frameElement)t.document.body.removeChild(e.frameElement);else{try{e.close()}catch(r){}e.addEventListener&&e.addEventListener("load",function(){e.close()})}}var o,i=this,s=e.location;if(o=i.param(s.search),o&&o.state&&(o.code||o.oauth_token)){var a=JSON.parse(o.state);o.redirect_uri=a.redirect_uri||s.href.replace(/[\?\#].*$/,"");var u=a.oauth_proxy+"?"+i.param(o);return void s.assign(u)}if(o=i.merge(i.param(s.search||""),i.param(s.hash||"")),o&&"state"in o){try{var c=JSON.parse(o.state);i.extend(o,c)}catch(l){console.error("Could not decode state parameter")}if("access_token"in o&&o.access_token&&o.network)o.expires_in&&0!==parseInt(o.expires_in,10)||(o.expires_in=0),o.expires_in=parseInt(o.expires_in,10),o.expires=(new Date).getTime()/1e3+(o.expires_in||31536e3),r(o,e,t);else if("error"in o&&o.error&&o.network)o.error={code:o.error,message:o.error_message||o.error_description},r(o,e,t);else if(o.callback&&o.callback in t){var f="result"in o&&o.result?JSON.parse(o.result):!1;t[o.callback](f),n()}o.page_uri&&s.assign(o.page_uri)}else if("oauth_redirect"in o)return void s.assign(decodeURIComponent(o.oauth_redirect))}}),n.utils.Event.call(n),function(e){var t={},r={};e.on("auth.login, auth.logout",function(r){r&&"object"==typeof r&&r.network&&(t[r.network]=e.utils.store(r.network)||{})}),function n(){var o=(new Date).getTime()/1e3,i=function(t){e.emit("auth."+t,{network:s,authResponse:a})};for(var s in e.services)if(e.services.hasOwnProperty(s)){if(!e.services[s].id)continue;var a=e.utils.store(s)||{},u=e.services[s],c=t[s]||{};if(a&&"callback"in a){var l=a.callback;try{delete a.callback}catch(f){}e.utils.store(s,a);try{window[l](a)}catch(f){}}if(a&&"expires"in a&&a.expires<o){var d=u.refresh||a.refresh_token;!d||s in r&&!(r[s]<o)?d||s in r||(i("expired"),r[s]=!0):(e.emit("notice",s+" has expired trying to resignin"),e.login(s,{display:"none",force:!1}),r[s]=o+600);continue}if(c.access_token===a.access_token&&c.expires===a.expires)continue;!a.access_token&&c.access_token?i("logout"):a.access_token&&!c.access_token?i("login"):a.expires!==c.expires&&i("update"),t[s]=a,s in r&&delete r[s]}setTimeout(n,1e3)}()}(n),n.api=function(){function e(e){e=e.replace(/\@\{([a-z\_\-]+)(\|.*?)?\}/gi,function(e,t,r){var s=r?r.replace(/^\|/,""):"";return t in i.query?(s=i.query[t],delete i.query[t]):i.data&&t in i.data?(s=i.data[t],delete i.data[t]):r||o.reject(n("missing_attribute","The attribute "+t+" is missing from the request")),s}),e.match(/^https?:\/\//)||(e=c.base+e),i.url=e,r.request(i,function(e,t){if(!i.formatResponse)return void(("object"==typeof t?t.statusCode>=400:"object"==typeof e&&"error"in e)?o.reject(e):o.fulfill(e));if(e===!0?e={success:!0}:e||(e={}),"delete"===i.method&&(e=!e||r.isEmpty(e)?{success:!0}:e),c.wrap&&(i.path in c.wrap||"default"in c.wrap)){var n=i.path in c.wrap?i.path:"default",s=((new Date).getTime(),c.wrap[n](e,t,i));s&&(e=s)}e&&"paging"in e&&e.paging.next&&("?"===e.paging.next[0]?e.paging.next=i.path+e.paging.next:e.paging.next+="#"+i.path),!e||"error"in e?o.reject(e):o.fulfill(e)})}var t=this,r=t.utils,n=r.error,o=r.Promise(),i=r.args({path:"s!",query:"o",method:"s",data:"o",timeout:"i",callback:"f"},arguments);i.method=(i.method||"get").toLowerCase(),i.headers=i.headers||{},i.query=i.query||{},("get"===i.method||"delete"===i.method)&&(r.extend(i.query,i.data),i.data={});var s=i.data=i.data||{};if(o.then(i.callback,i.callback),!i.path)return o.reject(n("invalid_path","Missing the path parameter from the request"));i.path=i.path.replace(/^\/+/,"");var a=(i.path.split(/[\/\:]/,2)||[])[0].toLowerCase();if(a in t.services){i.network=a;var u=new RegExp("^"+a+":?/?");i.path=i.path.replace(u,"")}i.network=t.settings.default_service=i.network||t.settings.default_service;var c=t.services[i.network];if(!c)return o.reject(n("invalid_network","Could not match the service requested: "+i.network));if(i.method in c&&i.path in c[i.method]&&c[i.method][i.path]===!1)return o.reject(n("invalid_path","The provided path is not available on the selected network"));i.oauth_proxy||(i.oauth_proxy=t.settings.oauth_proxy),"proxy"in i||(i.proxy=i.oauth_proxy&&c.oauth&&1===parseInt(c.oauth.version,10)),"timeout"in i||(i.timeout=t.settings.timeout),"formatResponse"in i||(i.formatResponse=!0),i.authResponse=t.getAuthResponse(i.network),i.authResponse&&i.authResponse.access_token&&(i.query.access_token=i.authResponse.access_token);var l,f=i.path;i.options=r.clone(i.query),i.data=r.clone(s);var d=c[{"delete":"del"}[i.method]||i.method]||{};if("get"===i.method){var p=f.split(/[\?#]/)[1];p&&(r.extend(i.query,r.param(p)),f=f.replace(/\?.*?(#|$)/,"$1"))}return(l=f.match(/#(.+)/,""))?(f=f.split("#")[0],i.path=l[1]):f in d?(i.path=f,f=d[f]):"default"in d&&(f=d["default"]),i.redirect_uri=t.settings.redirect_uri,i.xhr=c.xhr,i.jsonp=c.jsonp,i.form=c.form,"function"==typeof f?f(i,e):e(f),o.proxy},n.utils.extend(n.utils,{request:function(e,t){function r(e,t){var r;e.authResponse&&e.authResponse.oauth&&1===parseInt(e.authResponse.oauth.version,10)&&(r=e.query.access_token,delete e.query.access_token,e.proxy=!0),!e.data||"get"!==e.method&&"delete"!==e.method||(n.extend(e.query,e.data),e.data=null);var o=n.qs(e.url,e.query);e.proxy&&(o=n.qs(e.oauth_proxy,{path:o,access_token:r||"",then:e.proxy_response_type||("get"===e.method.toLowerCase()?"redirect":"proxy"),method:e.method.toLowerCase(),suppress_response_codes:!0})),t(o)}var n=this,o=n.error;n.isEmpty(e.data)||"FileList"in window||!n.hasBinary(e.data)||(e.xhr=!1,e.jsonp=!1);var i=this.request_cors(function(){return void 0===e.xhr||e.xhr&&("function"!=typeof e.xhr||e.xhr(e,e.query))});if(i)return void r(e,function(r){var o=n.xhr(e.method,r,e.headers,e.data,t);o.onprogress=e.onprogress||null,o.upload&&e.onuploadprogress&&(o.upload.onprogress=e.onuploadprogress)});var s=e.query;if(e.query=n.clone(e.query),e.callbackID=n.globalEvent(),e.jsonp!==!1){if(e.query.callback=e.callbackID,"function"==typeof e.jsonp&&e.jsonp(e,e.query),"get"===e.method)return void r(e,function(r){n.jsonp(r,t,e.callbackID,e.timeout)});e.query=s}if(e.form!==!1){e.query.redirect_uri=e.redirect_uri,e.query.state=JSON.stringify({callback:e.callbackID});var a;if("function"==typeof e.form&&(a=e.form(e,e.query)),"post"===e.method&&a!==!1)return void r(e,function(r){n.post(r,e.data,a,t,e.callbackID,e.timeout)})}t(o("invalid_request","There was no mechanism for handling this request"))},request_cors:function(e){return"withCredentials"in new XMLHttpRequest&&e()},domInstance:function(e,t){var r="HTML"+(e||"").replace(/^[a-z]/,function(e){return e.toUpperCase()})+"Element";return t?window[r]?t instanceof window[r]:window.Element?t instanceof window.Element&&(!e||t.tagName&&t.tagName.toLowerCase()===e):!(t instanceof Object||t instanceof Array||t instanceof String||t instanceof Number)&&t.tagName&&t.tagName.toLowerCase()===e:!1},clone:function(e){if(null===e||"object"!=typeof e||e instanceof Date||"nodeName"in e||this.isBinary(e))return e;if(Array.isArray(e))return e.map(this.clone.bind(this));var t={};for(var r in e)t[r]=this.clone(e[r]);return t},xhr:function(e,t,r,n,o){function i(e){for(var t,r={},n=/([a-z\-]+):\s?(.*);?/gi;t=n.exec(e);)r[t[1]]=t[2];return r}var s=new XMLHttpRequest,a=this.error,u=!1;"blob"===e&&(u=e,e="GET"),e=e.toUpperCase(),s.onload=function(t){var r=s.response;try{r=JSON.parse(s.responseText)}catch(n){401===s.status&&(r=a("access_denied",s.statusText))}var u=i(s.getAllResponseHeaders());u.statusCode=s.status,o(r||("GET"===e?a("empty_response","Could not get resource"):{}),u)},s.onerror=function(e){var t=s.responseText;try{t=JSON.parse(s.responseText)}catch(r){}o(t||a("access_denied","Could not get resource"))};var c;if("GET"===e||"DELETE"===e)n=null;else if(n&&"string"!=typeof n&&!(n instanceof FormData)&&!(n instanceof File)&&!(n instanceof Blob)){var l=new FormData;for(c in n)n.hasOwnProperty(c)&&(n[c]instanceof HTMLInputElement?"files"in n[c]&&n[c].files.length>0&&l.append(c,n[c].files[0]):n[c]instanceof Blob?l.append(c,n[c],n.name):l.append(c,n[c]));n=l}if(s.open(e,t,!0),u&&("responseType"in s?s.responseType=u:s.overrideMimeType("text/plain; charset=x-user-defined")),r)for(c in r)s.setRequestHeader(c,r[c]);return s.send(n),s},jsonp:function(e,t,r,n){var o,i=this,s=i.error,a=0,u=document.getElementsByTagName("head")[0],c=s("server_error","server_error"),l=function(){a++||window.setTimeout(function(){t(c),u.removeChild(f)},0)};r=i.globalEvent(function(e){return c=e,!0},r),e=e.replace(new RegExp("=\\?(&|$)"),"="+r+"$1");var f=i.append("script",{id:r,name:r,src:e,async:!0,onload:l,onerror:l,onreadystatechange:function(){/loaded|complete/i.test(this.readyState)&&l()}});window.navigator.userAgent.toLowerCase().indexOf("opera")>-1&&(o=i.append("script",{text:"document.getElementById('"+r+"').onerror();"}),f.async=!1),n&&window.setTimeout(function(){c=s("timeout","timeout"),l()},n),u.appendChild(f),o&&u.appendChild(o)},post:function(e,t,r,n,o,i){var s,a=this,u=a.error,c=document,l=null,f=[],d=0,p=null,h=0,m=function(e){h++||n(e)};a.globalEvent(m,o);var y;try{y=c.createElement('<iframe name="'+o+'">')}catch(v){y=c.createElement("iframe")}if(y.name=o,y.id=o,y.style.display="none",r&&r.callbackonload&&(y.onload=function(){m({response:"posted",message:"Content was posted"})}),i&&setTimeout(function(){m(u("timeout","The post operation timed out"))},i),c.body.appendChild(y),a.domInstance("form",t)){for(l=t.form,d=0;d<l.elements.length;d++)l.elements[d]!==t&&l.elements[d].setAttribute("disabled",!0);t=l}if(a.domInstance("form",t))for(l=t,d=0;d<l.elements.length;d++)l.elements[d].disabled||"file"!==l.elements[d].type||(l.encoding=l.enctype="multipart/form-data",l.elements[d].setAttribute("name","file"));else{for(p in t)t.hasOwnProperty(p)&&a.domInstance("input",t[p])&&"file"===t[p].type&&(l=t[p].form,l.encoding=l.enctype="multipart/form-data");l||(l=c.createElement("form"),c.body.appendChild(l),s=l);var b;for(p in t)if(t.hasOwnProperty(p)){var g=a.domInstance("input",t[p])||a.domInstance("textArea",t[p])||a.domInstance("select",t[p]);if(g&&t[p].form===l)g&&t[p].name!==p&&(t[p].setAttribute("name",p),t[p].name=p);else{var _=l.elements[p];if(b)for(_ instanceof NodeList||(_=[_]),d=0;d<_.length;d++)_[d].parentNode.removeChild(_[d]);b=c.createElement("input"),b.setAttribute("type","hidden"),b.setAttribute("name",p),g?b.value=t[p].value:a.domInstance(null,t[p])?b.value=t[p].innerHTML||t[p].innerText:b.value=t[p],l.appendChild(b)}}for(d=0;d<l.elements.length;d++)b=l.elements[d],b.name in t||b.getAttribute("disabled")===!0||(b.setAttribute("disabled",!0),f.push(b))}l.setAttribute("method","POST"),l.setAttribute("target",o),l.target=o,l.setAttribute("action",e),setTimeout(function(){l.submit(),setTimeout(function(){try{s&&s.parentNode.removeChild(s)}catch(e){try{console.error("HelloJS: could not remove iframe")}catch(t){}}for(var r=0;r<f.length;r++)f[r]&&(f[r].setAttribute("disabled",!1),f[r].disabled=!1)},0)},100)},hasBinary:function(e){for(var t in e)if(e.hasOwnProperty(t)&&this.isBinary(e[t]))return!0;return!1},isBinary:function(e){return e instanceof Object&&(this.domInstance("input",e)&&"file"===e.type||"FileList"in window&&e instanceof window.FileList||"File"in window&&e instanceof window.File||"Blob"in window&&e instanceof window.Blob)},toBlob:function(e){var t=/^data\:([^;,]+(\;charset=[^;,]+)?)(\;base64)?,/i,r=e.match(t);if(!r)return e;for(var n=atob(e.replace(t,"")),o=[],i=0;i<n.length;i++)o.push(n.charCodeAt(i));return new Blob([new Uint8Array(o)],{type:r[1]})}}),function(e){var t=e.api,r=e.utils;r.extend(r,{dataToJSON:function(e){var t=this,r=window,n=e.data;if(t.domInstance("form",n)?n=t.nodeListToJSON(n.elements):"NodeList"in r&&n instanceof NodeList?n=t.nodeListToJSON(n):t.domInstance("input",n)&&(n=t.nodeListToJSON([n])),("File"in r&&n instanceof r.File||"Blob"in r&&n instanceof r.Blob||"FileList"in r&&n instanceof r.FileList)&&(n={file:n}),!("FormData"in r&&n instanceof r.FormData))for(var o in n)if(n.hasOwnProperty(o))if("FileList"in r&&n[o]instanceof r.FileList)1===n[o].length&&(n[o]=n[o][0]);else{if(t.domInstance("input",n[o])&&"file"===n[o].type)continue;t.domInstance("input",n[o])||t.domInstance("select",n[o])||t.domInstance("textArea",n[o])?n[o]=n[o].value:t.domInstance(null,n[o])&&(n[o]=n[o].innerHTML||n[o].innerText)}return e.data=n,n},nodeListToJSON:function(e){for(var t={},r=0;r<e.length;r++){var n=e[r];!n.disabled&&n.name&&("file"===n.type?t[n.name]=n:t[n.name]=n.value||n.innerHTML)}return t}}),e.api=function(){var e=r.args({path:"s!",method:"s",data:"o",timeout:"i",callback:"f"},arguments);return e.data&&r.dataToJSON(e),t.call(this,e)}}(n),n.utils.responseHandler(window,window.opener||window.parent),"object"==typeof chrome&&"object"==typeof chrome.identity&&chrome.identity.launchWebAuthFlow&&!function(){function e(t,r){var o={closed:!1};return chrome.identity.launchWebAuthFlow({url:t,interactive:r},function(t){if(void 0===t)return void(o.closed=!0);var r=n.utils.url(t),i={location:{assign:function(t){e(t,!1)},search:r.search,hash:r.hash,href:r.href},close:function(){}};n.utils.responseHandler(i,window)}),o}n.utils.popup=function(t){return e(t,!0)},n.utils.iframe=function(t){e(t,!1)},n.utils.request_cors=function(e){return e(),!0};var t={};chrome.storage.local.get("hello",function(e){t=e.hello||{}}),n.utils.store=function(e,r){return 0===arguments.length?t:1===arguments.length?t[e]||null:r?(t[e]=r,chrome.storage.local.set({hello:t}),r):null===r?(delete t[e],chrome.storage.local.set({hello:t}),null):void 0}}(),function(e){function t(e){e&&"error"in e&&(e.error={code:"server_error",message:e.error.message||e.error})}function r(t,r,n){if(!("object"!=typeof t||"undefined"!=typeof Blob&&t instanceof Blob||"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer||"error"in t)){var o=("app_folder"!==t.root?t.root:"")+t.path.replace(/\&/g,"%26");o=o.replace(/^\//,""),t.thumb_exists&&(t.thumbnail=n.oauth_proxy+"?path="+encodeURIComponent("https://api-content.dropbox.com/1/thumbnails/auto/"+o+"?format=jpeg&size=m")+"&access_token="+n.options.access_token),t.type=t.is_dir?"folder":t.mime_type,t.name=t.path.replace(/.*\//g,""),t.is_dir?t.files=o.replace(/^\//,""):(t.downloadLink=e.settings.oauth_proxy+"?path="+encodeURIComponent("https://api-content.dropbox.com/1/files/auto/"+o)+"&access_token="+n.options.access_token,t.file="https://api-content.dropbox.com/1/files/auto/"+o),t.id||(t.id=t.path.replace(/^\//,""))}}function n(e){return function(t,r){delete t.query.limit,r(e)}}var o={version:"1.0",auth:"https://www.dropbox.com/1/oauth/authorize",request:"https://api.dropbox.com/1/oauth/request_token",token:"https://api.dropbox.com/1/oauth/access_token"},i={version:2,auth:"https://www.dropbox.com/1/oauth2/authorize",grant:"https://api.dropbox.com/1/oauth2/token"};e.init({dropbox:{name:"Dropbox",oauth:i,login:function(t){t.qs.scope="",delete t.qs.display;var r=decodeURIComponent(t.qs.redirect_uri);0===r.indexOf("http:")&&0!==r.indexOf("http://localhost/")?e.services.dropbox.oauth=o:e.services.dropbox.oauth=i,t.options.popup.width=1e3,t.options.popup.height=1e3},base:"https://api.dropbox.com/1/",root:"sandbox",get:{me:"account/info","me/files":n("metadata/auto/@{parent|}"),"me/folder":n("metadata/auto/@{id}"),"me/folders":n("metadata/auto/"),"default":function(e,t){e.path.match("https://api-content.dropbox.com/1/files/")&&(e.method="blob"),t(e.path)}},post:{"me/files":function(t,r){var n=t.data.parent,o=t.data.name;t.data={file:t.data.file},"string"==typeof t.data.file&&(t.data.file=e.utils.toBlob(t.data.file)),r("https://api-content.dropbox.com/1/files_put/auto/"+n+"/"+o)},"me/folders":function(t,r){var n=t.data.name;t.data={},r("fileops/create_folder?root=@{root|sandbox}&"+e.utils.param({path:n}))}},del:{"me/files":"fileops/delete?root=@{root|sandbox}&path=@{id}","me/folder":"fileops/delete?root=@{root|sandbox}&path=@{id}"},wrap:{me:function(e){if(t(e),!e.uid)return e;e.name=e.display_name;var r=e.name.split(" ");return e.first_name=r.shift(),e.last_name=r.join(" "),e.id=e.uid,delete e.uid,delete e.display_name,e},"default":function(e,n,o){
return t(e),e.is_dir&&e.contents&&(e.data=e.contents,delete e.contents,e.data.forEach(function(t){t.root=e.root,r(t,n,o)})),r(e,n,o),e.is_deleted&&(e.success=!0),e}},xhr:function(e){if(e.data&&e.data.file){var t=e.data.file;t&&(t.files?e.data=t.files[0]:e.data=t)}return"delete"===e.method&&(e.method="post"),!0},form:function(e,t){delete t.state,delete t.redirect_uri}}})}(n),function(e){function t(e){return e.id&&(e.thumbnail=e.picture="https://graph.facebook.com/"+e.id+"/picture"),e}function r(e){return"data"in e&&e.data.forEach(t),e}function n(e,t,r){if("boolean"==typeof e&&(e={success:e}),e&&"data"in e){var n=r.query.access_token;if(!(e.data instanceof Array)){var i=e.data;delete e.data,e.data=[i]}e.data.forEach(function(e){e.picture&&(e.thumbnail=e.picture),e.pictures=(e.images||[]).sort(function(e,t){return e.width-t.width}),e.cover_photo&&e.cover_photo.id&&(e.thumbnail=o+e.cover_photo.id+"/picture?access_token="+n),"album"===e.type&&(e.files=e.photos=o+e.id+"/photos"),e.can_upload&&(e.upload_location=o+e.id+"/photos")})}return e}e.init({facebook:{name:"Facebook",oauth:{version:2,auth:"https://www.facebook.com/dialog/oauth/",grant:"https://graph.facebook.com/oauth/access_token"},scope:{basic:"public_profile",email:"email",share:"user_posts",birthday:"user_birthday",events:"user_events",photos:"user_photos",videos:"user_videos",friends:"user_friends",files:"user_photos,user_videos",publish_files:"user_photos,user_videos,publish_actions",publish:"publish_actions",offline_access:"offline_access"},refresh:!0,login:function(e){e.options.force&&(e.qs.auth_type="reauthenticate"),e.options.popup.width=580,e.options.popup.height=400},logout:function(t,r){var n=e.utils.globalEvent(t),o=encodeURIComponent(e.settings.redirect_uri+"?"+e.utils.param({callback:n,result:JSON.stringify({force:!0}),state:"{}"})),i=(r.authResponse||{}).access_token;return e.utils.iframe("https://www.facebook.com/logout.php?next="+o+"&access_token="+i),i?void 0:!1},base:"https://graph.facebook.com/v2.4/",get:{me:"me?fields=email,first_name,last_name,name,timezone,verified","me/friends":"me/friends","me/following":"me/friends","me/followers":"me/friends","me/share":"me/feed","me/like":"me/likes","me/files":"me/albums","me/albums":"me/albums?fields=cover_photo,name","me/album":"@{id}/photos?fields=picture","me/photos":"me/photos","me/photo":"@{id}","friend/albums":"@{id}/albums","friend/photos":"@{id}/photos"},post:{"me/share":"me/feed","me/photo":"@{id}"},wrap:{me:t,"me/friends":r,"me/following":r,"me/followers":r,"me/albums":n,"me/photos":n,"me/files":n,"default":n},xhr:function(t,r){return("get"===t.method||"post"===t.method)&&(r.suppress_response_codes=!0),"post"===t.method&&t.data&&"string"==typeof t.data.file&&(t.data.file=e.utils.toBlob(t.data.file)),!0},jsonp:function(t,r){var n=t.method;"get"===n||e.utils.hasBinary(t.data)?"delete"===t.method&&(r.method="delete",t.method="post"):(t.data.method=n,t.method="get")},form:function(e){return{callbackonload:!0}}}});var o="https://graph.facebook.com/"}(n),function(e){function t(t,r,n){var o=(n?"":"flickr:")+"?method="+t+"&api_key="+e.services.flickr.id+"&format=json";for(var i in r)r.hasOwnProperty(i)&&(o+="&"+i+"="+r[i]);return o}function r(t){var r=e.getAuthResponse("flickr");t(r&&r.user_nsid?r.user_nsid:null)}function n(e,n){return n||(n={}),function(o,i){r(function(r){n.user_id=r,i(t(e,n,!0))})}}function o(e,t){var r="https://www.flickr.com/images/buddyicon.gif";return e.nsid&&e.iconserver&&e.iconfarm&&(r="https://farm"+e.iconfarm+".staticflickr.com/"+e.iconserver+"/buddyicons/"+e.nsid+(t?"_"+t:"")+".jpg"),r}function i(e,t,r,n,o){return o=o?"_"+o:"","https://farm"+t+".staticflickr.com/"+r+"/"+e+"_"+n+o+".jpg"}function s(e){e&&e.stat&&"ok"!=e.stat.toLowerCase()&&(e.error={code:"invalid_request",message:e.message})}function a(e){if(e.photoset||e.photos){var t="photoset"in e?"photoset":"photos";e=c(e,t),f(e),e.data=e.photo,delete e.photo;for(var r=0;r<e.data.length;r++){var n=e.data[r];n.name=n.title,n.picture=i(n.id,n.farm,n.server,n.secret,""),n.pictures=u(n.id,n.farm,n.server,n.secret),n.source=i(n.id,n.farm,n.server,n.secret,"b"),n.thumbnail=i(n.id,n.farm,n.server,n.secret,"m")}}return e}function u(e,t,r,n){var o=2048,s=[{id:"t",max:100},{id:"m",max:240},{id:"n",max:320},{id:"",max:500},{id:"z",max:640},{id:"c",max:800},{id:"b",max:1024},{id:"h",max:1600},{id:"k",max:2048},{id:"o",max:o}];return s.map(function(o){return{source:i(e,t,r,n,o.id),width:o.max,height:o.max}})}function c(e,t){return t in e?e=e[t]:"error"in e||(e.error={code:"invalid_request",message:e.message||"Failed to get data from Flickr"}),e}function l(e){if(s(e),e.contacts){e=c(e,"contacts"),f(e),e.data=e.contact,delete e.contact;for(var t=0;t<e.data.length;t++){var r=e.data[t];r.id=r.nsid,r.name=r.realname||r.username,r.thumbnail=o(r,"m")}}return e}function f(e){e.page&&e.pages&&e.page!==e.pages&&(e.paging={next:"?page="+ ++e.page})}e.init({flickr:{name:"Flickr",oauth:{version:"1.0a",auth:"https://www.flickr.com/services/oauth/authorize?perms=read",request:"https://www.flickr.com/services/oauth/request_token",token:"https://www.flickr.com/services/oauth/access_token"},base:"https://api.flickr.com/services/rest",get:{me:n("flickr.people.getInfo"),"me/friends":n("flickr.contacts.getList",{per_page:"@{limit|50}"}),"me/following":n("flickr.contacts.getList",{per_page:"@{limit|50}"}),"me/followers":n("flickr.contacts.getList",{per_page:"@{limit|50}"}),"me/albums":n("flickr.photosets.getList",{per_page:"@{limit|50}"}),"me/album":n("flickr.photosets.getPhotos",{photoset_id:"@{id}"}),"me/photos":n("flickr.people.getPhotos",{per_page:"@{limit|50}"})},wrap:{me:function(e){if(s(e),e=c(e,"person"),e.id){if(e.realname){e.name=e.realname._content;var t=e.name.split(" ");e.first_name=t.shift(),e.last_name=t.join(" ")}e.thumbnail=o(e,"l"),e.picture=o(e,"l")}return e},"me/friends":l,"me/followers":l,"me/following":l,"me/albums":function(e){return s(e),e=c(e,"photosets"),f(e),e.photoset&&(e.data=e.photoset,e.data.forEach(function(e){e.name=e.title._content,e.photos="https://api.flickr.com/services/rest"+t("flickr.photosets.getPhotos",{photoset_id:e.id},!0)}),delete e.photoset),e},"me/photos":function(e){return s(e),a(e)},"default":function(e){return s(e),a(e)}},xhr:!1,jsonp:function(e,t){"get"==e.method&&(delete t.callback,t.jsoncallback=e.callbackID)}}})}(n),function(e){function t(e){!e.meta||400!==e.meta.code&&401!==e.meta.code||(e.error={code:"access_denied",message:e.meta.errorDetail})}function r(e){e&&e.id&&(e.thumbnail=e.photo.prefix+"100x100"+e.photo.suffix,e.name=e.firstName+" "+e.lastName,e.first_name=e.firstName,e.last_name=e.lastName,e.contact&&e.contact.email&&(e.email=e.contact.email))}function n(e,t){var r=t.access_token;return delete t.access_token,t.oauth_token=r,t.v=20121125,!0}e.init({foursquare:{name:"Foursquare",oauth:{version:2,auth:"https://foursquare.com/oauth2/authenticate",grant:"https://foursquare.com/oauth2/access_token"},refresh:!0,base:"https://api.foursquare.com/v2/",get:{me:"users/self","me/friends":"users/self/friends","me/followers":"users/self/friends","me/following":"users/self/friends"},wrap:{me:function(e){return t(e),e&&e.response&&(e=e.response.user,r(e)),e},"default":function(e){return t(e),e&&"response"in e&&"friends"in e.response&&"items"in e.response.friends&&(e.data=e.response.friends.items,e.data.forEach(r),delete e.response),e}},xhr:n,jsonp:n}})}(n),function(e){function t(e,t){var r=t?t.statusCode:e&&"meta"in e&&"status"in e.meta&&e.meta.status;(401===r||403===r)&&(e.error={code:"access_denied",message:e.message||(e.data?e.data.message:"Could not get response")},delete e.message)}function r(e){e.id&&(e.thumbnail=e.picture=e.avatar_url,e.name=e.login)}function n(e,t,r){if(e.data&&e.data.length&&t&&t.Link){var n=t.Link.match(/<(.*?)>;\s*rel=\"next\"/);n&&(e.paging={next:n[1]})}}e.init({github:{name:"GitHub",oauth:{version:2,auth:"https://github.com/login/oauth/authorize",grant:"https://github.com/login/oauth/access_token",response_type:"code"},scope:{email:"user:email"},base:"https://api.github.com/",get:{me:"user","me/friends":"user/following?per_page=@{limit|100}","me/following":"user/following?per_page=@{limit|100}","me/followers":"user/followers?per_page=@{limit|100}","me/like":"user/starred?per_page=@{limit|100}"},wrap:{me:function(e,n){return t(e,n),r(e),e},"default":function(e,o,i){return t(e,o),Array.isArray(e)&&(e={data:e}),e.data&&(n(e,o,i),e.data.forEach(r)),e}},xhr:function(e){return"get"!==e.method&&e.data&&(e.headers=e.headers||{},e.headers["Content-Type"]="application/json","object"==typeof e.data&&(e.data=JSON.stringify(e.data))),!0}}})}(n),function(e){function t(e){return parseInt(e,10)}function r(e){return l(e),e.data=e.items,delete e.items,e}function n(e){return e.error?void 0:(e.name||(e.name=e.title||e.message),e.picture||(e.picture=e.thumbnailLink),e.thumbnail||(e.thumbnail=e.thumbnailLink),"application/vnd.google-apps.folder"===e.mimeType&&(e.type="folder",e.files="https://www.googleapis.com/drive/v2/files?q=%22"+e.id+"%22+in+parents"),e)}function o(e){return{source:e.url,width:e.width,height:e.height}}function i(e){e.data=e.feed.entry.map(c),delete e.feed}function s(e){if(l(e),"feed"in e&&"entry"in e.feed)e.data=e.feed.entry.map(c),delete e.feed;else{if("entry"in e)return c(e.entry);"items"in e?(e.data=e.items.map(n),delete e.items):n(e)}return e}function a(e){e.name=e.displayName||e.name,e.picture=e.picture||(e.image?e.image.url:null),e.thumbnail=e.picture}function u(e,t,r){l(e);if("feed"in e&&"entry"in e.feed){for(var n=r.query.access_token,o=0;o<e.feed.entry.length;o++){var i=e.feed.entry[o];if(i.id=i.id.$t,i.name=i.title.$t,delete i.title,i.gd$email&&(i.email=i.gd$email&&i.gd$email.length>0?i.gd$email[0].address:null,i.emails=i.gd$email,delete i.gd$email),i.updated&&(i.updated=i.updated.$t),i.link){var s=i.link.length>0?i.link[0].href:null;s&&i.link[0].gd$etag&&(s+=(s.indexOf("?")>-1?"&":"?")+"access_token="+n,i.picture=s,i.thumbnail=s),delete i.link}i.category&&delete i.category}e.data=e.feed.entry,delete e.feed}return e}function c(e){var t,r=e.media$group,n=r.media$content.length?r.media$content[0]:{},i=r.media$content||[],s=r.media$thumbnail||[],a=i.concat(s).map(o).sort(function(e,t){return e.width-t.width}),u=0,c={id:e.id.$t,name:e.title.$t,description:e.summary.$t,updated_time:e.updated.$t,created_time:e.published.$t,picture:n?n.url:null,pictures:a,images:[],thumbnail:n?n.url:null,width:n.width,height:n.height};if("link"in e)for(u=0;u<e.link.length;u++){var l=e.link[u];if(l.rel.match(/\#feed$/)){c.upload_location=c.files=c.photos=l.href;break}}if("category"in e&&e.category.length)for(t=e.category,u=0;u<t.length;u++)t[u].scheme&&t[u].scheme.match(/\#kind$/)&&(c.type=t[u].term.replace(/^.*?\#/,""));return"media$thumbnail"in r&&r.media$thumbnail.length&&(t=r.media$thumbnail,c.thumbnail=t[0].url,c.images=t.map(o)),t=r.media$content,t&&t.length&&c.images.push(o(t[0])),c}function l(e){if("feed"in e&&e.feed.openSearch$itemsPerPage){var r=t(e.feed.openSearch$itemsPerPage.$t),n=t(e.feed.openSearch$startIndex.$t),o=t(e.feed.openSearch$totalResults.$t);o>n+r&&(e.paging={next:"?start="+(n+r)})}else"nextPageToken"in e&&(e.paging={next:"?pageToken="+e.nextPageToken})}function f(){function e(e){var r=new FileReader;r.onload=function(r){t(btoa(r.target.result),e.type+i+"Content-Transfer-Encoding: base64")},r.readAsBinaryString(e)}function t(e,t){r.push(i+"Content-Type: "+t+i+i+e),o--,a()}var r=[],n=(1e10*Math.random()).toString(32),o=0,i="\r\n",s=i+"--"+n,a=function(){},u=/^data\:([^;,]+(\;charset=[^;,]+)?)(\;base64)?,/i;this.append=function(r,n){"string"!=typeof r&&"length"in Object(r)||(r=[r]);for(var s=0;s<r.length;s++){o++;var a=r[s];if("undefined"!=typeof File&&a instanceof File||"undefined"!=typeof Blob&&a instanceof Blob)e(a);else if("string"==typeof a&&a.match(u)){var c=a.match(u);t(a.replace(u,""),c[1]+i+"Content-Transfer-Encoding: base64")}else t(a,n)}},this.onready=function(e){(a=function(){0===o&&(r.unshift(""),r.push("--"),e(r.join(s),n),r=[])})()}}function d(e,t){var r={};e.data&&"undefined"!=typeof HTMLInputElement&&e.data instanceof HTMLInputElement&&(e.data={file:e.data}),!e.data.name&&Object(Object(e.data.file).files).length&&"post"===e.method&&(e.data.name=e.data.file.files[0].name),"post"===e.method?e.data={title:e.data.name,parents:[{id:e.data.parent||"root"}],file:e.data.file}:(r=e.data,e.data={},r.parent&&(e.data.parents=[{id:e.data.parent||"root"}]),r.file&&(e.data.file=r.file),r.name&&(e.data.title=r.name));var n;if("file"in e.data&&(n=e.data.file,delete e.data.file,"object"==typeof n&&"files"in n&&(n=n.files),!n||!n.length))return void t({error:{code:"request_invalid",message:"There were no files attached with this request to upload"}});var o=new f;o.append(JSON.stringify(e.data),"application/json"),n&&o.append(n),o.onready(function(n,o){e.headers["content-type"]='multipart/related; boundary="'+o+'"',e.data=n,t("upload/drive/v2/files"+(r.id?"/"+r.id:"")+"?uploadType=multipart")})}function p(e){if("object"==typeof e.data)try{e.data=JSON.stringify(e.data),e.headers["content-type"]="application/json"}catch(t){}}var h="https://www.google.com/m8/feeds/contacts/default/full?v=3.0&alt=json&max-results=@{limit|1000}&start-index=@{start|1}";e.init({google:{name:"Google Plus",oauth:{version:2,auth:"https://accounts.google.com/o/oauth2/auth",grant:"https://accounts.google.com/o/oauth2/token"},scope:{basic:"https://www.googleapis.com/auth/plus.me profile",email:"email",birthday:"",events:"",photos:"https://picasaweb.google.com/data/",videos:"http://gdata.youtube.com",friends:"https://www.google.com/m8/feeds, https://www.googleapis.com/auth/plus.login",files:"https://www.googleapis.com/auth/drive.readonly",publish:"",publish_files:"https://www.googleapis.com/auth/drive",create_event:"",offline_access:""},scope_delim:" ",login:function(e){"none"===e.qs.display&&(e.qs.display=""),"code"===e.qs.response_type&&(e.qs.access_type="offline"),e.options.force&&(e.qs.approval_prompt="force")},base:"https://www.googleapis.com/",get:{me:"plus/v1/people/me","me/friends":"plus/v1/people/me/people/visible?maxResults=@{limit|100}","me/following":h,"me/followers":h,"me/contacts":h,"me/share":"plus/v1/people/me/activities/public?maxResults=@{limit|100}","me/feed":"plus/v1/people/me/activities/public?maxResults=@{limit|100}","me/albums":"https://picasaweb.google.com/data/feed/api/user/default?alt=json&max-results=@{limit|100}&start-index=@{start|1}","me/album":function(e,t){var r=e.query.id;delete e.query.id,t(r.replace("/entry/","/feed/"))},"me/photos":"https://picasaweb.google.com/data/feed/api/user/default?alt=json&kind=photo&max-results=@{limit|100}&start-index=@{start|1}","me/file":"drive/v2/files/@{id}","me/files":"drive/v2/files?q=%22@{parent|root}%22+in+parents+and+trashed=false&maxResults=@{limit|100}","me/folders":"drive/v2/files?q=%22@{id|root}%22+in+parents+and+mimeType+=+%22application/vnd.google-apps.folder%22+and+trashed=false&maxResults=@{limit|100}","me/folder":"drive/v2/files?q=%22@{id|root}%22+in+parents+and+trashed=false&maxResults=@{limit|100}"},post:{"me/files":d,"me/folders":function(e,t){e.data={title:e.data.name,parents:[{id:e.data.parent||"root"}],mimeType:"application/vnd.google-apps.folder"},t("drive/v2/files")}},put:{"me/files":d},del:{"me/files":"drive/v2/files/@{id}","me/folder":"drive/v2/files/@{id}"},patch:{"me/file":"drive/v2/files/@{id}"},wrap:{me:function(e){return e.id&&(e.last_name=e.family_name||(e.name?e.name.familyName:null),e.first_name=e.given_name||(e.name?e.name.givenName:null),e.emails&&e.emails.length&&(e.email=e.emails[0].value),a(e)),e},"me/friends":function(e){return e.items&&(l(e),e.data=e.items,e.data.forEach(a),delete e.items),e},"me/contacts":u,"me/followers":u,"me/following":u,"me/share":r,"me/feed":r,"me/albums":s,"me/photos":i,"default":s},xhr:function(t){return"post"===t.method||"put"===t.method?p(t):"patch"===t.method&&(e.utils.extend(t.query,t.data),t.data=null),!0},form:!1}})}(n),function(e){function t(e){return{source:e.url,width:e.width,height:e.height}}function r(e){return"string"==typeof e?{error:{code:"invalid_request",message:e}}:(e&&"meta"in e&&"error_type"in e.meta&&(e.error={code:e.meta.error_type,message:e.meta.error_message}),e)}function n(e){return i(e),e&&"data"in e&&e.data.forEach(o),e}function o(e){e.id&&(e.thumbnail=e.profile_picture,e.name=e.full_name||e.username)}function i(e){"pagination"in e&&(e.paging={next:e.pagination.next_url},delete e.pagination)}e.init({instagram:{name:"Instagram",oauth:{version:2,auth:"https://instagram.com/oauth/authorize/",grant:"https://api.instagram.com/oauth/access_token"},refresh:!0,scope:{basic:"basic",friends:"relationships",publish:"likes comments"},scope_delim:" ",login:function(e){e.qs.display=""},base:"https://api.instagram.com/v1/",get:{me:"users/self","me/feed":"users/self/feed?count=@{limit|100}","me/photos":"users/self/media/recent?min_id=0&count=@{limit|100}","me/friends":"users/self/follows?count=@{limit|100}","me/following":"users/self/follows?count=@{limit|100}","me/followers":"users/self/followed-by?count=@{limit|100}","friend/photos":"users/@{id}/media/recent?min_id=0&count=@{limit|100}"},post:{"me/like":function(e,t){var r=e.data.id;e.data={},t("media/"+r+"/likes")}},del:{"me/like":"media/@{id}/likes"},wrap:{me:function(e){return r(e),"data"in e&&(e.id=e.data.id,e.thumbnail=e.data.profile_picture,e.name=e.data.full_name||e.data.username),e},"me/friends":n,"me/following":n,"me/followers":n,"me/photos":function(e){return r(e),i(e),"data"in e&&(e.data=e.data.filter(function(e){return"image"===e.type}),e.data.forEach(function(e){e.name=e.caption?e.caption.text:null,e.thumbnail=e.images.thumbnail.url,e.picture=e.images.standard_resolution.url,e.pictures=Object.keys(e.images).map(function(r){var n=e.images[r];return t(n)}).sort(function(e,t){return e.width-t.width})})),e},"default":function(e){return e=r(e),i(e),e}},xhr:function(e,t){var r=e.method,n="get"!==r;return n&&("post"!==r&&"put"!==r||!e.query.access_token||(e.data.access_token=e.query.access_token,delete e.query.access_token),e.proxy=n),n},form:!1}})}(n),function(e){function t(e,t){var r,o;return e&&"Message"in e&&(o=e.Message,delete e.Message,"ErrorCode"in e?(r=e.ErrorCode,delete e.ErrorCode):r=n(t),e.error={code:r,message:o,details:e}),e}function r(e,t){var r=t.access_token;return delete t.access_token,e.headers.Authorization="Bearer "+r,"get"!==e.method&&e.data&&(e.headers["Content-Type"]="application/json","object"==typeof e.data&&(e.data=JSON.stringify(e.data))),"put"===e.method&&(e.method="patch"),!0}function n(e){switch(e.statusCode){case 400:return"invalid_request";case 403:return"stale_token";case 401:return"invalid_token";case 500:return"server_error";default:return"server_error"}}e.init({joinme:{name:"join.me",oauth:{version:2,auth:"https://secure.join.me/api/public/v1/auth/oauth2",grant:"https://secure.join.me/api/public/v1/auth/oauth2"},refresh:!1,scope:{basic:"user_info",user:"user_info",scheduler:"scheduler",start:"start_meeting"},scope_delim:" ",login:function(e){e.options.popup.width=400,e.options.popup.height=700},base:"https://api.join.me/v1/",get:{me:"user",meetings:"meetings","meetings/info":"meetings/@{id}"},post:{"meetings/start/adhoc":function(e,t){t("meetings/start")},"meetings/start/scheduled":function(e,t){var r=e.data.meetingId;e.data={},t("meetings/"+r+"/start")},"meetings/schedule":function(e,t){t("meetings")}},patch:{"meetings/update":function(e,t){t("meetings/"+e.data.meetingId)}},del:{"meetings/delete":"meetings/@{id}"},wrap:{me:function(e,r){return t(e,r),e.email?(e.name=e.fullName,e.first_name=e.name.split(" ")[0],e.last_name=e.name.split(" ")[1],e.id=e.email,e):e},"default":function(e,r){return t(e,r),e}},xhr:r}})}(n),function(e){function t(e){e&&"errorCode"in e&&(e.error={code:e.status,message:e.message})}function r(e){return e.error?void 0:(e.first_name=e.firstName,e.last_name=e.lastName,e.name=e.formattedName||e.first_name+" "+e.last_name,e.thumbnail=e.pictureUrl,e.email=e.emailAddress,e)}function n(e){return t(e),o(e),e.values&&(e.data=e.values.map(r),delete e.values),e}function o(e){"_count"in e&&"_start"in e&&e._count+e._start<e._total&&(e.paging={next:"?start="+(e._start+e._count)+"&count="+e._count})}function i(e,t){"{}"===JSON.stringify(e)&&200===t.statusCode&&(e.success=!0)}function s(e){e.access_token&&(e.oauth2_access_token=e.access_token,delete e.access_token)}function a(e,t){e.headers["x-li-format"]="json";var r=e.data.id;e.data=("delete"!==e.method).toString(),e.method="put",t("people/~/network/updates/key="+r+"/is-liked")}e.init({linkedin:{oauth:{version:2,response_type:"code",auth:"https://www.linkedin.com/uas/oauth2/authorization",grant:"https://www.linkedin.com/uas/oauth2/accessToken"},refresh:!0,scope:{basic:"r_basicprofile",email:"r_emailaddress",friends:"",publish:"w_share"},scope_delim:" ",base:"https://api.linkedin.com/v1/",get:{me:"people/~:(picture-url,first-name,last-name,id,formatted-name,email-address)","me/share":"people/~/network/updates?count=@{limit|250}"},post:{"me/share":function(e,t){var r={visibility:{code:"anyone"}};e.data.id?r.attribution={share:{id:e.data.id}}:(r.comment=e.data.message,e.data.picture&&e.data.link&&(r.content={"submitted-url":e.data.link,"submitted-image-url":e.data.picture})),e.data=JSON.stringify(r),t("people/~/shares?format=json")},"me/like":a},del:{"me/like":a},wrap:{me:function(e){return t(e),r(e),e},"me/friends":n,"me/following":n,"me/followers":n,"me/share":function(e){return t(e),o(e),e.values&&(e.data=e.values.map(r),e.data.forEach(function(e){e.message=e.headline}),delete e.values),e},"default":function(e,r){t(e),i(e,r),o(e)}},jsonp:function(e,t){s(t),"get"===e.method&&(t.format="jsonp",t["error-callback"]=e.callbackID)},xhr:function(e,t){return"get"!==e.method?(s(t),e.headers["Content-Type"]="application/json",e.headers["x-li-format"]="json",e.proxy=!0,!0):!1}}})}(n),function(e){function t(e,t){var r=t.access_token;return delete t.access_token,t.oauth_token=r,t["_status_code_map[302]"]=200,!0}function r(e){return e.id&&(e.picture=e.avatar_url,e.thumbnail=e.avatar_url,e.name=e.username||e.full_name),e}function n(e){"next_href"in e&&(e.paging={next:e.next_href})}e.init({soundcloud:{name:"SoundCloud",oauth:{version:2,auth:"https://soundcloud.com/connect",grant:"https://soundcloud.com/oauth2/token"},base:"https://api.soundcloud.com/",get:{me:"me.json","me/friends":"me/followings.json","me/followers":"me/followers.json","me/following":"me/followings.json","default":function(e,t){t(e.path+".json")}},wrap:{me:function(e){return r(e),e},"default":function(e){return Array.isArray(e)&&(e={data:e.map(r)}),n(e),e}},xhr:t,jsonp:t}})}(n),function(e){function t(e){if(e.id){if(e.name){var t=e.name.split(" ");e.first_name=t.shift(),e.last_name=t.join(" ")}e.thumbnail=e.profile_image_url_https||e.profile_image_url}return e}function r(e){return n(e),o(e),e.users&&(e.data=e.users.map(t),delete e.users),e}function n(e){if(e.errors){var t=e.errors[0];e.error={code:"request_failed",message:t.message}}}function o(e){"next_cursor_str"in e&&(e.paging={next:"?cursor="+e.next_cursor_str})}function i(e){return Array.isArray(e)?{data:e}:e}var s="https://api.twitter.com/";e.init({twitter:{oauth:{version:"1.0a",auth:s+"oauth/authenticate",request:s+"oauth/request_token",token:s+"oauth/access_token"},login:function(e){var t="?force_login=true";this.oauth.auth=this.oauth.auth.replace(t,"")+(e.options.force?t:"")},base:s+"1.1/",get:{me:"account/verify_credentials.json","me/friends":"friends/list.json?count=@{limit|200}","me/following":"friends/list.json?count=@{limit|200}","me/followers":"followers/list.json?count=@{limit|200}","me/share":"statuses/user_timeline.json?count=@{limit|200}","me/like":"favorites/list.json?count=@{limit|200}"},post:{"me/share":function(t,r){var n=t.data;t.data=null;var o=[];n.message&&(o.push(n.message),delete n.message),n.link&&(o.push(n.link),delete n.link),n.picture&&(o.push(n.picture),delete n.picture),o.length&&(n.status=o.join(" ")),n.file?(n["media[]"]=n.file,delete n.file,t.data=n,r("statuses/update_with_media.json")):"id"in n?r("statuses/retweet/"+n.id+".json"):(e.utils.extend(t.query,n),r("statuses/update.json?include_entities=1"))},"me/like":function(e,t){var r=e.data.id;e.data=null,t("favorites/create.json?id="+r)}},del:{"me/like":function(){p.method="post";var e=p.data.id;p.data=null,callback("favorites/destroy.json?id="+e)}},wrap:{me:function(e){return n(e),t(e),e},"me/friends":r,"me/followers":r,"me/following":r,"me/share":function(e){return n(e),o(e),!e.error&&"length"in e?{data:e}:e},"default":function(e){return e=i(e),o(e),e}},xhr:function(e){return"get"!==e.method}}})}(n),function(e){function t(e,t){return null!==e&&"response"in e&&null!==e.response&&e.response.length&&(e=e.response[0],e.id=e.uid,e.thumbnail=e.picture=e.photo_max,e.name=e.first_name+" "+e.last_name,t.authResponse&&null!==t.authResponse.email&&(e.email=t.authResponse.email)),e}function r(e){if(e.error){var t=e.error;e.error={code:t.error_code,message:t.error_msg}}}e.init({vk:{name:"Vk",oauth:{version:2,auth:"https://oauth.vk.com/authorize",grant:"https://oauth.vk.com/access_token"},scope:{email:"email",offline_access:"offline"},refresh:!0,login:function(e){e.qs.display=window.navigator&&window.navigator.userAgent&&/ipad|phone|phone|android/.test(window.navigator.userAgent.toLowerCase())?"mobile":"popup"},base:"https://api.vk.com/method/",get:{me:function(e,t){e.query.fields="id,first_name,last_name,photo_max",t("users.get")}},wrap:{me:function(e,n,o){return r(e),t(e,o)}},xhr:!1,jsonp:!0,form:!1}})}(n),function(e){function t(e){return"data"in e&&e.data.forEach(function(e){e.picture&&(e.thumbnail=e.picture),e.images&&(e.pictures=e.images.map(r).sort(function(e,t){return e.width-t.width}))}),e}function r(e){return{width:e.width,height:e.height,source:e.source}}function n(e){return"data"in e&&e.data.forEach(function(e){e.photos=e.files="https://apis.live.net/v5.0/"+e.id+"/photos"}),e}function o(e,t,r){if(e.id){var n=r.query.access_token;if(e.emails&&(e.email=e.emails.preferred),e.is_friend!==!1){var o=e.user_id||e.id;e.thumbnail=e.picture="https://apis.live.net/v5.0/"+o+"/picture?access_token="+n}}return e}function i(e,t,r){return"data"in e&&e.data.forEach(function(e){o(e,t,r)}),e}e.init({windows:{name:"Windows live",oauth:{version:2,auth:"https://login.live.com/oauth20_authorize.srf",grant:"https://login.live.com/oauth20_token.srf"},refresh:!0,logout:function(){return"http://login.live.com/oauth20_logout.srf?ts="+(new Date).getTime()},scope:{basic:"wl.signin,wl.basic",email:"wl.emails",birthday:"wl.birthday",events:"wl.calendars",photos:"wl.photos",videos:"wl.photos",friends:"wl.contacts_emails",files:"wl.skydrive",publish:"wl.share",publish_files:"wl.skydrive_update",create_event:"wl.calendars_update,wl.events_create",offline_access:"wl.offline_access"},base:"https://apis.live.net/v5.0/",get:{me:"me","me/friends":"me/friends","me/following":"me/contacts","me/followers":"me/friends","me/contacts":"me/contacts","me/albums":"me/albums","me/album":"@{id}/files","me/photo":"@{id}","me/files":"@{parent|me/skydrive}/files","me/folders":"@{id|me/skydrive}/files","me/folder":"@{id|me/skydrive}/files"},post:{"me/albums":"me/albums","me/album":"@{id}/files/","me/folders":"@{id|me/skydrive/}","me/files":"@{parent|me/skydrive}/files"},del:{"me/album":"@{id}","me/photo":"@{id}","me/folder":"@{id}","me/files":"@{id}"},wrap:{me:o,"me/friends":i,"me/contacts":i,"me/followers":i,"me/following":i,"me/albums":n,"me/photos":t,"default":t},xhr:function(t){return"get"===t.method||"delete"===t.method||e.utils.hasBinary(t.data)||("string"==typeof t.data.file?t.data.file=e.utils.toBlob(t.data.file):(t.data=JSON.stringify(t.data),t.headers={"Content-Type":"application/json"})),!0},jsonp:function(t){"get"===t.method||e.utils.hasBinary(t.data)||(t.data.method=t.method,t.method="get")}}})}(n),function(e){function t(e){e&&"meta"in e&&"error_type"in e.meta&&(e.error={code:e.meta.error_type,message:e.meta.error_message})}function r(e){if(t(e),e.query&&e.query.results&&e.query.results.profile){e=e.query.results.profile,e.id=e.guid,e.last_name=e.familyName,e.first_name=e.givenName||e.nickname;var r=[];e.first_name&&r.push(e.first_name),e.last_name&&r.push(e.last_name),e.name=r.join(" "),e.email=e.emails&&e.emails[0]?e.emails[0].handle:null,e.thumbnail=e.image?e.image.imageUrl:null}return e}function n(e,r,n){t(e),i(e,r,n);return e.query&&e.query.results&&e.query.results.contact&&(e.data=e.query.results.contact,delete e.query,Array.isArray(e.data)||(e.data=[e.data]),e.data.forEach(o)),e}function o(e){e.id=null,!e.fields||e.fields instanceof Array||(e.fields=[e.fields]),(e.fields||[]).forEach(function(t){"email"===t.type&&(e.email=t.value),"name"===t.type&&(e.first_name=t.value.givenName,e.last_name=t.value.familyName,e.name=t.value.givenName+" "+t.value.familyName),"yahooid"===t.type&&(e.id=t.value)})}function i(e,t,r){return e.query&&e.query.count&&r.options&&(e.paging={next:"?start="+(e.query.count+(+r.options.start||1))}),e}function s(e){return"https://query.yahooapis.com/v1/yql?q="+(e+" limit @{limit|100} offset @{start|0}").replace(/\s/g,"%20")+"&format=json"}e.init({yahoo:{oauth:{version:"1.0a",auth:"https://api.login.yahoo.com/oauth/v2/request_auth",request:"https://api.login.yahoo.com/oauth/v2/get_request_token",token:"https://api.login.yahoo.com/oauth/v2/get_token"},login:function(e){e.options.popup.width=560;try{delete e.qs.state.scope}catch(t){}},base:"https://social.yahooapis.com/v1/",get:{me:s("select * from social.profile(0) where guid=me"),"me/friends":s("select * from social.contacts(0) where guid=me"),"me/following":s("select * from social.contacts(0) where guid=me")},wrap:{me:r,"me/friends":n,"me/following":n,"default":i}}})}(n),"function"==typeof e&&e.amd&&e(function(){return n}),"object"==typeof r&&r.exports&&(r.exports=n)}).call(this,t("_process"))},{_process:1}],3:[function(t,r,n){(function(o){!function(t){if("object"==typeof n&&"undefined"!=typeof r)r.exports=t();else if("function"==typeof e&&e.amd)e([],t);else{var i;i="undefined"!=typeof window?window:"undefined"!=typeof o?o:"undefined"!=typeof self?self:this,i.serviceFramework=t()}}(function(){var e;return function r(e,n,o){function i(a,u){if(!n[a]){if(!e[a]){var c="function"==typeof t&&t;if(!u&&c)return c(a,!0);if(s)return s(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var f=n[a]={exports:{}};e[a][0].call(f.exports,function(t){var r=e[a][1][t];return i(r?r:t)},f,f.exports,r,e,n,o)}return n[a].exports}for(var s="function"==typeof t&&t,a=0;a<o.length;a++)i(o[a]);return i}({1:[function(e,t,r){t.exports={"default":e("core-js/library/fn/object/create"),__esModule:!0}},{"core-js/library/fn/object/create":20}],2:[function(e,t,r){t.exports={"default":e("core-js/library/fn/object/define-property"),__esModule:!0}},{"core-js/library/fn/object/define-property":21}],3:[function(e,t,r){t.exports={"default":e("core-js/library/fn/object/freeze"),__esModule:!0}},{"core-js/library/fn/object/freeze":22}],4:[function(e,t,r){t.exports={"default":e("core-js/library/fn/object/get-own-property-descriptor"),__esModule:!0}},{"core-js/library/fn/object/get-own-property-descriptor":23}],5:[function(e,t,r){t.exports={"default":e("core-js/library/fn/object/get-prototype-of"),__esModule:!0}},{"core-js/library/fn/object/get-prototype-of":24}],6:[function(e,t,r){t.exports={"default":e("core-js/library/fn/object/keys"),__esModule:!0}},{"core-js/library/fn/object/keys":25}],7:[function(e,t,r){t.exports={"default":e("core-js/library/fn/object/set-prototype-of"),__esModule:!0}},{"core-js/library/fn/object/set-prototype-of":26}],8:[function(e,t,r){t.exports={"default":e("core-js/library/fn/promise"),__esModule:!0}},{"core-js/library/fn/promise":27}],9:[function(e,t,r){t.exports={"default":e("core-js/library/fn/symbol"),__esModule:!0}},{"core-js/library/fn/symbol":28}],10:[function(e,t,r){t.exports={"default":e("core-js/library/fn/symbol/iterator"),__esModule:!0
}},{"core-js/library/fn/symbol/iterator":29}],11:[function(e,t,r){t.exports=e("./classCallCheck.js")},{"./classCallCheck.js":12}],12:[function(e,t,r){"use strict";r.__esModule=!0,r["default"]=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},{}],13:[function(e,t,r){t.exports=e("./createClass.js")},{"./createClass.js":14}],14:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}r.__esModule=!0;var o=e("../core-js/object/define-property"),i=n(o);r["default"]=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,i["default"])(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}()},{"../core-js/object/define-property":2}],15:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}r.__esModule=!0;var o=e("../core-js/object/get-prototype-of"),i=n(o),s=e("../core-js/object/get-own-property-descriptor"),a=n(s);r["default"]=function u(e,t,r){null===e&&(e=Function.prototype);var n=(0,a["default"])(e,t);if(void 0===n){var o=(0,i["default"])(e);return null===o?void 0:u(o,t,r)}if("value"in n)return n.value;var s=n.get;return void 0!==s?s.call(r):void 0}},{"../core-js/object/get-own-property-descriptor":4,"../core-js/object/get-prototype-of":5}],16:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}r.__esModule=!0;var o=e("../core-js/object/set-prototype-of"),i=n(o),s=e("../core-js/object/create"),a=n(s),u=e("../helpers/typeof"),c=n(u);r["default"]=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":(0,c["default"])(t)));e.prototype=(0,a["default"])(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(i["default"]?(0,i["default"])(e,t):e.__proto__=t)}},{"../core-js/object/create":1,"../core-js/object/set-prototype-of":7,"../helpers/typeof":19}],17:[function(e,t,r){t.exports=e("./interopRequireDefault.js")},{"./interopRequireDefault.js":18}],18:[function(e,t,r){"use strict";r.__esModule=!0,r["default"]=function(e){return e&&e.__esModule?e:{"default":e}}},{}],19:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){return e&&"undefined"!=typeof _Symbol&&e.constructor===_Symbol?"symbol":typeof e}r.__esModule=!0;var i=e("../core-js/symbol"),s=n(i);r["default"]=function(e){return e&&"undefined"!=typeof s["default"]&&e.constructor===s["default"]?"symbol":"undefined"==typeof e?"undefined":o(e)}},{"../core-js/symbol":9}],20:[function(e,t,r){var n=e("../../modules/$");t.exports=function(e,t){return n.create(e,t)}},{"../../modules/$":60}],21:[function(e,t,r){var n=e("../../modules/$");t.exports=function(e,t,r){return n.setDesc(e,t,r)}},{"../../modules/$":60}],22:[function(e,t,r){e("../../modules/es6.object.freeze"),t.exports=e("../../modules/$.core").Object.freeze},{"../../modules/$.core":35,"../../modules/es6.object.freeze":85}],23:[function(e,t,r){var n=e("../../modules/$");e("../../modules/es6.object.get-own-property-descriptor"),t.exports=function(e,t){return n.getDesc(e,t)}},{"../../modules/$":60,"../../modules/es6.object.get-own-property-descriptor":86}],24:[function(e,t,r){e("../../modules/es6.object.get-prototype-of"),t.exports=e("../../modules/$.core").Object.getPrototypeOf},{"../../modules/$.core":35,"../../modules/es6.object.get-prototype-of":87}],25:[function(e,t,r){e("../../modules/es6.object.keys"),t.exports=e("../../modules/$.core").Object.keys},{"../../modules/$.core":35,"../../modules/es6.object.keys":88}],26:[function(e,t,r){e("../../modules/es6.object.set-prototype-of"),t.exports=e("../../modules/$.core").Object.setPrototypeOf},{"../../modules/$.core":35,"../../modules/es6.object.set-prototype-of":89}],27:[function(e,t,r){e("../modules/es6.object.to-string"),e("../modules/es6.string.iterator"),e("../modules/web.dom.iterable"),e("../modules/es6.promise"),t.exports=e("../modules/$.core").Promise},{"../modules/$.core":35,"../modules/es6.object.to-string":90,"../modules/es6.promise":91,"../modules/es6.string.iterator":92,"../modules/web.dom.iterable":94}],28:[function(e,t,r){e("../../modules/es6.symbol"),e("../../modules/es6.object.to-string"),t.exports=e("../../modules/$.core").Symbol},{"../../modules/$.core":35,"../../modules/es6.object.to-string":90,"../../modules/es6.symbol":93}],29:[function(e,t,r){e("../../modules/es6.string.iterator"),e("../../modules/web.dom.iterable"),t.exports=e("../../modules/$.wks")("iterator")},{"../../modules/$.wks":82,"../../modules/es6.string.iterator":92,"../../modules/web.dom.iterable":94}],30:[function(e,t,r){t.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},{}],31:[function(e,t,r){t.exports=function(){}},{}],32:[function(e,t,r){var n=e("./$.is-object");t.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},{"./$.is-object":53}],33:[function(e,t,r){var n=e("./$.cof"),o=e("./$.wks")("toStringTag"),i="Arguments"==n(function(){return arguments}());t.exports=function(e){var t,r,s;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=(t=Object(e))[o])?r:i?n(t):"Object"==(s=n(t))&&"function"==typeof t.callee?"Arguments":s}},{"./$.cof":34,"./$.wks":82}],34:[function(e,t,r){var n={}.toString;t.exports=function(e){return n.call(e).slice(8,-1)}},{}],35:[function(e,t,r){var n=t.exports={version:"1.2.6"};"number"==typeof __e&&(__e=n)},{}],36:[function(e,t,r){var n=e("./$.a-function");t.exports=function(e,t,r){if(n(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,o){return e.call(t,r,n,o)}}return function(){return e.apply(t,arguments)}}},{"./$.a-function":30}],37:[function(e,t,r){t.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},{}],38:[function(e,t,r){t.exports=!e("./$.fails")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},{"./$.fails":42}],39:[function(e,t,r){var n=e("./$.is-object"),o=e("./$.global").document,i=n(o)&&n(o.createElement);t.exports=function(e){return i?o.createElement(e):{}}},{"./$.global":45,"./$.is-object":53}],40:[function(e,t,r){var n=e("./$");t.exports=function(e){var t=n.getKeys(e),r=n.getSymbols;if(r)for(var o,i=r(e),s=n.isEnum,a=0;i.length>a;)s.call(e,o=i[a++])&&t.push(o);return t}},{"./$":60}],41:[function(e,t,r){var n=e("./$.global"),o=e("./$.core"),i=e("./$.ctx"),s="prototype",a=function(e,t,r){var u,c,l,f=e&a.F,d=e&a.G,p=e&a.S,h=e&a.P,m=e&a.B,y=e&a.W,v=d?o:o[t]||(o[t]={}),b=d?n:p?n[t]:(n[t]||{})[s];d&&(r=t);for(u in r)c=!f&&b&&u in b,c&&u in v||(l=c?b[u]:r[u],v[u]=d&&"function"!=typeof b[u]?r[u]:m&&c?i(l,n):y&&b[u]==l?function(e){var t=function(t){return this instanceof e?new e(t):e(t)};return t[s]=e[s],t}(l):h&&"function"==typeof l?i(Function.call,l):l,h&&((v[s]||(v[s]={}))[u]=l))};a.F=1,a.G=2,a.S=4,a.P=8,a.B=16,a.W=32,t.exports=a},{"./$.core":35,"./$.ctx":36,"./$.global":45}],42:[function(e,t,r){t.exports=function(e){try{return!!e()}catch(t){return!0}}},{}],43:[function(e,t,r){var n=e("./$.ctx"),o=e("./$.iter-call"),i=e("./$.is-array-iter"),s=e("./$.an-object"),a=e("./$.to-length"),u=e("./core.get-iterator-method");t.exports=function(e,t,r,c){var l,f,d,p=u(e),h=n(r,c,t?2:1),m=0;if("function"!=typeof p)throw TypeError(e+" is not iterable!");if(i(p))for(l=a(e.length);l>m;m++)t?h(s(f=e[m])[0],f[1]):h(e[m]);else for(d=p.call(e);!(f=d.next()).done;)o(d,h,f.value,t)}},{"./$.an-object":32,"./$.ctx":36,"./$.is-array-iter":51,"./$.iter-call":54,"./$.to-length":79,"./core.get-iterator-method":83}],44:[function(e,t,r){var n=e("./$.to-iobject"),o=e("./$").getNames,i={}.toString,s="object"==typeof window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],a=function(e){try{return o(e)}catch(t){return s.slice()}};t.exports.get=function(e){return s&&"[object Window]"==i.call(e)?a(e):o(n(e))}},{"./$":60,"./$.to-iobject":78}],45:[function(e,t,r){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},{}],46:[function(e,t,r){var n={}.hasOwnProperty;t.exports=function(e,t){return n.call(e,t)}},{}],47:[function(e,t,r){var n=e("./$"),o=e("./$.property-desc");t.exports=e("./$.descriptors")?function(e,t,r){return n.setDesc(e,t,o(1,r))}:function(e,t,r){return e[t]=r,e}},{"./$":60,"./$.descriptors":38,"./$.property-desc":65}],48:[function(e,t,r){t.exports=e("./$.global").document&&document.documentElement},{"./$.global":45}],49:[function(e,t,r){t.exports=function(e,t,r){var n=void 0===r;switch(t.length){case 0:return n?e():e.call(r);case 1:return n?e(t[0]):e.call(r,t[0]);case 2:return n?e(t[0],t[1]):e.call(r,t[0],t[1]);case 3:return n?e(t[0],t[1],t[2]):e.call(r,t[0],t[1],t[2]);case 4:return n?e(t[0],t[1],t[2],t[3]):e.call(r,t[0],t[1],t[2],t[3])}return e.apply(r,t)}},{}],50:[function(e,t,r){var n=e("./$.cof");t.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==n(e)?e.split(""):Object(e)}},{"./$.cof":34}],51:[function(e,t,r){var n=e("./$.iterators"),o=e("./$.wks")("iterator"),i=Array.prototype;t.exports=function(e){return void 0!==e&&(n.Array===e||i[o]===e)}},{"./$.iterators":59,"./$.wks":82}],52:[function(e,t,r){var n=e("./$.cof");t.exports=Array.isArray||function(e){return"Array"==n(e)}},{"./$.cof":34}],53:[function(e,t,r){t.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},{}],54:[function(e,t,r){var n=e("./$.an-object");t.exports=function(e,t,r,o){try{return o?t(n(r)[0],r[1]):t(r)}catch(i){var s=e["return"];throw void 0!==s&&n(s.call(e)),i}}},{"./$.an-object":32}],55:[function(e,t,r){"use strict";var n=e("./$"),o=e("./$.property-desc"),i=e("./$.set-to-string-tag"),s={};e("./$.hide")(s,e("./$.wks")("iterator"),function(){return this}),t.exports=function(e,t,r){e.prototype=n.create(s,{next:o(1,r)}),i(e,t+" Iterator")}},{"./$":60,"./$.hide":47,"./$.property-desc":65,"./$.set-to-string-tag":71,"./$.wks":82}],56:[function(e,t,r){"use strict";var n=e("./$.library"),o=e("./$.export"),i=e("./$.redefine"),s=e("./$.hide"),a=e("./$.has"),u=e("./$.iterators"),c=e("./$.iter-create"),l=e("./$.set-to-string-tag"),f=e("./$").getProto,d=e("./$.wks")("iterator"),p=!([].keys&&"next"in[].keys()),h="@@iterator",m="keys",y="values",v=function(){return this};t.exports=function(e,t,r,b,g,_,w){c(r,t,b);var k,O,j=function(e){if(!p&&e in R)return R[e];switch(e){case m:return function(){return new r(this,e)};case y:return function(){return new r(this,e)}}return function(){return new r(this,e)}},E=t+" Iterator",x=g==y,P=!1,R=e.prototype,S=R[d]||R[h]||g&&R[g],T=S||j(g);if(S){var M=f(T.call(new e));l(M,E,!0),!n&&a(R,h)&&s(M,d,v),x&&S.name!==y&&(P=!0,T=function(){return S.call(this)})}if(n&&!w||!p&&!P&&R[d]||s(R,d,T),u[t]=T,u[E]=v,g)if(k={values:x?T:j(y),keys:_?T:j(m),entries:x?j("entries"):T},w)for(O in k)O in R||i(R,O,k[O]);else o(o.P+o.F*(p||P),t,k);return k}},{"./$":60,"./$.export":41,"./$.has":46,"./$.hide":47,"./$.iter-create":55,"./$.iterators":59,"./$.library":62,"./$.redefine":67,"./$.set-to-string-tag":71,"./$.wks":82}],57:[function(e,t,r){var n=e("./$.wks")("iterator"),o=!1;try{var i=[7][n]();i["return"]=function(){o=!0},Array.from(i,function(){throw 2})}catch(s){}t.exports=function(e,t){if(!t&&!o)return!1;var r=!1;try{var i=[7],s=i[n]();s.next=function(){r=!0},i[n]=function(){return s},e(i)}catch(a){}return r}},{"./$.wks":82}],58:[function(e,t,r){t.exports=function(e,t){return{value:t,done:!!e}}},{}],59:[function(e,t,r){t.exports={}},{}],60:[function(e,t,r){var n=Object;t.exports={create:n.create,getProto:n.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:n.getOwnPropertyDescriptor,setDesc:n.defineProperty,setDescs:n.defineProperties,getKeys:n.keys,getNames:n.getOwnPropertyNames,getSymbols:n.getOwnPropertySymbols,each:[].forEach}},{}],61:[function(e,t,r){var n=e("./$"),o=e("./$.to-iobject");t.exports=function(e,t){for(var r,i=o(e),s=n.getKeys(i),a=s.length,u=0;a>u;)if(i[r=s[u++]]===t)return r}},{"./$":60,"./$.to-iobject":78}],62:[function(e,t,r){t.exports=!0},{}],63:[function(e,t,r){var n,o,i,s=e("./$.global"),a=e("./$.task").set,u=s.MutationObserver||s.WebKitMutationObserver,c=s.process,l=s.Promise,f="process"==e("./$.cof")(c),d=function(){var e,t,r;for(f&&(e=c.domain)&&(c.domain=null,e.exit());n;)t=n.domain,r=n.fn,t&&t.enter(),r(),t&&t.exit(),n=n.next;o=void 0,e&&e.enter()};if(f)i=function(){c.nextTick(d)};else if(u){var p=1,h=document.createTextNode("");new u(d).observe(h,{characterData:!0}),i=function(){h.data=p=-p}}else i=l&&l.resolve?function(){l.resolve().then(d)}:function(){a.call(s,d)};t.exports=function(e){var t={fn:e,next:void 0,domain:f&&c.domain};o&&(o.next=t),n||(n=t,i()),o=t}},{"./$.cof":34,"./$.global":45,"./$.task":76}],64:[function(e,t,r){var n=e("./$.export"),o=e("./$.core"),i=e("./$.fails");t.exports=function(e,t){var r=(o.Object||{})[e]||Object[e],s={};s[e]=t(r),n(n.S+n.F*i(function(){r(1)}),"Object",s)}},{"./$.core":35,"./$.export":41,"./$.fails":42}],65:[function(e,t,r){t.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},{}],66:[function(e,t,r){var n=e("./$.redefine");t.exports=function(e,t){for(var r in t)n(e,r,t[r]);return e}},{"./$.redefine":67}],67:[function(e,t,r){t.exports=e("./$.hide")},{"./$.hide":47}],68:[function(e,t,r){t.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},{}],69:[function(e,t,r){var n=e("./$").getDesc,o=e("./$.is-object"),i=e("./$.an-object"),s=function(e,t){if(i(e),!o(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,r,o){try{o=e("./$.ctx")(Function.call,n(Object.prototype,"__proto__").set,2),o(t,[]),r=!(t instanceof Array)}catch(i){r=!0}return function(e,t){return s(e,t),r?e.__proto__=t:o(e,t),e}}({},!1):void 0),check:s}},{"./$":60,"./$.an-object":32,"./$.ctx":36,"./$.is-object":53}],70:[function(e,t,r){"use strict";var n=e("./$.core"),o=e("./$"),i=e("./$.descriptors"),s=e("./$.wks")("species");t.exports=function(e){var t=n[e];i&&t&&!t[s]&&o.setDesc(t,s,{configurable:!0,get:function(){return this}})}},{"./$":60,"./$.core":35,"./$.descriptors":38,"./$.wks":82}],71:[function(e,t,r){var n=e("./$").setDesc,o=e("./$.has"),i=e("./$.wks")("toStringTag");t.exports=function(e,t,r){e&&!o(e=r?e:e.prototype,i)&&n(e,i,{configurable:!0,value:t})}},{"./$":60,"./$.has":46,"./$.wks":82}],72:[function(e,t,r){var n=e("./$.global"),o="__core-js_shared__",i=n[o]||(n[o]={});t.exports=function(e){return i[e]||(i[e]={})}},{"./$.global":45}],73:[function(e,t,r){var n=e("./$.an-object"),o=e("./$.a-function"),i=e("./$.wks")("species");t.exports=function(e,t){var r,s=n(e).constructor;return void 0===s||void 0==(r=n(s)[i])?t:o(r)}},{"./$.a-function":30,"./$.an-object":32,"./$.wks":82}],74:[function(e,t,r){t.exports=function(e,t,r){if(!(e instanceof t))throw TypeError(r+": use the 'new' operator!");return e}},{}],75:[function(e,t,r){var n=e("./$.to-integer"),o=e("./$.defined");t.exports=function(e){return function(t,r){var i,s,a=String(o(t)),u=n(r),c=a.length;return 0>u||u>=c?e?"":void 0:(i=a.charCodeAt(u),55296>i||i>56319||u+1===c||(s=a.charCodeAt(u+1))<56320||s>57343?e?a.charAt(u):i:e?a.slice(u,u+2):(i-55296<<10)+(s-56320)+65536)}}},{"./$.defined":37,"./$.to-integer":77}],76:[function(e,t,r){var n,o,i,s=e("./$.ctx"),a=e("./$.invoke"),u=e("./$.html"),c=e("./$.dom-create"),l=e("./$.global"),f=l.process,d=l.setImmediate,p=l.clearImmediate,h=l.MessageChannel,m=0,y={},v="onreadystatechange",b=function(){var e=+this;if(y.hasOwnProperty(e)){var t=y[e];delete y[e],t()}},g=function(e){b.call(e.data)};d&&p||(d=function(e){for(var t=[],r=1;arguments.length>r;)t.push(arguments[r++]);return y[++m]=function(){a("function"==typeof e?e:Function(e),t)},n(m),m},p=function(e){delete y[e]},"process"==e("./$.cof")(f)?n=function(e){f.nextTick(s(b,e,1))}:h?(o=new h,i=o.port2,o.port1.onmessage=g,n=s(i.postMessage,i,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(n=function(e){l.postMessage(e+"","*")},l.addEventListener("message",g,!1)):n=v in c("script")?function(e){u.appendChild(c("script"))[v]=function(){u.removeChild(this),b.call(e)}}:function(e){setTimeout(s(b,e,1),0)}),t.exports={set:d,clear:p}},{"./$.cof":34,"./$.ctx":36,"./$.dom-create":39,"./$.global":45,"./$.html":48,"./$.invoke":49}],77:[function(e,t,r){var n=Math.ceil,o=Math.floor;t.exports=function(e){return isNaN(e=+e)?0:(e>0?o:n)(e)}},{}],78:[function(e,t,r){var n=e("./$.iobject"),o=e("./$.defined");t.exports=function(e){return n(o(e))}},{"./$.defined":37,"./$.iobject":50}],79:[function(e,t,r){var n=e("./$.to-integer"),o=Math.min;t.exports=function(e){return e>0?o(n(e),9007199254740991):0}},{"./$.to-integer":77}],80:[function(e,t,r){var n=e("./$.defined");t.exports=function(e){return Object(n(e))}},{"./$.defined":37}],81:[function(e,t,r){var n=0,o=Math.random();t.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+o).toString(36))}},{}],82:[function(e,t,r){var n=e("./$.shared")("wks"),o=e("./$.uid"),i=e("./$.global").Symbol;t.exports=function(e){return n[e]||(n[e]=i&&i[e]||(i||o)("Symbol."+e))}},{"./$.global":45,"./$.shared":72,"./$.uid":81}],83:[function(e,t,r){var n=e("./$.classof"),o=e("./$.wks")("iterator"),i=e("./$.iterators");t.exports=e("./$.core").getIteratorMethod=function(e){return void 0!=e?e[o]||e["@@iterator"]||i[n(e)]:void 0}},{"./$.classof":33,"./$.core":35,"./$.iterators":59,"./$.wks":82}],84:[function(e,t,r){"use strict";var n=e("./$.add-to-unscopables"),o=e("./$.iter-step"),i=e("./$.iterators"),s=e("./$.to-iobject");t.exports=e("./$.iter-define")(Array,"Array",function(e,t){this._t=s(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,r=this._i++;return!e||r>=e.length?(this._t=void 0,o(1)):"keys"==t?o(0,r):"values"==t?o(0,e[r]):o(0,[r,e[r]])},"values"),i.Arguments=i.Array,n("keys"),n("values"),n("entries")},{"./$.add-to-unscopables":31,"./$.iter-define":56,"./$.iter-step":58,"./$.iterators":59,"./$.to-iobject":78}],85:[function(e,t,r){var n=e("./$.is-object");e("./$.object-sap")("freeze",function(e){return function(t){return e&&n(t)?e(t):t}})},{"./$.is-object":53,"./$.object-sap":64}],86:[function(e,t,r){var n=e("./$.to-iobject");e("./$.object-sap")("getOwnPropertyDescriptor",function(e){return function(t,r){return e(n(t),r)}})},{"./$.object-sap":64,"./$.to-iobject":78}],87:[function(e,t,r){var n=e("./$.to-object");e("./$.object-sap")("getPrototypeOf",function(e){return function(t){return e(n(t))}})},{"./$.object-sap":64,"./$.to-object":80}],88:[function(e,t,r){var n=e("./$.to-object");e("./$.object-sap")("keys",function(e){return function(t){return e(n(t))}})},{"./$.object-sap":64,"./$.to-object":80}],89:[function(e,t,r){var n=e("./$.export");n(n.S,"Object",{setPrototypeOf:e("./$.set-proto").set})},{"./$.export":41,"./$.set-proto":69}],90:[function(e,t,r){},{}],91:[function(e,t,r){"use strict";var n,o=e("./$"),i=e("./$.library"),s=e("./$.global"),a=e("./$.ctx"),u=e("./$.classof"),c=e("./$.export"),l=e("./$.is-object"),f=e("./$.an-object"),d=e("./$.a-function"),p=e("./$.strict-new"),h=e("./$.for-of"),m=e("./$.set-proto").set,y=e("./$.same-value"),v=e("./$.wks")("species"),b=e("./$.species-constructor"),g=e("./$.microtask"),_="Promise",w=s.process,k="process"==u(w),O=s[_],j=function(e){var t=new O(function(){});return e&&(t.constructor=Object),O.resolve(t)===t},E=function(){function t(e){var r=new O(e);return m(r,t.prototype),r}var r=!1;try{if(r=O&&O.resolve&&j(),m(t,O),t.prototype=o.create(O.prototype,{constructor:{value:t}}),t.resolve(5).then(function(){})instanceof t||(r=!1),r&&e("./$.descriptors")){var n=!1;O.resolve(o.setDesc({},"then",{get:function(){n=!0}})),r=n}}catch(i){r=!1}return r}(),x=function(e,t){return i&&e===O&&t===n?!0:y(e,t)},P=function(e){var t=f(e)[v];return void 0!=t?t:e},R=function(e){var t;return l(e)&&"function"==typeof(t=e.then)?t:!1},S=function(e){var t,r;this.promise=new e(function(e,n){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=n}),this.resolve=d(t),this.reject=d(r)},T=function(e){try{e()}catch(t){return{error:t}}},M=function(e,t){if(!e.n){e.n=!0;var r=e.c;g(function(){for(var n=e.v,o=1==e.s,i=0,a=function(t){var r,i,s=o?t.ok:t.fail,a=t.resolve,u=t.reject;try{s?(o||(e.h=!0),r=s===!0?n:s(n),r===t.promise?u(TypeError("Promise-chain cycle")):(i=R(r))?i.call(r,a,u):a(r)):u(n)}catch(c){u(c)}};r.length>i;)a(r[i++]);r.length=0,e.n=!1,t&&setTimeout(function(){var t,r,o=e.p;L(o)&&(k?w.emit("unhandledRejection",n,o):(t=s.onunhandledrejection)?t({promise:o,reason:n}):(r=s.console)&&r.error&&r.error("Unhandled promise rejection",n)),e.a=void 0},1)})}},L=function(e){var t,r=e._d,n=r.a||r.c,o=0;if(r.h)return!1;for(;n.length>o;)if(t=n[o++],t.fail||!L(t.promise))return!1;return!0},$=function(e){var t=this;t.d||(t.d=!0,t=t.r||t,t.v=e,t.s=2,t.a=t.c.slice(),M(t,!0))},C=function(e){var t,r=this;if(!r.d){r.d=!0,r=r.r||r;try{if(r.p===e)throw TypeError("Promise can't be resolved itself");(t=R(e))?g(function(){var n={r:r,d:!1};try{t.call(e,a(C,n,1),a($,n,1))}catch(o){$.call(n,o)}}):(r.v=e,r.s=1,M(r,!1))}catch(n){$.call({r:r,d:!1},n)}}};E||(O=function(e){d(e);var t=this._d={p:p(this,O,_),c:[],a:void 0,s:0,d:!1,v:void 0,h:!1,n:!1};try{e(a(C,t,1),a($,t,1))}catch(r){$.call(t,r)}},e("./$.redefine-all")(O.prototype,{then:function(e,t){var r=new S(b(this,O)),n=r.promise,o=this._d;return r.ok="function"==typeof e?e:!0,r.fail="function"==typeof t&&t,o.c.push(r),o.a&&o.a.push(r),o.s&&M(o,!1),n},"catch":function(e){return this.then(void 0,e)}})),c(c.G+c.W+c.F*!E,{Promise:O}),e("./$.set-to-string-tag")(O,_),e("./$.set-species")(_),n=e("./$.core")[_],c(c.S+c.F*!E,_,{reject:function(e){var t=new S(this),r=t.reject;return r(e),t.promise}}),c(c.S+c.F*(!E||j(!0)),_,{resolve:function(e){if(e instanceof O&&x(e.constructor,this))return e;var t=new S(this),r=t.resolve;return r(e),t.promise}}),c(c.S+c.F*!(E&&e("./$.iter-detect")(function(e){O.all(e)["catch"](function(){})})),_,{all:function(e){var t=P(this),r=new S(t),n=r.resolve,i=r.reject,s=[],a=T(function(){h(e,!1,s.push,s);var r=s.length,a=Array(r);r?o.each.call(s,function(e,o){var s=!1;t.resolve(e).then(function(e){s||(s=!0,a[o]=e,--r||n(a))},i)}):n(a)});return a&&i(a.error),r.promise},race:function(e){var t=P(this),r=new S(t),n=r.reject,o=T(function(){h(e,!1,function(e){t.resolve(e).then(r.resolve,n)})});return o&&n(o.error),r.promise}})},{"./$":60,"./$.a-function":30,"./$.an-object":32,"./$.classof":33,"./$.core":35,"./$.ctx":36,"./$.descriptors":38,"./$.export":41,"./$.for-of":43,"./$.global":45,"./$.is-object":53,"./$.iter-detect":57,"./$.library":62,"./$.microtask":63,"./$.redefine-all":66,"./$.same-value":68,"./$.set-proto":69,"./$.set-species":70,"./$.set-to-string-tag":71,"./$.species-constructor":73,"./$.strict-new":74,"./$.wks":82}],92:[function(e,t,r){"use strict";var n=e("./$.string-at")(!0);e("./$.iter-define")(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,r=this._i;return r>=t.length?{value:void 0,done:!0}:(e=n(t,r),this._i+=e.length,{value:e,done:!1})})},{"./$.iter-define":56,"./$.string-at":75}],93:[function(e,t,r){"use strict";var n=e("./$"),o=e("./$.global"),i=e("./$.has"),s=e("./$.descriptors"),a=e("./$.export"),u=e("./$.redefine"),c=e("./$.fails"),l=e("./$.shared"),f=e("./$.set-to-string-tag"),d=e("./$.uid"),p=e("./$.wks"),h=e("./$.keyof"),m=e("./$.get-names"),y=e("./$.enum-keys"),v=e("./$.is-array"),b=e("./$.an-object"),g=e("./$.to-iobject"),_=e("./$.property-desc"),w=n.getDesc,k=n.setDesc,O=n.create,j=m.get,E=o.Symbol,x=o.JSON,P=x&&x.stringify,R=!1,S=p("_hidden"),T=n.isEnum,M=l("symbol-registry"),L=l("symbols"),$="function"==typeof E,C=Object.prototype,A=s&&c(function(){return 7!=O(k({},"a",{get:function(){return k(this,"a",{value:7}).a}})).a})?function(e,t,r){var n=w(C,t);n&&delete C[t],k(e,t,r),n&&e!==C&&k(C,t,n)}:k,I=function(e){var t=L[e]=O(E.prototype);return t._k=e,s&&R&&A(C,e,{configurable:!0,set:function(t){i(this,S)&&i(this[S],e)&&(this[S][e]=!1),A(this,e,_(1,t))}}),t},N=function(e){return"symbol"==typeof e},U=function(e,t,r){return r&&i(L,t)?(r.enumerable?(i(e,S)&&e[S][t]&&(e[S][t]=!1),r=O(r,{enumerable:_(0,!1)})):(i(e,S)||k(e,S,_(1,{})),e[S][t]=!0),A(e,t,r)):k(e,t,r)},D=function(e,t){b(e);for(var r,n=y(t=g(t)),o=0,i=n.length;i>o;)U(e,r=n[o++],t[r]);return e},q=function(e,t){return void 0===t?O(e):D(O(e),t)},F=function(e){var t=T.call(this,e);return t||!i(this,e)||!i(L,e)||i(this,S)&&this[S][e]?t:!0},B=function(e,t){var r=w(e=g(e),t);return!r||!i(L,t)||i(e,S)&&e[S][t]||(r.enumerable=!0),r},H=function(e){for(var t,r=j(g(e)),n=[],o=0;r.length>o;)i(L,t=r[o++])||t==S||n.push(t);return n},J=function(e){for(var t,r=j(g(e)),n=[],o=0;r.length>o;)i(L,t=r[o++])&&n.push(L[t]);return n},G=function(e){if(void 0!==e&&!N(e)){for(var t,r,n=[e],o=1,i=arguments;i.length>o;)n.push(i[o++]);return t=n[1],"function"==typeof t&&(r=t),(r||!v(t))&&(t=function(e,t){return r&&(t=r.call(this,e,t)),N(t)?void 0:t}),n[1]=t,P.apply(x,n)}},Y=c(function(){var e=E();return"[null]"!=P([e])||"{}"!=P({a:e})||"{}"!=P(Object(e))});$||(E=function(){if(N(this))throw TypeError("Symbol is not a constructor");return I(d(arguments.length>0?arguments[0]:void 0))},u(E.prototype,"toString",function(){return this._k}),N=function(e){return e instanceof E},n.create=q,n.isEnum=F,n.getDesc=B,n.setDesc=U,n.setDescs=D,n.getNames=m.get=H,n.getSymbols=J,s&&!e("./$.library")&&u(C,"propertyIsEnumerable",F,!0));var V={"for":function(e){return i(M,e+="")?M[e]:M[e]=E(e)},keyFor:function(e){return h(M,e)},useSetter:function(){R=!0},useSimple:function(){R=!1}};n.each.call("hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),function(e){var t=p(e);V[e]=$?t:I(t)}),R=!0,a(a.G+a.W,{Symbol:E}),a(a.S,"Symbol",V),a(a.S+a.F*!$,"Object",{create:q,defineProperty:U,defineProperties:D,getOwnPropertyDescriptor:B,getOwnPropertyNames:H,getOwnPropertySymbols:J}),x&&a(a.S+a.F*(!$||Y),"JSON",{stringify:G}),f(E,"Symbol"),f(Math,"Math",!0),f(o.JSON,"JSON",!0)},{"./$":60,"./$.an-object":32,"./$.descriptors":38,"./$.enum-keys":40,"./$.export":41,"./$.fails":42,"./$.get-names":44,"./$.global":45,"./$.has":46,"./$.is-array":52,"./$.keyof":61,"./$.library":62,"./$.property-desc":65,"./$.redefine":67,"./$.set-to-string-tag":71,"./$.shared":72,"./$.to-iobject":78,"./$.uid":81,"./$.wks":82}],94:[function(e,t,r){e("./es6.array.iterator");var n=e("./$.iterators");n.NodeList=n.HTMLCollection=n.Array},{"./$.iterators":59,"./es6.array.iterator":84}],95:[function(e,t,r){(function(r){var n="object"==typeof r?r:"object"==typeof window?window:"object"==typeof self?self:this,o=n.regeneratorRuntime&&Object.getOwnPropertyNames(n).indexOf("regeneratorRuntime")>=0,i=o&&n.regeneratorRuntime;if(n.regeneratorRuntime=void 0,t.exports=e("./runtime"),o)n.regeneratorRuntime=i;else try{delete n.regeneratorRuntime}catch(s){n.regeneratorRuntime=void 0}t.exports={"default":t.exports,__esModule:!0}}).call(this,"undefined"!=typeof o?o:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./runtime":96}],96:[function(e,t,r){(function(r,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var i=e("../core-js/promise"),s=o(i),a=e("../core-js/object/set-prototype-of"),u=o(a),c=e("../core-js/object/create"),l=o(c),f=e("../helpers/typeof"),d=o(f),p=e("../core-js/symbol/iterator"),h=o(p),m=e("../core-js/symbol"),y=o(m);!function(e){function n(e,t,r,n){var o=(0,l["default"])((t||i).prototype),s=new _(n||[]);return o._invoke=v(e,r,s),o}function o(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(n){return{type:"throw",arg:n}}}function i(){}function a(){}function c(){}function f(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function p(e){this.arg=e}function m(e){function t(t,r){var n=e[t](r),o=n.value;return o instanceof p?s["default"].resolve(o.arg).then(i,a):s["default"].resolve(o).then(function(e){return n.value=e,n})}function n(e,r){function n(){return t(e,r)}return o=o?o.then(n,n):new s["default"](function(e){e(n())})}"object"===("undefined"==typeof r?"undefined":(0,d["default"])(r))&&r.domain&&(t=r.domain.bind(t));var o,i=t.bind(e,"next"),a=t.bind(e,"throw");t.bind(e,"return"),this._invoke=n}function v(e,t,r){var n=R;return function(i,s){if(n===T)throw new Error("Generator is already running");if(n===M){if("throw"===i)throw s;return k()}for(;;){var a=r.delegate;if(a){if("return"===i||"throw"===i&&a.iterator[i]===O){r.delegate=null;var u=a.iterator["return"];if(u){var c=o(u,a.iterator,s);if("throw"===c.type){i="throw",s=c.arg;continue}}if("return"===i)continue}var c=o(a.iterator[i],a.iterator,s);if("throw"===c.type){r.delegate=null,i="throw",s=c.arg;continue}i="next",s=O;var l=c.arg;if(!l.done)return n=S,l;r[a.resultName]=l.value,r.next=a.nextLoc,r.delegate=null}if("next"===i)r._sent=s,n===S?r.sent=s:r.sent=O;else if("throw"===i){if(n===R)throw n=M,s;r.dispatchException(s)&&(i="next",s=O)}else"return"===i&&r.abrupt("return",s);n=T;var c=o(e,t,r);if("normal"===c.type){n=r.done?M:S;var l={value:c.arg,done:r.done};if(c.arg!==L)return l;r.delegate&&"next"===i&&(s=O)}else"throw"===c.type&&(n=M,i="throw",s=c.arg)}}}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function g(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function _(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function w(e){if(e){var t=e[E];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,n=function o(){for(;++r<e.length;)if(j.call(e,r))return o.value=e[r],o.done=!1,o;return o.value=O,o.done=!0,o};return n.next=n}}return{next:k}}function k(){return{value:O,done:!0}}var O,j=Object.prototype.hasOwnProperty,E="function"==typeof y["default"]&&h["default"]||"@@iterator",x="object"===("undefined"==typeof t?"undefined":(0,d["default"])(t)),P=e.regeneratorRuntime;if(P)return void(x&&(t.exports=P));P=e.regeneratorRuntime=x?t.exports:{},P.wrap=n;var R="suspendedStart",S="suspendedYield",T="executing",M="completed",L={},$=c.prototype=i.prototype;a.prototype=$.constructor=c,c.constructor=a,a.displayName="GeneratorFunction",P.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return t?t===a||"GeneratorFunction"===(t.displayName||t.name):!1},P.mark=function(e){return u["default"]?(0,u["default"])(e,c):e.__proto__=c,e.prototype=(0,l["default"])($),e},P.awrap=function(e){return new p(e)},f(m.prototype),P.async=function(e,t,r,o){var i=new m(n(e,t,r,o));return P.isGeneratorFunction(t)?i:i.next().then(function(e){return e.done?e.value:i.next()})},f($),$[E]=function(){return this},$.toString=function(){return"[object Generator]"},P.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},P.values=w,_.prototype={constructor:_,reset:function(e){if(this.prev=0,this.next=0,this.sent=O,this.done=!1,this.delegate=null,this.tryEntries.forEach(g),!e)for(var t in this)"t"===t.charAt(0)&&j.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=O)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){function t(t,n){return i.type="throw",i.arg=e,r.next=t,!!n}if(this.done)throw e;for(var r=this,n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n],i=o.completion;if("root"===o.tryLoc)return t("end");if(o.tryLoc<=this.prev){var s=j.call(o,"catchLoc"),a=j.call(o,"finallyLoc");if(s&&a){if(this.prev<o.catchLoc)return t(o.catchLoc,!0);if(this.prev<o.finallyLoc)return t(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return t(o.catchLoc,!0)}else{
if(!a)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return t(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&j.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?this.next=o.finallyLoc:this.complete(i),L},complete:function(e,t){if("throw"===e.type)throw e.arg;"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=e.arg,this.next="end"):"normal"===e.type&&t&&(this.next=t)},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),g(r),L}},"catch":function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;g(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:w(e),resultName:t,nextLoc:r},L}}}("object"===("undefined"==typeof n?"undefined":(0,d["default"])(n))?n:"object"===("undefined"==typeof window?"undefined":(0,d["default"])(window))?window:"object"===("undefined"==typeof self?"undefined":(0,d["default"])(self))?self:void 0)}).call(this,e("_process"),"undefined"!=typeof o?o:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../core-js/object/create":1,"../core-js/object/set-prototype-of":7,"../core-js/promise":8,"../core-js/symbol":9,"../core-js/symbol/iterator":10,"../helpers/typeof":19,_process:97}],97:[function(e,t,r){function n(){l=!1,a.length?c=a.concat(c):f=-1,c.length&&o()}function o(){if(!l){var e=setTimeout(n);l=!0;for(var t=c.length;t;){for(a=c,c=[];++f<t;)a&&a[f].run();f=-1,t=c.length}a=null,l=!1,clearTimeout(e)}}function i(e,t){this.fun=e,this.array=t}function s(){}var a,u=t.exports={},c=[],l=!1,f=-1;u.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new i(e,t)),1!==c.length||l||setTimeout(o,0)},i.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=s,u.addListener=s,u.once=s,u.off=s,u.removeListener=s,u.removeAllListeners=s,u.emit=s,u.binding=function(e){throw new Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(e){throw new Error("process.chdir is not supported")},u.umask=function(){return 0}},{}],98:[function(t,r,n){!function(t,n){"function"==typeof e&&e.amd?e([],n):"undefined"!=typeof r&&r.exports?r.exports=n():t.tv4=n()}(this,function(){function e(e){return encodeURI(e).replace(/%25[0-9][0-9]/g,function(e){return"%"+e.substring(3)})}function t(t){var r="";d[t.charAt(0)]&&(r=t.charAt(0),t=t.substring(1));var n="",o="",i=!0,s=!1,a=!1;"+"===r?i=!1:"."===r?(o=".",n="."):"/"===r?(o="/",n="/"):"#"===r?(o="#",i=!1):";"===r?(o=";",n=";",s=!0,a=!0):"?"===r?(o="?",n="&",s=!0):"&"===r&&(o="&",n="&",s=!0);for(var u=[],c=t.split(","),l=[],f={},h=0;h<c.length;h++){var m=c[h],y=null;if(-1!==m.indexOf(":")){var v=m.split(":");m=v[0],y=parseInt(v[1],10)}for(var b={};p[m.charAt(m.length-1)];)b[m.charAt(m.length-1)]=!0,m=m.substring(0,m.length-1);var g={truncate:y,name:m,suffices:b};l.push(g),f[m]=g,u.push(m)}var _=function(t){for(var r="",u=0,c=0;c<l.length;c++){var f=l[c],d=t(f.name);if(null===d||void 0===d||Array.isArray(d)&&0===d.length||"object"==typeof d&&0===Object.keys(d).length)u++;else if(r+=c===u?o:n||",",Array.isArray(d)){s&&(r+=f.name+"=");for(var p=0;p<d.length;p++)p>0&&(r+=f.suffices["*"]?n||",":",",f.suffices["*"]&&s&&(r+=f.name+"=")),r+=i?encodeURIComponent(d[p]).replace(/!/g,"%21"):e(d[p])}else if("object"==typeof d){s&&!f.suffices["*"]&&(r+=f.name+"=");var h=!0;for(var m in d)h||(r+=f.suffices["*"]?n||",":","),h=!1,r+=i?encodeURIComponent(m).replace(/!/g,"%21"):e(m),r+=f.suffices["*"]?"=":",",r+=i?encodeURIComponent(d[m]).replace(/!/g,"%21"):e(d[m])}else s&&(r+=f.name,a&&""===d||(r+="=")),null!=f.truncate&&(d=d.substring(0,f.truncate)),r+=i?encodeURIComponent(d).replace(/!/g,"%21"):e(d)}return r};return _.varNames=u,{prefix:o,substitution:_}}function r(e){if(!(this instanceof r))return new r(e);for(var n=e.split("{"),o=[n.shift()],i=[],s=[],a=[];n.length>0;){var u=n.shift(),c=u.split("}")[0],l=u.substring(c.length+1),f=t(c);s.push(f.substitution),i.push(f.prefix),o.push(l),a=a.concat(f.substitution.varNames)}this.fill=function(e){for(var t=o[0],r=0;r<s.length;r++){var n=s[r];t+=n(e),t+=o[r+1]}return t},this.varNames=a,this.template=e}function n(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){if(Array.isArray(e)!==Array.isArray(t))return!1;if(Array.isArray(e)){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!n(e[r],t[r]))return!1}else{var o;for(o in e)if(void 0===t[o]&&void 0!==e[o])return!1;for(o in t)if(void 0===e[o]&&void 0!==t[o])return!1;for(o in e)if(!n(e[o],t[o]))return!1}return!0}return!1}function o(e){var t=String(e).replace(/^\s+|\s+$/g,"").match(/^([^:\/?#]+:)?(\/\/(?:[^:@]*(?::[^:@]*)?@)?(([^:\/?#]*)(?::(\d*))?))?([^?#]*)(\?[^#]*)?(#[\s\S]*)?/);return t?{href:t[0]||"",protocol:t[1]||"",authority:t[2]||"",host:t[3]||"",hostname:t[4]||"",port:t[5]||"",pathname:t[6]||"",search:t[7]||"",hash:t[8]||""}:null}function i(e,t){function r(e){var t=[];return e.replace(/^(\.\.?(\/|$))+/,"").replace(/\/(\.(\/|$))+/g,"/").replace(/\/\.\.$/,"/../").replace(/\/?[^\/]*/g,function(e){"/.."===e?t.pop():t.push(e)}),t.join("").replace(/^\//,"/"===e.charAt(0)?"/":"")}return t=o(t||""),e=o(e||""),t&&e?(t.protocol||e.protocol)+(t.protocol||t.authority?t.authority:e.authority)+r(t.protocol||t.authority||"/"===t.pathname.charAt(0)?t.pathname:t.pathname?(e.authority&&!e.pathname?"/":"")+e.pathname.slice(0,e.pathname.lastIndexOf("/")+1)+t.pathname:e.pathname)+(t.protocol||t.authority||t.pathname?t.search:t.search||e.search)+t.hash:null}function s(e){return e.split("#")[0]}function a(e,t){if(e&&"object"==typeof e)if(void 0===t?t=e.id:"string"==typeof e.id&&(t=i(t,e.id),e.id=t),Array.isArray(e))for(var r=0;r<e.length;r++)a(e[r],t);else{"string"==typeof e.$ref&&(e.$ref=i(t,e.$ref));for(var n in e)"enum"!==n&&a(e[n],t)}}function u(e){e=e||"en";var t=w[e];return function(e){var r=t[e.code]||_[e.code];if("string"!=typeof r)return"Unknown error code "+e.code+": "+JSON.stringify(e.messageParams);var n=e.params;return r.replace(/\{([^{}]*)\}/g,function(e,t){var r=n[t];return"string"==typeof r||"number"==typeof r?r:e})}}function c(e,t,r,n,o){if(Error.call(this),void 0===e)throw new Error("No error code supplied: "+n);this.message="",this.params=t,this.code=e,this.dataPath=r||"",this.schemaPath=n||"",this.subErrors=o||null;var i=new Error(this.message);if(this.stack=i.stack||i.stacktrace,!this.stack)try{throw i}catch(i){this.stack=i.stack||i.stacktrace}}function l(e,t){if(t.substring(0,e.length)===e){var r=t.substring(e.length);if(t.length>0&&"/"===t.charAt(e.length-1)||"#"===r.charAt(0)||"?"===r.charAt(0))return!0}return!1}function f(e){var t,r,n=new h,o={setErrorReporter:function(e){return"string"==typeof e?this.language(e):(r=e,!0)},addFormat:function(){n.addFormat.apply(n,arguments)},language:function(e){return e?(w[e]||(e=e.split("-")[0]),w[e]?(t=e,e):!1):t},addLanguage:function(e,t){var r;for(r in v)t[r]&&!t[v[r]]&&(t[v[r]]=t[r]);var n=e.split("-")[0];if(w[n]){w[e]=Object.create(w[n]);for(r in t)"undefined"==typeof w[n][r]&&(w[n][r]=t[r]),w[e][r]=t[r]}else w[e]=t,w[n]=t;return this},freshApi:function(e){var t=f();return e&&t.language(e),t},validate:function(e,o,i,s){var a=u(t),c=r?function(e,t,n){return r(e,t,n)||a(e,t,n)}:a,l=new h(n,!1,c,i,s);"string"==typeof o&&(o={$ref:o}),l.addSchema("",o);var f=l.validateAll(e,o,null,null,"");return!f&&s&&(f=l.banUnknownProperties(e,o)),this.error=f,this.missing=l.missing,this.valid=null===f,this.valid},validateResult:function(){var e={};return this.validate.apply(e,arguments),e},validateMultiple:function(e,o,i,s){var a=u(t),c=r?function(e,t,n){return r(e,t,n)||a(e,t,n)}:a,l=new h(n,!0,c,i,s);"string"==typeof o&&(o={$ref:o}),l.addSchema("",o),l.validateAll(e,o,null,null,""),s&&l.banUnknownProperties(e,o);var f={};return f.errors=l.errors,f.missing=l.missing,f.valid=0===f.errors.length,f},addSchema:function(){return n.addSchema.apply(n,arguments)},getSchema:function(){return n.getSchema.apply(n,arguments)},getSchemaMap:function(){return n.getSchemaMap.apply(n,arguments)},getSchemaUris:function(){return n.getSchemaUris.apply(n,arguments)},getMissingUris:function(){return n.getMissingUris.apply(n,arguments)},dropSchemas:function(){n.dropSchemas.apply(n,arguments)},defineKeyword:function(){n.defineKeyword.apply(n,arguments)},defineError:function(e,t,r){if("string"!=typeof e||!/^[A-Z]+(_[A-Z]+)*$/.test(e))throw new Error("Code name must be a string in UPPER_CASE_WITH_UNDERSCORES");if("number"!=typeof t||t%1!==0||1e4>t)throw new Error("Code number must be an integer > 10000");if("undefined"!=typeof v[e])throw new Error("Error already defined: "+e+" as "+v[e]);if("undefined"!=typeof b[t])throw new Error("Error code already used: "+b[t]+" as "+t);v[e]=t,b[t]=e,_[e]=_[t]=r;for(var n in w){var o=w[n];o[e]&&(o[t]=o[t]||o[e])}},reset:function(){n.reset(),this.error=null,this.missing=[],this.valid=!0},missing:[],error:null,valid:!0,normSchema:a,resolveUrl:i,getDocumentUri:s,errorCodes:v};return o.language(e||"en"),o}Object.keys||(Object.keys=function(){var e=Object.prototype.hasOwnProperty,t=!{toString:null}.propertyIsEnumerable("toString"),r=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],n=r.length;return function(o){if("object"!=typeof o&&"function"!=typeof o||null===o)throw new TypeError("Object.keys called on non-object");var i=[];for(var s in o)e.call(o,s)&&i.push(s);if(t)for(var a=0;n>a;a++)e.call(o,r[a])&&i.push(r[a]);return i}}()),Object.create||(Object.create=function(){function e(){}return function(t){if(1!==arguments.length)throw new Error("Object.create implementation only accepts one parameter.");return e.prototype=t,new e}}()),Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e){if(null===this)throw new TypeError;var t=Object(this),r=t.length>>>0;if(0===r)return-1;var n=0;if(arguments.length>1&&(n=Number(arguments[1]),n!==n?n=0:0!==n&&n!==1/0&&n!==-(1/0)&&(n=(n>0||-1)*Math.floor(Math.abs(n)))),n>=r)return-1;for(var o=n>=0?n:Math.max(r-Math.abs(n),0);r>o;o++)if(o in t&&t[o]===e)return o;return-1}),Object.isFrozen||(Object.isFrozen=function(e){for(var t="tv4_test_frozen_key";e.hasOwnProperty(t);)t+=Math.random();try{return e[t]=!0,delete e[t],!1}catch(r){return!0}});var d={"+":!0,"#":!0,".":!0,"/":!0,";":!0,"?":!0,"&":!0},p={"*":!0};r.prototype={toString:function(){return this.template},fillFromObject:function(e){return this.fill(function(t){return e[t]})}};var h=function(e,t,r,n,o){if(this.missing=[],this.missingMap={},this.formatValidators=e?Object.create(e.formatValidators):{},this.schemas=e?Object.create(e.schemas):{},this.collectMultiple=t,this.errors=[],this.handleError=t?this.collectError:this.returnError,n&&(this.checkRecursive=!0,this.scanned=[],this.scannedFrozen=[],this.scannedFrozenSchemas=[],this.scannedFrozenValidationErrors=[],this.validatedSchemasKey="tv4_validation_id",this.validationErrorsKey="tv4_validation_errors_id"),o&&(this.trackUnknownProperties=!0,this.knownPropertyPaths={},this.unknownPropertyPaths={}),this.errorReporter=r||u("en"),"string"==typeof this.errorReporter)throw new Error("debug");if(this.definedKeywords={},e)for(var i in e.definedKeywords)this.definedKeywords[i]=e.definedKeywords[i].slice(0)};h.prototype.defineKeyword=function(e,t){this.definedKeywords[e]=this.definedKeywords[e]||[],this.definedKeywords[e].push(t)},h.prototype.createError=function(e,t,r,n,o,i,s){var a=new c(e,t,r,n,o);return a.message=this.errorReporter(a,i,s),a},h.prototype.returnError=function(e){return e},h.prototype.collectError=function(e){return e&&this.errors.push(e),null},h.prototype.prefixErrors=function(e,t,r){for(var n=e;n<this.errors.length;n++)this.errors[n]=this.errors[n].prefixWith(t,r);return this},h.prototype.banUnknownProperties=function(e,t){for(var r in this.unknownPropertyPaths){var n=this.createError(v.UNKNOWN_PROPERTY,{path:r},r,"",null,e,t),o=this.handleError(n);if(o)return o}return null},h.prototype.addFormat=function(e,t){if("object"==typeof e){for(var r in e)this.addFormat(r,e[r]);return this}this.formatValidators[e]=t},h.prototype.resolveRefs=function(e,t){if(void 0!==e.$ref){if(t=t||{},t[e.$ref])return this.createError(v.CIRCULAR_REFERENCE,{urls:Object.keys(t).join(", ")},"","",null,void 0,e);t[e.$ref]=!0,e=this.getSchema(e.$ref,t)}return e},h.prototype.getSchema=function(e,t){var r;if(void 0!==this.schemas[e])return r=this.schemas[e],this.resolveRefs(r,t);var n=e,o="";if(-1!==e.indexOf("#")&&(o=e.substring(e.indexOf("#")+1),n=e.substring(0,e.indexOf("#"))),"object"==typeof this.schemas[n]){r=this.schemas[n];var i=decodeURIComponent(o);if(""===i)return this.resolveRefs(r,t);if("/"!==i.charAt(0))return;for(var s=i.split("/").slice(1),a=0;a<s.length;a++){var u=s[a].replace(/~1/g,"/").replace(/~0/g,"~");if(void 0===r[u]){r=void 0;break}r=r[u]}if(void 0!==r)return this.resolveRefs(r,t)}void 0===this.missing[n]&&(this.missing.push(n),this.missing[n]=n,this.missingMap[n]=n)},h.prototype.searchSchemas=function(e,t){if(Array.isArray(e))for(var r=0;r<e.length;r++)this.searchSchemas(e[r],t);else if(e&&"object"==typeof e){"string"==typeof e.id&&l(t,e.id)&&void 0===this.schemas[e.id]&&(this.schemas[e.id]=e);for(var n in e)if("enum"!==n)if("object"==typeof e[n])this.searchSchemas(e[n],t);else if("$ref"===n){var o=s(e[n]);o&&void 0===this.schemas[o]&&void 0===this.missingMap[o]&&(this.missingMap[o]=o)}}},h.prototype.addSchema=function(e,t){if("string"!=typeof e||"undefined"==typeof t){if("object"!=typeof e||"string"!=typeof e.id)return;t=e,e=t.id}e===s(e)+"#"&&(e=s(e)),this.schemas[e]=t,delete this.missingMap[e],a(t,e),this.searchSchemas(t,e)},h.prototype.getSchemaMap=function(){var e={};for(var t in this.schemas)e[t]=this.schemas[t];return e},h.prototype.getSchemaUris=function(e){var t=[];for(var r in this.schemas)(!e||e.test(r))&&t.push(r);return t},h.prototype.getMissingUris=function(e){var t=[];for(var r in this.missingMap)(!e||e.test(r))&&t.push(r);return t},h.prototype.dropSchemas=function(){this.schemas={},this.reset()},h.prototype.reset=function(){this.missing=[],this.missingMap={},this.errors=[]},h.prototype.validateAll=function(e,t,r,n,o){var i;if(t=this.resolveRefs(t),!t)return null;if(t instanceof c)return this.errors.push(t),t;var s,a=this.errors.length,u=null,l=null;if(this.checkRecursive&&e&&"object"==typeof e){if(i=!this.scanned.length,e[this.validatedSchemasKey]){var f=e[this.validatedSchemasKey].indexOf(t);if(-1!==f)return this.errors=this.errors.concat(e[this.validationErrorsKey][f]),null}if(Object.isFrozen(e)&&(s=this.scannedFrozen.indexOf(e),-1!==s)){var d=this.scannedFrozenSchemas[s].indexOf(t);if(-1!==d)return this.errors=this.errors.concat(this.scannedFrozenValidationErrors[s][d]),null}if(this.scanned.push(e),Object.isFrozen(e))-1===s&&(s=this.scannedFrozen.length,this.scannedFrozen.push(e),this.scannedFrozenSchemas.push([])),u=this.scannedFrozenSchemas[s].length,this.scannedFrozenSchemas[s][u]=t,this.scannedFrozenValidationErrors[s][u]=[];else{if(!e[this.validatedSchemasKey])try{Object.defineProperty(e,this.validatedSchemasKey,{value:[],configurable:!0}),Object.defineProperty(e,this.validationErrorsKey,{value:[],configurable:!0})}catch(p){e[this.validatedSchemasKey]=[],e[this.validationErrorsKey]=[]}l=e[this.validatedSchemasKey].length,e[this.validatedSchemasKey][l]=t,e[this.validationErrorsKey][l]=[]}}var h=this.errors.length,m=this.validateBasic(e,t,o)||this.validateNumeric(e,t,o)||this.validateString(e,t,o)||this.validateArray(e,t,o)||this.validateObject(e,t,o)||this.validateCombinations(e,t,o)||this.validateHypermedia(e,t,o)||this.validateFormat(e,t,o)||this.validateDefinedKeywords(e,t,o)||null;if(i){for(;this.scanned.length;){var y=this.scanned.pop();delete y[this.validatedSchemasKey]}this.scannedFrozen=[],this.scannedFrozenSchemas=[]}if(m||h!==this.errors.length)for(;r&&r.length||n&&n.length;){var v=r&&r.length?""+r.pop():null,b=n&&n.length?""+n.pop():null;m&&(m=m.prefixWith(v,b)),this.prefixErrors(h,v,b)}return null!==u?this.scannedFrozenValidationErrors[s][u]=this.errors.slice(a):null!==l&&(e[this.validationErrorsKey][l]=this.errors.slice(a)),this.handleError(m)},h.prototype.validateFormat=function(e,t){if("string"!=typeof t.format||!this.formatValidators[t.format])return null;var r=this.formatValidators[t.format].call(null,e,t);return"string"==typeof r||"number"==typeof r?this.createError(v.FORMAT_CUSTOM,{message:r},"","/format",null,e,t):r&&"object"==typeof r?this.createError(v.FORMAT_CUSTOM,{message:r.message||"?"},r.dataPath||"",r.schemaPath||"/format",null,e,t):null},h.prototype.validateDefinedKeywords=function(e,t,r){for(var n in this.definedKeywords)if("undefined"!=typeof t[n])for(var o=this.definedKeywords[n],i=0;i<o.length;i++){var s=o[i],a=s(e,t[n],t,r);if("string"==typeof a||"number"==typeof a)return this.createError(v.KEYWORD_CUSTOM,{key:n,message:a},"","",null,e,t).prefixWith(null,n);if(a&&"object"==typeof a){var u=a.code;if("string"==typeof u){if(!v[u])throw new Error("Undefined error code (use defineError): "+u);u=v[u]}else"number"!=typeof u&&(u=v.KEYWORD_CUSTOM);var c="object"==typeof a.message?a.message:{key:n,message:a.message||"?"},l=a.schemaPath||"/"+n.replace(/~/g,"~0").replace(/\//g,"~1");return this.createError(u,c,a.dataPath||null,l,null,e,t)}}return null},h.prototype.validateBasic=function(e,t,r){var n;return(n=this.validateType(e,t,r))?n.prefixWith(null,"type"):(n=this.validateEnum(e,t,r))?n.prefixWith(null,"type"):null},h.prototype.validateType=function(e,t){if(void 0===t.type)return null;var r=typeof e;null===e?r="null":Array.isArray(e)&&(r="array");var n=t.type;Array.isArray(n)||(n=[n]);for(var o=0;o<n.length;o++){var i=n[o];if(i===r||"integer"===i&&"number"===r&&e%1===0)return null}return this.createError(v.INVALID_TYPE,{type:r,expected:n.join("/")},"","",null,e,t)},h.prototype.validateEnum=function(e,t){if(void 0===t["enum"])return null;for(var r=0;r<t["enum"].length;r++){var o=t["enum"][r];if(n(e,o))return null}return this.createError(v.ENUM_MISMATCH,{value:"undefined"!=typeof JSON?JSON.stringify(e):e},"","",null,e,t)},h.prototype.validateNumeric=function(e,t,r){return this.validateMultipleOf(e,t,r)||this.validateMinMax(e,t,r)||this.validateNaN(e,t,r)||null};var m=Math.pow(2,-51),y=1-m;h.prototype.validateMultipleOf=function(e,t){var r=t.multipleOf||t.divisibleBy;if(void 0===r)return null;if("number"==typeof e){var n=e/r%1;if(n>=m&&y>n)return this.createError(v.NUMBER_MULTIPLE_OF,{value:e,multipleOf:r},"","",null,e,t)}return null},h.prototype.validateMinMax=function(e,t){if("number"!=typeof e)return null;if(void 0!==t.minimum){if(e<t.minimum)return this.createError(v.NUMBER_MINIMUM,{value:e,minimum:t.minimum},"","/minimum",null,e,t);if(t.exclusiveMinimum&&e===t.minimum)return this.createError(v.NUMBER_MINIMUM_EXCLUSIVE,{value:e,minimum:t.minimum},"","/exclusiveMinimum",null,e,t)}if(void 0!==t.maximum){if(e>t.maximum)return this.createError(v.NUMBER_MAXIMUM,{value:e,maximum:t.maximum},"","/maximum",null,e,t);if(t.exclusiveMaximum&&e===t.maximum)return this.createError(v.NUMBER_MAXIMUM_EXCLUSIVE,{value:e,maximum:t.maximum},"","/exclusiveMaximum",null,e,t)}return null},h.prototype.validateNaN=function(e,t){return"number"!=typeof e?null:isNaN(e)===!0||e===1/0||e===-(1/0)?this.createError(v.NUMBER_NOT_A_NUMBER,{value:e},"","/type",null,e,t):null},h.prototype.validateString=function(e,t,r){return this.validateStringLength(e,t,r)||this.validateStringPattern(e,t,r)||null},h.prototype.validateStringLength=function(e,t){return"string"!=typeof e?null:void 0!==t.minLength&&e.length<t.minLength?this.createError(v.STRING_LENGTH_SHORT,{length:e.length,minimum:t.minLength},"","/minLength",null,e,t):void 0!==t.maxLength&&e.length>t.maxLength?this.createError(v.STRING_LENGTH_LONG,{length:e.length,maximum:t.maxLength},"","/maxLength",null,e,t):null},h.prototype.validateStringPattern=function(e,t){if("string"!=typeof e||"string"!=typeof t.pattern&&!(t.pattern instanceof RegExp))return null;var r;if(t.pattern instanceof RegExp)r=t.pattern;else{var n,o="",i=t.pattern.match(/^\/(.+)\/([img]*)$/);i?(n=i[1],o=i[2]):n=t.pattern,r=new RegExp(n,o)}return r.test(e)?null:this.createError(v.STRING_PATTERN,{pattern:t.pattern},"","/pattern",null,e,t)},h.prototype.validateArray=function(e,t,r){return Array.isArray(e)?this.validateArrayLength(e,t,r)||this.validateArrayUniqueItems(e,t,r)||this.validateArrayItems(e,t,r)||null:null},h.prototype.validateArrayLength=function(e,t){var r;return void 0!==t.minItems&&e.length<t.minItems&&(r=this.createError(v.ARRAY_LENGTH_SHORT,{length:e.length,minimum:t.minItems},"","/minItems",null,e,t),this.handleError(r))?r:void 0!==t.maxItems&&e.length>t.maxItems&&(r=this.createError(v.ARRAY_LENGTH_LONG,{length:e.length,maximum:t.maxItems},"","/maxItems",null,e,t),this.handleError(r))?r:null},h.prototype.validateArrayUniqueItems=function(e,t){if(t.uniqueItems)for(var r=0;r<e.length;r++)for(var o=r+1;o<e.length;o++)if(n(e[r],e[o])){var i=this.createError(v.ARRAY_UNIQUE,{match1:r,match2:o},"","/uniqueItems",null,e,t);if(this.handleError(i))return i}return null},h.prototype.validateArrayItems=function(e,t,r){if(void 0===t.items)return null;var n,o;if(Array.isArray(t.items)){for(o=0;o<e.length;o++)if(o<t.items.length){if(n=this.validateAll(e[o],t.items[o],[o],["items",o],r+"/"+o))return n}else if(void 0!==t.additionalItems)if("boolean"==typeof t.additionalItems){if(!t.additionalItems&&(n=this.createError(v.ARRAY_ADDITIONAL_ITEMS,{},"/"+o,"/additionalItems",null,e,t),this.handleError(n)))return n}else if(n=this.validateAll(e[o],t.additionalItems,[o],["additionalItems"],r+"/"+o))return n}else for(o=0;o<e.length;o++)if(n=this.validateAll(e[o],t.items,[o],["items"],r+"/"+o))return n;return null},h.prototype.validateObject=function(e,t,r){return"object"!=typeof e||null===e||Array.isArray(e)?null:this.validateObjectMinMaxProperties(e,t,r)||this.validateObjectRequiredProperties(e,t,r)||this.validateObjectProperties(e,t,r)||this.validateObjectDependencies(e,t,r)||null},h.prototype.validateObjectMinMaxProperties=function(e,t){var r,n=Object.keys(e);return void 0!==t.minProperties&&n.length<t.minProperties&&(r=this.createError(v.OBJECT_PROPERTIES_MINIMUM,{propertyCount:n.length,minimum:t.minProperties},"","/minProperties",null,e,t),this.handleError(r))?r:void 0!==t.maxProperties&&n.length>t.maxProperties&&(r=this.createError(v.OBJECT_PROPERTIES_MAXIMUM,{propertyCount:n.length,maximum:t.maxProperties},"","/maxProperties",null,e,t),this.handleError(r))?r:null},h.prototype.validateObjectRequiredProperties=function(e,t){if(void 0!==t.required)for(var r=0;r<t.required.length;r++){var n=t.required[r];if(void 0===e[n]){var o=this.createError(v.OBJECT_REQUIRED,{key:n},"","/required/"+r,null,e,t);if(this.handleError(o))return o}}return null},h.prototype.validateObjectProperties=function(e,t,r){var n;for(var o in e){var i=r+"/"+o.replace(/~/g,"~0").replace(/\//g,"~1"),s=!1;if(void 0!==t.properties&&void 0!==t.properties[o]&&(s=!0,n=this.validateAll(e[o],t.properties[o],[o],["properties",o],i)))return n;if(void 0!==t.patternProperties)for(var a in t.patternProperties){var u=new RegExp(a);if(u.test(o)&&(s=!0,n=this.validateAll(e[o],t.patternProperties[a],[o],["patternProperties",a],i)))return n}if(s)this.trackUnknownProperties&&(this.knownPropertyPaths[i]=!0,delete this.unknownPropertyPaths[i]);else if(void 0!==t.additionalProperties){if(this.trackUnknownProperties&&(this.knownPropertyPaths[i]=!0,delete this.unknownPropertyPaths[i]),"boolean"==typeof t.additionalProperties){if(!t.additionalProperties&&(n=this.createError(v.OBJECT_ADDITIONAL_PROPERTIES,{key:o},"","/additionalProperties",null,e,t).prefixWith(o,null),this.handleError(n)))return n}else if(n=this.validateAll(e[o],t.additionalProperties,[o],["additionalProperties"],i))return n}else this.trackUnknownProperties&&!this.knownPropertyPaths[i]&&(this.unknownPropertyPaths[i]=!0)}return null},h.prototype.validateObjectDependencies=function(e,t,r){var n;if(void 0!==t.dependencies)for(var o in t.dependencies)if(void 0!==e[o]){var i=t.dependencies[o];if("string"==typeof i){if(void 0===e[i]&&(n=this.createError(v.OBJECT_DEPENDENCY_KEY,{key:o,missing:i},"","",null,e,t).prefixWith(null,o).prefixWith(null,"dependencies"),this.handleError(n)))return n}else if(Array.isArray(i))for(var s=0;s<i.length;s++){var a=i[s];if(void 0===e[a]&&(n=this.createError(v.OBJECT_DEPENDENCY_KEY,{key:o,missing:a},"","/"+s,null,e,t).prefixWith(null,o).prefixWith(null,"dependencies"),this.handleError(n)))return n}else if(n=this.validateAll(e,i,[],["dependencies",o],r))return n}return null},h.prototype.validateCombinations=function(e,t,r){return this.validateAllOf(e,t,r)||this.validateAnyOf(e,t,r)||this.validateOneOf(e,t,r)||this.validateNot(e,t,r)||null},h.prototype.validateAllOf=function(e,t,r){if(void 0===t.allOf)return null;for(var n,o=0;o<t.allOf.length;o++){var i=t.allOf[o];if(n=this.validateAll(e,i,[],["allOf",o],r))return n}return null},h.prototype.validateAnyOf=function(e,t,r){if(void 0===t.anyOf)return null;var n,o,i=[],s=this.errors.length;this.trackUnknownProperties&&(n=this.unknownPropertyPaths,o=this.knownPropertyPaths);for(var a=!0,u=0;u<t.anyOf.length;u++){this.trackUnknownProperties&&(this.unknownPropertyPaths={},this.knownPropertyPaths={});var c=t.anyOf[u],l=this.errors.length,f=this.validateAll(e,c,[],["anyOf",u],r);if(null===f&&l===this.errors.length){if(this.errors=this.errors.slice(0,s),this.trackUnknownProperties){for(var d in this.knownPropertyPaths)o[d]=!0,delete n[d];for(var p in this.unknownPropertyPaths)o[p]||(n[p]=!0);a=!1;continue}return null}f&&i.push(f.prefixWith(null,""+u).prefixWith(null,"anyOf"))}return this.trackUnknownProperties&&(this.unknownPropertyPaths=n,this.knownPropertyPaths=o),a?(i=i.concat(this.errors.slice(s)),this.errors=this.errors.slice(0,s),this.createError(v.ANY_OF_MISSING,{},"","/anyOf",i,e,t)):void 0},h.prototype.validateOneOf=function(e,t,r){if(void 0===t.oneOf)return null;var n,o,i=null,s=[],a=this.errors.length;this.trackUnknownProperties&&(n=this.unknownPropertyPaths,o=this.knownPropertyPaths);for(var u=0;u<t.oneOf.length;u++){this.trackUnknownProperties&&(this.unknownPropertyPaths={},this.knownPropertyPaths={});var c=t.oneOf[u],l=this.errors.length,f=this.validateAll(e,c,[],["oneOf",u],r);if(null===f&&l===this.errors.length){if(null!==i)return this.errors=this.errors.slice(0,a),this.createError(v.ONE_OF_MULTIPLE,{index1:i,index2:u},"","/oneOf",null,e,t);if(i=u,this.trackUnknownProperties){for(var d in this.knownPropertyPaths)o[d]=!0,delete n[d];for(var p in this.unknownPropertyPaths)o[p]||(n[p]=!0)}}else f&&s.push(f)}return this.trackUnknownProperties&&(this.unknownPropertyPaths=n,this.knownPropertyPaths=o),null===i?(s=s.concat(this.errors.slice(a)),this.errors=this.errors.slice(0,a),this.createError(v.ONE_OF_MISSING,{},"","/oneOf",s,e,t)):(this.errors=this.errors.slice(0,a),null)},h.prototype.validateNot=function(e,t,r){if(void 0===t.not)return null;var n,o,i=this.errors.length;this.trackUnknownProperties&&(n=this.unknownPropertyPaths,o=this.knownPropertyPaths,this.unknownPropertyPaths={},this.knownPropertyPaths={});var s=this.validateAll(e,t.not,null,null,r),a=this.errors.slice(i);return this.errors=this.errors.slice(0,i),this.trackUnknownProperties&&(this.unknownPropertyPaths=n,this.knownPropertyPaths=o),null===s&&0===a.length?this.createError(v.NOT_PASSED,{},"","/not",null,e,t):null},h.prototype.validateHypermedia=function(e,t,n){if(!t.links)return null;for(var o,i=0;i<t.links.length;i++){var s=t.links[i];if("describedby"===s.rel){for(var a=new r(s.href),u=!0,c=0;c<a.varNames.length;c++)if(!(a.varNames[c]in e)){u=!1;break}if(u){var l=a.fillFromObject(e),f={$ref:l};if(o=this.validateAll(e,f,[],["links",i],n))return o}}}};var v={INVALID_TYPE:0,ENUM_MISMATCH:1,ANY_OF_MISSING:10,ONE_OF_MISSING:11,ONE_OF_MULTIPLE:12,NOT_PASSED:13,NUMBER_MULTIPLE_OF:100,NUMBER_MINIMUM:101,NUMBER_MINIMUM_EXCLUSIVE:102,NUMBER_MAXIMUM:103,NUMBER_MAXIMUM_EXCLUSIVE:104,NUMBER_NOT_A_NUMBER:105,STRING_LENGTH_SHORT:200,STRING_LENGTH_LONG:201,STRING_PATTERN:202,OBJECT_PROPERTIES_MINIMUM:300,OBJECT_PROPERTIES_MAXIMUM:301,OBJECT_REQUIRED:302,OBJECT_ADDITIONAL_PROPERTIES:303,OBJECT_DEPENDENCY_KEY:304,ARRAY_LENGTH_SHORT:400,ARRAY_LENGTH_LONG:401,ARRAY_UNIQUE:402,ARRAY_ADDITIONAL_ITEMS:403,FORMAT_CUSTOM:500,KEYWORD_CUSTOM:501,CIRCULAR_REFERENCE:600,UNKNOWN_PROPERTY:1e3},b={};for(var g in v)b[v[g]]=g;var _={INVALID_TYPE:"Invalid type: {type} (expected {expected})",ENUM_MISMATCH:"No enum match for: {value}",ANY_OF_MISSING:'Data does not match any schemas from "anyOf"',ONE_OF_MISSING:'Data does not match any schemas from "oneOf"',ONE_OF_MULTIPLE:'Data is valid against more than one schema from "oneOf": indices {index1} and {index2}',NOT_PASSED:'Data matches schema from "not"',NUMBER_MULTIPLE_OF:"Value {value} is not a multiple of {multipleOf}",NUMBER_MINIMUM:"Value {value} is less than minimum {minimum}",NUMBER_MINIMUM_EXCLUSIVE:"Value {value} is equal to exclusive minimum {minimum}",NUMBER_MAXIMUM:"Value {value} is greater than maximum {maximum}",NUMBER_MAXIMUM_EXCLUSIVE:"Value {value} is equal to exclusive maximum {maximum}",NUMBER_NOT_A_NUMBER:"Value {value} is not a valid number",STRING_LENGTH_SHORT:"String is too short ({length} chars), minimum {minimum}",STRING_LENGTH_LONG:"String is too long ({length} chars), maximum {maximum}",STRING_PATTERN:"String does not match pattern: {pattern}",OBJECT_PROPERTIES_MINIMUM:"Too few properties defined ({propertyCount}), minimum {minimum}",OBJECT_PROPERTIES_MAXIMUM:"Too many properties defined ({propertyCount}), maximum {maximum}",OBJECT_REQUIRED:"Missing required property: {key}",OBJECT_ADDITIONAL_PROPERTIES:"Additional properties not allowed",OBJECT_DEPENDENCY_KEY:"Dependency failed - key must exist: {missing} (due to key: {key})",ARRAY_LENGTH_SHORT:"Array is too short ({length}), minimum {minimum}",ARRAY_LENGTH_LONG:"Array is too long ({length}), maximum {maximum}",ARRAY_UNIQUE:"Array items are not unique (indices {match1} and {match2})",ARRAY_ADDITIONAL_ITEMS:"Additional items not allowed",FORMAT_CUSTOM:"Format validation failed ({message})",KEYWORD_CUSTOM:"Keyword failed: {key} ({message})",CIRCULAR_REFERENCE:"Circular $refs: {urls}",UNKNOWN_PROPERTY:"Unknown property (not in schema)"};c.prototype=Object.create(Error.prototype),c.prototype.constructor=c,c.prototype.name="ValidationError",c.prototype.prefixWith=function(e,t){if(null!==e&&(e=e.replace(/~/g,"~0").replace(/\//g,"~1"),this.dataPath="/"+e+this.dataPath),null!==t&&(t=t.replace(/~/g,"~0").replace(/\//g,"~1"),this.schemaPath="/"+t+this.schemaPath),null!==this.subErrors)for(var r=0;r<this.subErrors.length;r++)this.subErrors[r].prefixWith(e,t);return this};var w={},k=f();return k.addLanguage("en-gb",_),k.tv4=k,k})},{}],99:[function(e,t,r){"use strict";var n=e("babel-runtime/helpers/create-class")["default"],o=e("babel-runtime/helpers/class-call-check")["default"];Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(t,r,n,i,s,a){o(this,e),this._guid=t,this._type=r,this._objectName=n,this._description=i,this._language=s,this._sourcePackageURL=a,this._signature=null,this._sourcePackage=null}return n(e,[{key:"guid",get:function(){return this._guid},set:function(e){e&&(this._guid=e)}},{key:"type",get:function(){return this._type},set:function(e){e&&(this._type=e)}},{key:"objectName",get:function(){return this._objectName},set:function(e){e&&(this._objectName=e);
}},{key:"description",get:function(){return this._description},set:function(e){e&&(this._description=e)}},{key:"language",get:function(){return this._language},set:function(e){e&&(this._language=e)}},{key:"signature",get:function(){return this._signature},set:function(e){e&&(this._signature=e)}},{key:"sourcePackage",get:function(){return this._sourcePackage},set:function(e){e&&(this._sourcePackage=e)}},{key:"sourcePackageURL",get:function(){return this._sourcePackageURL},set:function(e){e&&(this._sourcePackageURL=e)}}]),e}(),s={HYPERTY:"hyperty",PROTOSTUB:"protostub",HYPERTY_RUNTIME:"hyperty_runtime",HYPERTY_INTERCEPTOR:"hyperty_inspector",HYPERTY_DATA_OBJECT:"hyperty_data_object",POLICY_ENFORCER:"policy_enforcer",DATA_SCHEMA:"data_schema"};r.CatalogueObjectType=s;var a={JAVASCRIPT_ECMA6:"javascript_ecma6",JAVASCRIPT_ECMA5:"javascript_ecma5",JSON_SCHEMA_V4:"json_schema_v4",PYTHON:"python",TYPESCRIPT:"typescript"};r.DataObjectSourceLanguage=a,r["default"]=i},{"babel-runtime/helpers/class-call-check":11,"babel-runtime/helpers/create-class":13}],100:[function(e,t,r){"use strict";var n=e("babel-runtime/helpers/get")["default"],o=e("babel-runtime/helpers/inherits")["default"],i=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],a=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(r,"__esModule",{value:!0});var u=e("../reTHINKObject/RethinkObject"),c=a(u),l=e("./CatalogueDataObject"),f=a(l),d=e("./SourcePackage"),p=a(d),h=e("./HypertyDescriptor"),m=a(h),y=e("./ProtocolStubDescriptor"),v=a(y),b=e("./HypertyRuntimeDescriptor"),g=a(b),_=e("./PolicyEnforcerDescriptor"),w=a(_),k=e("./DataObjectSchema"),O=a(k),j=function(e){function t(e,r){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,r)}return o(t,e),i(t,[{key:"createCatalogueDataObject",value:function(e,t,r,n,o,i){if("undefined"==typeof e||"undefined"==typeof t||"undefined"==typeof r||"undefined"==typeof n||"undefined"==typeof o||"undefined"==typeof i)throw new Error("Invalid parameters!");return new f["default"](e,t,r,n,o,i)}},{key:"createHypertyDescriptorObject",value:function(e,t,r,n,o,i,s){if("undefined"==typeof e||"undefined"==typeof t||"undefined"==typeof r||"undefined"==typeof n||"undefined"==typeof o||"undefined"==typeof i||"undefined"==typeof s)throw new Error("Invalid parameters!");return new m["default"](e,l.CatalogueObjectType.HYPERTY,t,r,n,o,i,s)}},{key:"createProtoStubDescriptorObject",value:function(e,t,r,n,o,i,s,a){if("undefined"==typeof e||"undefined"==typeof t||"undefined"==typeof r||"undefined"==typeof n||"undefined"==typeof o||"undefined"==typeof i||"undefined"==typeof s||"undefined"==typeof a)throw new Error("Invalid parameters!");return new v["default"](e,l.CatalogueObjectType.PROTOSTUB,t,r,n,o,i,s,a)}},{key:"createHypertyRuntimeDescriptorObject",value:function(e,t,r,n,o,i,s,a){if("undefined"==typeof e||"undefined"==typeof t||"undefined"==typeof r||"undefined"==typeof n||"undefined"==typeof o||"undefined"==typeof i||"undefined"==typeof s||"undefined"==typeof a)throw new Error("Invalid parameters!");return new g["default"](e,l.CatalogueObjectType.HYPERTY_RUNTIME,t,r,n,o,i,s,a)}},{key:"createPolicyEnforcerDescriptorObject",value:function(e,t,r,n,o,i,s){if("undefined"==typeof e||"undefined"==typeof t||"undefined"==typeof r||"undefined"==typeof n||"undefined"==typeof o||"undefined"==typeof i||"undefined"==typeof s)throw new Error("Invalid parameters!");return new w["default"](e,l.CatalogueObjectType.POLICY_ENFORCER,t,r,n,o,i,s)}},{key:"createDataObjectSchema",value:function(e,t,r,n,o){if("undefined"==typeof e||"undefined"==typeof t||"undefined"==typeof r||"undefined"==typeof n||"undefined"==typeof o)throw new Error("Invalid parameters!");return new O["default"](e,l.CatalogueObjectType.DATA_SCHEMA,t,r,n,o)}},{key:"createSourcePackage",value:function(e,t){if("undefined"==typeof t||"undefined"==typeof e)throw new Error("Invalid parameters!");return new p["default"](e,t)}}]),t}(c["default"]);r["default"]=j,t.exports=r["default"]},{"../reTHINKObject/RethinkObject":110,"./CatalogueDataObject":99,"./DataObjectSchema":101,"./HypertyDescriptor":102,"./HypertyRuntimeDescriptor":103,"./PolicyEnforcerDescriptor":104,"./ProtocolStubDescriptor":105,"./SourcePackage":106,"babel-runtime/helpers/class-call-check":11,"babel-runtime/helpers/create-class":13,"babel-runtime/helpers/get":15,"babel-runtime/helpers/inherits":16,"babel-runtime/helpers/interop-require-default":17}],101:[function(e,t,r){"use strict";var n=e("babel-runtime/helpers/get")["default"],o=e("babel-runtime/helpers/inherits")["default"],i=e("babel-runtime/helpers/class-call-check")["default"],s=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(r,"__esModule",{value:!0});var a=e("./CatalogueDataObject"),u=s(a),c=function(e){function t(e,r,o,s,a,u){i(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,r,o,s,a,u)}return o(t,e),t}(u["default"]),l=function(e){function t(e,r,o,s,a,u){i(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,r,o,s,a,u)}return o(t,e),t}(c);r.MessageDataObjectSchema=l;var f=function(e){function t(e,r,o,s,a,u,c){i(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,r,o,s,a,u),this._accessControlPolicy=c}return o(t,e),t}(c);r.HypertyDataObjectSchema=f;var d=function(e){function t(e,r,o,s,a,u,c){i(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,r,o,s,a,u,c)}return o(t,e),t}(f);r.CommunicationDataObjectSchema=d;var p=function(e){function t(e,r,o,s,a,u,c){i(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,r,o,s,a,u,c)}return o(t,e),t}(f);r.ConnectionDataObjectSchema=p;var h=function(e){function t(e,r,o,s,a,u,c){i(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,r,o,s,a,u,c)}return o(t,e),t}(f);r.IdentifyDataObjectSchema=h;var m=function(e){function t(e,r,o,s,a,u,c){i(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,r,o,s,a,u,c)}return o(t,e),t}(f);r.ContextDataObjectSchema=m,r["default"]=c},{"./CatalogueDataObject":99,"babel-runtime/helpers/class-call-check":11,"babel-runtime/helpers/get":15,"babel-runtime/helpers/inherits":16,"babel-runtime/helpers/interop-require-default":17}],102:[function(e,t,r){"use strict";var n=e("babel-runtime/helpers/get")["default"],o=e("babel-runtime/helpers/inherits")["default"],i=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],a=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(r,"__esModule",{value:!0});var u=e("./CatalogueDataObject"),c=a(u),l=function(e){function t(e,r,o,i,a,u,c,l){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,r,o,i,a,u),this._configuration={},this._constraints={},this._policies={},this._messageSchema=null,this._hypertyType=c,this._dataObjects=l}return o(t,e),i(t,[{key:"hypertyType",get:function(){return this._hypertyType},set:function(e){e&&(this._hypertyType=e)}},{key:"dataObjects",get:function(){return this._dataObjects},set:function(e){e&&(this._dataObjects=e)}},{key:"configuration",get:function(){return this._configuration},set:function(e){e&&(this._configuration=e)}},{key:"constraints",get:function(){return this._constraints},set:function(e){e&&(this._constraints=e)}},{key:"messageSchema",get:function(){return this._messageSchema},set:function(e){e&&(this._messageSchema=e)}},{key:"policies",get:function(){return this._policies},set:function(e){e&&(this._policies=e)}}]),t}(c["default"]),f={};r.RuntimeHypertyCapabilityType=f;var d={COMMUNICATOR:"communicator",IDENTITY:"identity",CONTEXT:"context"};r.HypertyType=d,r["default"]=l},{"./CatalogueDataObject":99,"babel-runtime/helpers/class-call-check":11,"babel-runtime/helpers/create-class":13,"babel-runtime/helpers/get":15,"babel-runtime/helpers/inherits":16,"babel-runtime/helpers/interop-require-default":17}],103:[function(e,t,r){"use strict";var n=e("babel-runtime/helpers/get")["default"],o=e("babel-runtime/helpers/inherits")["default"],i=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],a=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(r,"__esModule",{value:!0});var u=e("./CatalogueDataObject"),c=a(u),l=function(e){function t(e,r,o,i,a,u,c,l,f){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,r,o,i,a,u),this._runtimeType=c,l?this._hypertyCapabilities=l:this._hypertyCapabilities={},f?this._protocolCapabilities=f:this._protocolCapabilities={}}return o(t,e),i(t,[{key:"runtimeType",get:function(){return this._runtimeType},set:function(e){e&&(this._runtimeType=e)}},{key:"hypertyCapabilities",get:function(){return this._hypertyCapabilities},set:function(e){e&&(this._hypertyCapabilities=e)}},{key:"protocolCapabilities",get:function(){return this._hypertyCapabilities},set:function(e){e&&(this._protocolCapabilities=e)}}]),t}(c["default"]),f={BROWSER:"browser",STANDALONE:"standalone",SERVER:"server",GATEWAY:"gateway"};r.RuntimeType=f;var d={MIC:"mic",CAMERA:"camera",SENSOR:"sensor",WEBRTC:"webrtc",ORTC:"ortc"};r.RuntimeHypertyCapabilityType=d;var p={HTTP:"http",HTTPS:"https",WS:"ws",WSS:"wss",COAP:"coap",DATACHANEL:"datachannel"};r.RuntimeProtocolCapabilityType=p,r["default"]=l},{"./CatalogueDataObject":99,"babel-runtime/helpers/class-call-check":11,"babel-runtime/helpers/create-class":13,"babel-runtime/helpers/get":15,"babel-runtime/helpers/inherits":16,"babel-runtime/helpers/interop-require-default":17}],104:[function(e,t,r){"use strict";var n=e("babel-runtime/helpers/get")["default"],o=e("babel-runtime/helpers/inherits")["default"],i=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],a=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(r,"__esModule",{value:!0});var u=e("./CatalogueDataObject"),c=a(u),l=function(e){function t(e,r,o,i,a,u,c,l){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,r,o,i,a,u),this._configuration=c,this._policies=l}return o(t,e),i(t,[{key:"configuration",get:function(){return this._configuration},set:function(e){this._configuration=e}},{key:"policies",get:function(){return this._policies},set:function(e){this._policies=e}}]),t}(c["default"]);r["default"]=l,t.exports=r["default"]},{"./CatalogueDataObject":99,"babel-runtime/helpers/class-call-check":11,"babel-runtime/helpers/create-class":13,"babel-runtime/helpers/get":15,"babel-runtime/helpers/inherits":16,"babel-runtime/helpers/interop-require-default":17}],105:[function(e,t,r){"use strict";var n=e("babel-runtime/helpers/get")["default"],o=e("babel-runtime/helpers/inherits")["default"],i=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],a=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(r,"__esModule",{value:!0});var u=e("./CatalogueDataObject"),c=a(u),l=e("./HypertyRuntimeDescriptor"),f=(a(l),function(e){function t(e,r,o,i,a,u,c,l,f){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,r,o,i,a,u),this._messageSchemas=c,l?this._configuration=l:this._configuration={},f?this._constraints=f:this._constraints={}}return o(t,e),i(t,[{key:"messageSchemas",get:function(){return this._messageSchemas},set:function(e){e&&(this._messageSchemas=e)}},{key:"constraints",get:function(){return this._constraints},set:function(e){e&&(this._constraints=e)}},{key:"configuration",get:function(){return this._configuration},set:function(e){e&&(this._configuration=e)}}]),t}(c["default"]));r["default"]=f,t.exports=r["default"]},{"./CatalogueDataObject":99,"./HypertyRuntimeDescriptor":103,"babel-runtime/helpers/class-call-check":11,"babel-runtime/helpers/create-class":13,"babel-runtime/helpers/get":15,"babel-runtime/helpers/inherits":16,"babel-runtime/helpers/interop-require-default":17}],106:[function(e,t,r){"use strict";var n=e("babel-runtime/helpers/create-class")["default"],o=e("babel-runtime/helpers/class-call-check")["default"];Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(t,r){o(this,e),this._sourceCode=r,this._sourceCodeClassname=t,this._encoding=null,this._signature=null}return n(e,[{key:"sourceCode",get:function(){return this._sourceCode},set:function(e){e&&(this._sourceCode=e)}},{key:"sourceCodeClassname",get:function(){return this._sourceCodeClassname},set:function(e){e&&(this._sourceCodeClassname=e)}},{key:"encoding",get:function(){return this._encoding},set:function(e){e&&(this._encoding=e)}},{key:"signature",get:function(){return this._signature},set:function(e){e&&(this._signature=e)}}]),e}();r["default"]=i,t.exports=r["default"]},{"babel-runtime/helpers/class-call-check":11,"babel-runtime/helpers/create-class":13}],107:[function(e,t,r){"use strict";var n=e("babel-runtime/helpers/create-class")["default"],o=e("babel-runtime/helpers/class-call-check")["default"];Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(t,r,n,i,s){o(this,e),this.id=t,this.from=r,this.to=n,this.type=i,this.body=s}return n(e,[{key:"assertIdentity",value:function(e,t){if(!e||!t)throw new Error("message, token to be removed, and assertedIdentity must be provided");var r=this.body;return r.idToken=null,r.assertedIdentity=t,this.body=r,this}},{key:"addIdToken",value:function(e){if(!e)throw new Error("message, token to be added, must be provided");var t=this.body;return t.idToken=e,this.body=t,this}},{key:"addAccessToken",value:function(e){if(!e)throw new Error("message, token to be added, must be provided");var t=this.body;return t.accessToken=e,this.body=t,this}}]),e}();r.Message=i;var s={CREATE:"create",READ:"read",UPDATE:"update",DELETE:"delete",SUBSCRIBE:"subscribe",UNSUBSCRIBE:"unsubscribe",RESPONSE:"response",FORWARD:"forward"};r.MessageType=s,r["default"]=i},{"babel-runtime/helpers/class-call-check":11,"babel-runtime/helpers/create-class":13}],108:[function(e,t,r){"use strict";function n(e){var t=a(e).reduce(function(t,r){return t[e[r]]=r,t},{});return u(a(e).reduce(function(t,r){return t[r]=e[r],t},function(e){return t[e]}))}var o=e("babel-runtime/helpers/class-call-check")["default"],i=e("babel-runtime/helpers/get")["default"],s=e("babel-runtime/helpers/inherits")["default"],a=e("babel-runtime/core-js/object/keys")["default"],u=e("babel-runtime/core-js/object/freeze")["default"];Object.defineProperty(r,"__esModule",{value:!0}),r.Enum=n;var c=function b(e,t,r,n,i){o(this,b),this.idToken=e,this.accessToken=t,this.resource=r,this.schema=n,this.assertedIdentity=i};r.MessageBody=c;var l=function(e){function t(e,r,n,s,a,u,c){if(o(this,t),!e)throw new Error("The value parameter is null");i(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,n,s,a,u,c,u,c),this.value=e,r&&(this.policy=r)}return s(t,e),t}(c);r.CreateMessageBody=l;var f=function(e){function t(e,r,n,s,a,u,c,l){o(this,t),i(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,r,n,s,a),u&&(this.attribute=u),c&&(this.criteriaSyntax=c),l&&(this.criteria=l)}return s(t,e),t}(c);r.ReadMessageBody=f;var d=function(e){function t(e,r,n,s,a,u){o(this,t),i(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,r,n,s,a),u&&(this.attribute=u)}return s(t,e),t}(c);r.DeleteMessageBody=d;var p=function(e){function t(e,r,n,s,a,u,c){o(this,t),i(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,r,n,s,a),this.attribute=u,this.value=c}return s(t,e),t}(c);r.UpdateMessageBody=p;var h=function(e){function t(e,r,n,s,a,u){o(this,t),i(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,r,n,s,a),this.message=u}return s(t,e),t}(c);r.ForwardMessageBody=h;var m=function(e){function t(e,r,n,s,a){o(this,t),i(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,r,n),s&&(this.code=s,this.description=v[s]),a&&(this.value=a)}return s(t,e),t}(c);r.ResponseMessageBody=m;var y=n({100:"100",101:"101",200:"200",201:"201",202:"202",203:"203",204:"204",205:"205",206:"206",300:"300",301:"301",302:"302",303:"303",304:"304",305:"305",307:"307",400:"400",401:"401",402:"402",403:"403",404:"404",405:"405",406:"406",407:"407",408:"408",409:"409",410:"410",411:"411",412:"412",413:"413",414:"414",415:"415",416:"416",417:"417",426:"426",500:"500",501:"501",502:"502",503:"503",504:"504",505:"505"});r.RESPONSE_CODE=y;var v=n({100:"Continue",101:"Switching Protocols",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",426:"Upgrade Required",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Time-out",505:"HTTP Version Not Supported"});r.REASON_PHRASE=v,r["default"]=c},{"babel-runtime/core-js/object/freeze":3,"babel-runtime/core-js/object/keys":6,"babel-runtime/helpers/class-call-check":11,"babel-runtime/helpers/get":15,"babel-runtime/helpers/inherits":16}],109:[function(e,t,r){"use strict";var n=e("babel-runtime/helpers/get")["default"],o=e("babel-runtime/helpers/inherits")["default"],i=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],a=e("babel-runtime/regenerator")["default"],u=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(r,"__esModule",{value:!0});var c=e("../reTHINKObject/RethinkObject.js"),l=u(c),f=e("./Message.js"),d=u(f),p=e("./MessageBody.js"),h=function(e){function t(e,r){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,r),this.myGenerator=(new m).idMaker()}return o(t,e),i(t,[{key:"validate",value:function(e){return n(Object.getPrototypeOf(t.prototype),"validate",this).call(this,e)}},{key:"createCreateMessageRequest",value:function(e,t,r,n){if(!e||!t||!r)throw new Error("from, to, and value of object to be created MUST be specified");var o=this.myGenerator.next().value,i=new p.CreateMessageBody(r,n,null,null,null,null,null),s=new d["default"](o,e,t,f.MessageType.CREATE,i);return s}},{key:"createForwardMessageRequest",value:function(e,t,r){if(!e||!t||!r)throw new Error("from, to, and message to forward MUST be specified");var n=this.myGenerator.next().value,o=new p.ForwardMessageBody(null,null,null,null,null,r),i=new d["default"](n,e,t,f.MessageType.FORWARD,o);return i}},{key:"createDeleteMessageRequest",value:function(e,t,r,n){if(!e||!t)throw new Error("from and to parameters MUST be specified");var o=this.myGenerator.next().value,i=new p.DeleteMessageBody(null,null,r,n,null,null),s=new d["default"](o,e,t,f.MessageType.DELETE,i);return s}},{key:"createUpdateMessageRequest",value:function(e,t,r,n,o){if(!e||!t||!r)throw new Error("from, and to and value MUST be specified");var i=this.myGenerator.next().value,s=new p.UpdateMessageBody(null,null,n,null,null,o,r),a=new d["default"](i,e,t,f.MessageType.UPDATE,s);return a}},{key:"createReadMessageRequest",value:function(e,t,r,n){if(!e||!t||!r)throw new Error("from, to and the resource to read from MUST be specified");var o=this.myGenerator.next().value,i=new p.ReadMessageBody(null,null,r,null,null,n,null,null),s=new d["default"](o,e,t,f.MessageType.READ,i);return s}},{key:"createSubscribeMessageRequest",value:function(e,t,r){if(!e||!t||!r)throw new Error("from, to and the resource to subscribe to MUST be specified");var n=this.myGenerator.next().value,o=new p.MessageBody(null,null,r,null,null),i=new d["default"](n,e,t,f.MessageType.SUBSCRIBE,o);return i}},{key:"createUnsubscribeMessageRequest",value:function(e,t,r){if(!e||!t||!r)throw new Error("from, to and the resource to subscribe to MUST be specified");var n=this.myGenerator.next().value,o=new p.MessageBody(null,null,r,null,null),i=new d["default"](n,e,t,f.MessageType.UNSUBSCRIBE,o);return i}},{key:"createMessageResponse",value:function(e,t,r,n){if(!t)throw new Error("response Code MUST be specified");var o=new p.ResponseMessageBody(null,null,null,t,r,n);return new d["default"](e.id,e.to,e.from,f.MessageType.RESPONSE,o)}},{key:"generateMessageResponse",value:function(e,t,r){if(!e||!t)throw new Error("message and response code MUST be specified");var n=e.body,o=n.idToken,i=n.accessToken,s=n.resource,a=new p.ResponseMessageBody(o,i,s,t,r),u=this.myGenerator.next().value;return new d["default"](u,e.to,e.from,f.MessageType.RESPONSE,a)}}]),t}(l["default"]),m=function(){function e(){s(this,e)}return i(e,[{key:"idMaker",value:a.mark(function t(){var e;return a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=1;case 1:if(!(1e5>e)){t.next=6;break}return t.next=4,e++;case 4:t.next=1;break;case 6:case"end":return t.stop()}},t,this)})}]),e}();r.IdGenerator=m,r["default"]=h},{"../reTHINKObject/RethinkObject.js":110,"./Message.js":107,"./MessageBody.js":108,"babel-runtime/helpers/class-call-check":11,"babel-runtime/helpers/create-class":13,"babel-runtime/helpers/get":15,"babel-runtime/helpers/inherits":16,"babel-runtime/helpers/interop-require-default":17,"babel-runtime/regenerator":95}],110:[function(e,t,r){"use strict";var n=e("babel-runtime/helpers/create-class")["default"],o=e("babel-runtime/helpers/class-call-check")["default"],i=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(r,"__esModule",{value:!0});var s=e("tv4"),a=i(s),u=function(){function e(t,r){o(this,e),this.validation=t,this.schema=r}return n(e,[{key:"validate",value:function(e){return this.schema?a["default"].validate(e,this.schema):!1}}]),e}();r.RethinkObject=u,r["default"]=u},{"babel-runtime/helpers/class-call-check":11,"babel-runtime/helpers/create-class":13,"babel-runtime/helpers/interop-require-default":17,tv4:98}],111:[function(e,t,r){"use strict";var n=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(r,"__esModule",{value:!0});var o=e("./catalogue-factory/CatalogueDataObjectFactory"),i=n(o),s=e("./message-factory/MessageFactory"),a=n(s),u=e("./syncher/Syncher"),c=n(u),l=e("./syncher/DataObjectReporter"),f=n(l),d=e("./syncher/DataObjectObserver"),p=n(d),h=e("./catalogue-factory/HypertyDescriptor"),m=n(h),y=e("./catalogue-factory/ProtocolStubDescriptor"),v=n(y),b=e("./catalogue-factory/SourcePackage"),g=n(b);r.CatalogueFactory=i["default"],r.MessageFactory=a["default"],r.Syncher=c["default"],r.DataObjectReporter=f["default"],r.DataObjectObserver=p["default"],r.HypertyDescriptor=m["default"],r.ProtocolStubDescriptor=v["default"],r.SourcePackage=g["default"]},{"./catalogue-factory/CatalogueDataObjectFactory":100,"./catalogue-factory/HypertyDescriptor":102,"./catalogue-factory/ProtocolStubDescriptor":105,"./catalogue-factory/SourcePackage":106,"./message-factory/MessageFactory":109,"./syncher/DataObjectObserver":114,"./syncher/DataObjectReporter":115,"./syncher/Syncher":118,"babel-runtime/helpers/interop-require-default":17}],112:[function(e,t,r){"use strict";var n=e("babel-runtime/helpers/create-class")["default"],o=e("babel-runtime/helpers/class-call-check")["default"],i=e("babel-runtime/core-js/object/keys")["default"],s=e("babel-runtime/core-js/promise")["default"],a=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(r,"__esModule",{value:!0});var u=e("./SyncObject"),c=a(u),l=e("./DataObjectChild"),f=a(l),d=e("../utils/utils.js"),p=function(){function e(t,r,n,i,s,a){o(this,e);var u=this;u._syncher=t,u._url=r,u._schema=n,u._status=i,u._syncObj=new c["default"](s),u._childrens=a,u._version=0,u._childId=0,u._childrenObjects={},u._childrenListeners=[],u._owner=t._owner,u._bus=t._bus}return n(e,[{key:"_allocateListeners",value:function(){var e=this,t=this,r=t._url+"/children/";t._childrens&&t._childrens.forEach(function(n){var o=r+n,i=t._bus.addListener(o,function(r){if(console.log("DataObject-Children-RCV: ",r),r.from!==e._owner)switch(r.type){case"create":t._onChildrenCreate(r);break;case"delete":console.log(r);break;default:t._changeChildren(r)}});t._childrenListeners.push(i)})}},{key:"_releaseListeners",value:function(){var e=this;e._childrenListeners.forEach(function(e){e.remove()}),i(e._childrenObjects).forEach(function(t){e._childrenObjects[t]._releaseListeners()})}},{key:"pause",value:function(){throw"Not implemented"}},{key:"resume",value:function(){throw"Not implemented"}},{key:"stop",value:function(){throw"Not implemented"}},{key:"addChildren",value:function(e,t){var r=this;r._childId++;var n=r._owner+"#"+r._childId,o=r._url+"/children/"+e,i={type:"create",from:r._owner,to:o,body:{resource:n,value:t}};return new s(function(e){var s=r._bus.postMessage(i);console.log("create-reporter-child( "+r._owner+" ): ",i);var a=new f["default"](r,r._owner,n,s,t);a.onChange(function(e){r._onChange(e,{path:o,childId:n})}),r._childrenObjects[n]=a,e(a)})}},{key:"onAddChildren",value:function(e){this._onAddChildrenHandler=e}},{key:"_onChildrenCreate",value:function(e){var t=this,r=e.body.resource;console.log("create-observer-child( "+t._owner+" ): ",e);var n=new f["default"](t,e.from,r,0,e.body.value);t._childrenObjects[r]=n,setTimeout(function(){t._bus.postMessage({id:e.id,type:"response",from:e.to,to:e.from,body:{code:200,source:t._owner}})});var o={type:e.type,from:e.from,url:e.to,value:e.body.value,childId:r};t._onAddChildrenHandler&&(console.log("ADD-CHILDREN-EVENT: ",o),t._onAddChildrenHandler(o))}},{key:"_onChange",value:function(e,t){var r=this;if(r._version++,"on"===r._status){var n={type:"update",from:r._url,to:r._url+"/changes",body:{version:r._version,attribute:e.field}};e.oType===u.ObjectType.OBJECT?e.cType!==u.ChangeType.REMOVE&&(n.body.value=e.data):(n.body.attributeType=e.oType,n.body.value=e.data,e.cType!==u.ChangeType.UPDATE&&(n.body.operation=e.cType)),t&&(n.to=t.path,n.body.resource=t.childId),r._bus.postMessage(n)}}},{key:"_changeObject",value:function(e,t){var r=this;if(r._version+1===t.body.version){r._version++;var n=t.body.attribute,o=(0,d.deepClone)(t.body.value),i=e.findBefore(n);if(t.body.attributeType===u.ObjectType.ARRAY)if(t.body.operation===u.ChangeType.ADD){var s=i.obj,a=i.last;Array.prototype.splice.apply(s,[a,0].concat(o))}else if(t.body.operation===u.ChangeType.REMOVE){var s=i.obj,a=i.last;s.splice(a,o)}else i.obj[i.last]=o;else t.body.value?i.obj[i.last]=o:delete i.obj[i.last]}else console.log("UNSYNCHRONIZED VERSION: (data => "+r._version+", msg => "+t.body.version+")")}},{key:"_changeChildren",value:function(e){var t=this;console.log("Change children: ",t._owner,e);var r=e.body.resource,n=t._childrenObjects[r];n?t._changeObject(n._syncObj,e):console.log("No children found for: ",r)}},{key:"url",get:function(){return this._url}},{key:"schema",get:function(){return this._schema}},{key:"status",get:function(){return this._status}},{key:"data",get:function(){return this._syncObj.data}},{key:"children",get:function(){return this._childrenObjects}}]),e}();r["default"]=p,t.exports=r["default"]},{"../utils/utils.js":119,"./DataObjectChild":113,"./SyncObject":117,"babel-runtime/core-js/object/keys":6,"babel-runtime/core-js/promise":8,"babel-runtime/helpers/class-call-check":11,"babel-runtime/helpers/create-class":13,"babel-runtime/helpers/interop-require-default":17}],113:[function(e,t,r){"use strict";var n=e("babel-runtime/helpers/create-class")["default"],o=e("babel-runtime/helpers/class-call-check")["default"],i=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(r,"__esModule",{value:!0});var s=e("./SyncObject"),a=i(s),u=function(){function e(t,r,n,i,s){o(this,e);var u=this;u._parent=t,u._owner=r,u._childId=n,u._msgId=i,u._syncObj=new a["default"](s),u._bus=t._bus,u._allocateListeners()}return n(e,[{key:"_allocateListeners",value:function(){var e=this;e._listener=e._bus.addListener(e._owner,function(t){"response"===t.type&&t.id===e._msgId&&(console.log("DataObjectChild.onResponse:",t),e._onResponse(t))})}},{key:"_releaseListeners",value:function(){var e=this;e._listener.remove()}},{key:"delete",value:function(){var e=this;delete e._parent._children[e._childId],e._releaseListeners()}},{key:"onChange",value:function(e){this._syncObj.observe(function(t){e(t)})}},{key:"onResponse",value:function(e){this._onResponseHandler=e}},{key:"_onResponse",value:function(e){var t=this,r={type:e.type,url:e.body.source,code:e.body.code};t._onResponseHandler&&t._onResponseHandler(r)}},{key:"childId",get:function(){return this._childId}},{key:"data",get:function(){return this._syncObj.data}}]),e}();r["default"]=u,t.exports=r["default"]},{"./SyncObject":117,"babel-runtime/helpers/class-call-check":11,"babel-runtime/helpers/create-class":13,"babel-runtime/helpers/interop-require-default":17}],114:[function(e,t,r){"use strict";var n=e("babel-runtime/helpers/get")["default"],o=e("babel-runtime/helpers/inherits")["default"],i=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],a=e("babel-runtime/core-js/object/keys")["default"],u=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(r,"__esModule",{value:!0});var c=e("./DataObject"),l=u(c),f={ANY:"any",START:"start",EXACT:"exact"},d=function(e){function t(e,r,o,i,a,u,c){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,r,o,i,a,u);var l=this;l._version=c,l._filters={},l._syncObj.observe(function(e){l._onFilter(e)}),l._allocateListeners()}return o(t,e),i(t,[{key:"_allocateListeners",value:function(){n(Object.getPrototypeOf(t.prototype),"_allocateListeners",this).call(this);var e=this;e._changeListener=e._bus.addListener(e._url+"/changes",function(t){"update"===t.type&&(console.log("DataObjectObserver-"+e._url+"-RCV: ",t),e._changeObject(e._syncObj,t))})}},{key:"_releaseListeners",value:function(){n(Object.getPrototypeOf(t.prototype),"_releaseListeners",this).call(this);var e=this;e._changeListener.remove()}},{key:"delete",value:function(){var e=this;e._releaseListeners(),delete e._syncher._observers[e._url]}},{key:"unsubscribe",value:function(){var e=this,t={type:"unsubscribe",from:e._owner,to:e._syncher._subURL,body:{resource:e._url}};e._bus.postMessage(t,function(t){console.log("DataObjectObserver-UNSUBSCRIBE: ",t),200===t.body.code&&(e._releaseListeners(),delete e._syncher._observers[e._url])})}},{key:"onChange",value:function(e,t){var r=e,n={type:f.EXACT,callback:t},o=e.indexOf("*");o===e.length-1&&(0===o?n.type=f.ANY:(n.type=f.START,r=e.substr(0,e.length-1))),this._filters[r]=n}},{key:"_onFilter",value:function(e){var t=this;a(t._filters).forEach(function(r){var n=t._filters[r];n.type===f.ANY?n.callback(e):n.type===f.START?0===e.field.indexOf(r)&&n.callback(e):n.type===f.EXACT&&e.field===r&&n.callback(e)})}}]),t}(l["default"]);r["default"]=d,t.exports=r["default"]},{"./DataObject":112,"babel-runtime/core-js/object/keys":6,"babel-runtime/helpers/class-call-check":11,"babel-runtime/helpers/create-class":13,"babel-runtime/helpers/get":15,"babel-runtime/helpers/inherits":16,"babel-runtime/helpers/interop-require-default":17}],115:[function(e,t,r){"use strict";var n=e("babel-runtime/helpers/get")["default"],o=e("babel-runtime/helpers/inherits")["default"],i=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],a=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(r,"__esModule",{value:!0});var u=e("./DataObject"),c=a(u),l=e("../utils/utils.js"),f=function(e){
function t(e,r,o,i,a,u){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,r,o,i,a,u);var c=this;c._subscriptions={},c._syncObj.observe(function(e){console.log("DataObjectReporter-"+r+"-SEND: ",e),c._onChange(e)}),c._allocateListeners()}return o(t,e),i(t,[{key:"_allocateListeners",value:function(){n(Object.getPrototypeOf(t.prototype),"_allocateListeners",this).call(this);var e=this;e._responseListener=e._bus.addListener(e._url,function(t){"response"===t.type&&e._onResponse(t)})}},{key:"_releaseListeners",value:function(){n(Object.getPrototypeOf(t.prototype),"_releaseListeners",this).call(this);var e=this;e._responseListener.remove()}},{key:"delete",value:function(){var e=this,t={type:"delete",from:e._owner,to:e._syncher._subURL,body:{resource:e._url}};e._bus.postMessage(t,function(t){console.log("DataObjectReporter-DELETE: ",t),200===t.body.code&&(e._releaseListeners(),delete e._syncher._reporters[e._url])})}},{key:"onSubscription",value:function(e){this._onSubscriptionHandler=e}},{key:"onResponse",value:function(e){this._onResponseHandler=e}},{key:"_onForward",value:function(e){var t=this;switch(console.log("DataObjectReporter-RCV: ",e),e.body.type){case"subscribe":t._onSubscribe(e);break;case"unsubscribe":t._onUnSubscribe(e)}}},{key:"_onSubscribe",value:function(e){var t=this,r=e.body.from,n={type:e.body.type,url:r,accept:function(){var n={url:r,status:"on"};return t._subscriptions[r]=n,t._bus.postMessage({id:e.id,type:"response",from:e.to,to:e.from,body:{code:200,schema:t._schema,version:t._version,value:(0,l.deepClone)(t.data)}}),n},reject:function(r){t._bus.postMessage({id:e.id,type:"response",from:e.to,to:e.from,body:{code:403,desc:r}})}};t._onSubscriptionHandler&&(console.log("SUBSCRIPTION-EVENT: ",n),t._onSubscriptionHandler(n))}},{key:"_onUnSubscribe",value:function(e){var t=this,r=e.body.from,n=t._subscriptions[r];delete t._subscriptions[r];var o={type:e.body.type,url:r,object:n};t._onSubscriptionHandler&&(console.log("UN-SUBSCRIPTION-EVENT: ",o),t._onSubscriptionHandler(o))}},{key:"_onResponse",value:function(e){var t=this,r={type:e.type,url:e.from,code:e.body.code};t._onResponseHandler&&(console.log("RESPONSE-EVENT: ",r),t._onResponseHandler(r))}},{key:"subscriptions",get:function(){return this._subscriptions}}]),t}(c["default"]);r["default"]=f,t.exports=r["default"]},{"../utils/utils.js":119,"./DataObject":112,"babel-runtime/helpers/class-call-check":11,"babel-runtime/helpers/create-class":13,"babel-runtime/helpers/get":15,"babel-runtime/helpers/inherits":16,"babel-runtime/helpers/interop-require-default":17}],116:[function(e,t,r){"use strict";var n=e("babel-runtime/helpers/create-class")["default"],o=e("babel-runtime/helpers/class-call-check")["default"];Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(t,r,n,i){o(this,e);var s=this;s._owner=t,s._url=r,s._bus=n,s._children=i,s._changes=[],s._allocateListeners()}return n(e,[{key:"_allocateListeners",value:function(){var e=this;e._listener=e._bus.addListener(e._url,function(t){console.log("DataProvisional-"+e._url+"-RCV: ",t),e._changes.push(t)})}},{key:"_releaseListeners",value:function(){var e=this;e._listener.remove()}},{key:"apply",value:function(e){var t=this;t._changes.forEach(function(t){e._changeObject(e._syncObj,t)})}},{key:"children",get:function(){return this._children}}]),e}();r["default"]=i,t.exports=r["default"]},{"babel-runtime/helpers/class-call-check":11,"babel-runtime/helpers/create-class":13}],117:[function(e,t,r){"use strict";var n=e("babel-runtime/helpers/create-class")["default"],o=e("babel-runtime/helpers/class-call-check")["default"],i=e("babel-runtime/core-js/object/keys")["default"];Object.defineProperty(r,"__esModule",{value:!0});var s=e("../utils/utils.js"),a=function(){function e(t){o(this,e);var r=this;r._observers=[],r._filters={},t?r._data=(0,s.deepClone)(t):r._data={},r._internalObserve(new u,r._data)}return n(e,[{key:"observe",value:function(e){this._observers.push(e)}},{key:"find",value:function(e){var t=e.split(".");return this._findWithSplit(t)}},{key:"findBefore",value:function(e){var t={},r=e.split(".");return t.last=r.pop(),t.obj=this._findWithSplit(r),t}},{key:"_findWithSplit",value:function(e){var t=this._data;return e.forEach(function(e){t=t[e]}),t}},{key:"_fireEvent",value:function(e){this._observers.forEach(function(t){t(e)})}},{key:"_isObservable",value:function(e){return e.constructor===Object||e.constructor===Array?!0:!1}},{key:"_internalObserve",value:function(e,t){var r=this;if(r._isObservable(t)){var n=function(t){r._onChanges(e,t)};if(t.constructor===Object){Object.observe(t,n);for(var o in t)r._isObservable(t[o])&&r._internalObserve(e["new"](o),t[o])}else if(t.constructor===Array){Array.observe(t,n);for(var o in t)if(r._isObservable(t[o])){var i=e["new"](new c(t[o],o));r._internalObserve(i,t[o])}}}}},{key:"_onChanges",value:function(e,t){var r=this;for(var n in t){var o=t[n].object,i=void 0;if(o.constructor===Object&&(i=f.OBJECT),o.constructor===Array&&(i=f.ARRAY),"splice"===t[n].type)!function(){var a=t[n].index,u=e["new"](""+a),f=u.toString(),d=t[n].removed.length;if(0!==d){var p=t[n].removed;p.forEach(function(t,n){r._isObservable(t)&&e.removeIndex(a+n)}),r._fireEvent({cType:l.REMOVE,oType:i,field:f,data:d})}var h=t[n].addedCount;if(0!==h){var m=o.slice(a,a+h);m.forEach(function(t,n){if(r._isObservable(t)){var o=e["new"](new c(t,a+n));r._internalObserve(o,t)}}),r._fireEvent({cType:l.ADD,oType:i,field:f,data:(0,s.deepClone)(m)})}a!==o.length-1&&e.reIndexFrom(o)}();else{var a=e["new"](t[n].name),u=a.toString();if(-1!==u.indexOf("Symbol"))continue;var d=o[t[n].name];"update"===t[n].type&&this._fireEvent({cType:l.UPDATE,oType:i,field:u,data:(0,s.deepClone)(d)}),"add"===t[n].type&&(this._internalObserve(a,d),this._fireEvent({cType:l.ADD,oType:i,field:u,data:(0,s.deepClone)(d)})),"delete"===t[n].type&&this._fireEvent({cType:l.REMOVE,oType:i,field:u})}}}},{key:"data",get:function(){return this._data}}]),e}(),u=function(){function e(){o(this,e),this._path=[],this._observables={}}return n(e,[{key:"removeIndex",value:function(e){delete this._observables[e]}},{key:"reIndexFrom",value:function(e){var t=this;i(this._observables).forEach(function(r){var n=t._observables[r],o=e.indexOf(n.obj);n.idx!=o&&(n.idx=o,delete t._observables[r],t._observables[o]=n)})}},{key:"new",value:function(e){e.constructor==c&&(this._observables[e.idx]=e);var t=this.clone();return t._path.push(e),t}},{key:"clone",value:function(){var t=new e;return this._path.forEach(function(e){t._path.push(e)}),t}},{key:"toString",value:function(){var e="";return this._path.forEach(function(t,r){0===r?e=t.toString():e+="."+t.toString()}),e}}]),e}(),c=function(){function e(t,r){o(this,e),this.obj=t,this.idx=r}return n(e,[{key:"toString",value:function(){return this.idx.toString()}}]),e}(),l={UPDATE:"update",ADD:"add",REMOVE:"remove"};r.ChangeType=l;var f={OBJECT:"object",ARRAY:"array"};r.ObjectType=f,r["default"]=a},{"../utils/utils.js":119,"babel-runtime/core-js/object/keys":6,"babel-runtime/helpers/class-call-check":11,"babel-runtime/helpers/create-class":13}],118:[function(e,t,r){"use strict";var n=e("babel-runtime/helpers/create-class")["default"],o=e("babel-runtime/helpers/class-call-check")["default"],i=e("babel-runtime/core-js/promise")["default"],s=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(r,"__esModule",{value:!0});var a=e("./DataObjectReporter"),u=s(a),c=e("./DataObjectObserver"),l=s(c),f=e("./DataProvisional"),d=s(f),p=function(){function e(t,r,n){o(this,e);var i=this;i._owner=t,i._bus=r,i._subURL=n.runtimeURL+"/sm",i._reporters={},i._observers={},i._provisionals={},r.addListener(t,function(e){switch(console.log("Syncher-RCV: ",e),e.type){case"forward":i._onForward(e);break;case"create":i._onRemoteCreate(e);break;case"delete":i._onRemoteDelete(e)}})}return n(e,[{key:"create",value:function(e,t,r){var n=this,o={type:"create",from:n._owner,to:n._subURL,body:{schema:e,value:r,authorise:t}};return new i(function(t,i){n._bus.postMessage(o,function(o){if(console.log("create-response: ",o),200===o.body.code){var s=o.body.resource,a=new u["default"](n,s,e,"on",r,o.body.childrenResources);n._reporters[s]=a,t(a)}else i(o.body.desc)})})}},{key:"subscribe",value:function(e,t){var r=this,n={type:"subscribe",from:r._owner,to:r._subURL,body:{schema:e,resource:t}};return new i(function(o,i){r._bus.postMessage(n,function(n){console.log("subscribe-response: ",n);var s=r._provisionals[t];if(delete r._provisionals[t],s&&s._releaseListeners(),n.body.code<200)s=new d["default"](r._owner,t,r._bus,n.body.childrenResources),r._provisionals[t]=s;else if(200===n.body.code){var a=new l["default"](r,t,e,"on",n.body.value,s.children,n.body.version);r._observers[t]=a,o(a),s.apply(a)}else i(n.body.desc)})})}},{key:"onNotification",value:function(e){this._onNotificationHandler=e}},{key:"_onForward",value:function(e){var t=this,r=t._reporters[e.body.to];r._onForward(e)}},{key:"_onRemoteCreate",value:function(e){var t=this,r=e.from.slice(0,-13),n={type:e.type,from:e.body.source,url:r,schema:e.body.schema,value:e.body.value,identity:e.body.idToken,ack:function(r){var n=200;r&&(n=r),t._bus.postMessage({id:e.id,type:"response",from:e.to,to:e.from,body:{code:n}})}};t._onNotificationHandler&&(console.log("NOTIFICATION-EVENT: ",n),t._onNotificationHandler(n))}},{key:"_onRemoteDelete",value:function(e){var t=this,r=e.body.resource,n=t._observers[r];if(n){var o={type:e.type,url:r,identity:e.body.idToken,ack:function(r){var o=200;r&&(o=r),200===o&&n["delete"](),t._bus.postMessage({id:e.id,type:"response",from:e.to,to:e.from,body:{code:o,source:t._owner}})}};t._onNotificationHandler&&(console.log("NOTIFICATION-EVENT: ",o),t._onNotificationHandler(o))}else t._bus.postMessage({id:e.id,type:"response",from:e.to,to:e.from,body:{code:404,source:t._owner}})}},{key:"owner",get:function(){return this._owner}},{key:"reporters",get:function(){return this._reporters}},{key:"observers",get:function(){return this._observers}}]),e}();r["default"]=p,t.exports=r["default"]},{"./DataObjectObserver":114,"./DataObjectReporter":115,"./DataProvisional":116,"babel-runtime/core-js/promise":8,"babel-runtime/helpers/class-call-check":11,"babel-runtime/helpers/create-class":13,"babel-runtime/helpers/interop-require-default":17}],119:[function(e,t,r){"use strict";function n(e){var t=/([a-zA-Z-]*):\/\/(?:\.)?([-a-zA-Z0-9@:%._\+~#=]{2,256})([-a-zA-Z0-9@:%._\+~#=\/]*)/gi,r="$1,$2,$3",n=e.replace(t,r).split(",");n[0]===e&&(n[0]="https",n[1]=e);var o={type:n[0],domain:n[1],identity:n[2]};return o}function o(e){return e?JSON.parse(JSON.stringify(e)):void 0}Object.defineProperty(r,"__esModule",{value:!0}),r.divideURL=n,r.deepClone=o},{}]},{},[111])(111)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],4:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(){n(this,e);var t=this;t._msgId=0,t._subscriptions={},t._responseTimeOut=5e3,t._responseCallbacks={},t._registerExternalListener()}return o(e,[{key:"addListener",value:function(e,t){var r=this,n=new s(r._subscriptions,e,t),o=r._subscriptions[e];return o||(o=[],r._subscriptions[e]=o),o.push(n),n}},{key:"addResponseListener",value:function(e,t,r){this._responseCallbacks[e+t]=r}},{key:"removeResponseListener",value:function(e,t){delete this._responseCallbacks[e+t]}},{key:"removeAllListenersOf",value:function(e){delete this._subscriptions[e]}},{key:"bind",value:function(e,t,r){var n=this,o=this,i=o.addListener(e,function(e){r.postMessage(e)}),s=r.addListener(t,function(e){o.postMessage(e)});return{thisListener:i,targetListener:s,unbind:function(){n.thisListener.remove(),n.targetListener.remove()}}}},{key:"_publishOnDefault",value:function(e){var t=this._subscriptions["*"];t&&this._publishOn(t,e)}},{key:"_publishOn",value:function(e,t){e.forEach(function(e){e._callback(t)})}},{key:"_responseCallback",value:function(e,t){var r=this;t&&!function(){var n=e.from+e.id;r._responseCallbacks[n]=t,setTimeout(function(){var t=r._responseCallbacks[n];if(delete r._responseCallbacks[n],t){var o={id:e.id,type:"response",body:{code:408,desc:"Response timeout!",value:e}};t(o)}},r._responseTimeOut)}()}},{key:"_onResponse",value:function(e){var t=this;if("response"===e.type){var r=e.to+e.id,n=t._responseCallbacks[r];if(e.body.code>=200&&delete t._responseCallbacks[r],n)return n(e),!0}return!1}},{key:"_onMessage",value:function(e){var t=this;if(!t._onResponse(e)){var r=t._subscriptions[e.to];r?t._publishOn(r,e):t._publishOnDefault(e)}}},{key:"_genId",value:function(e){e.id&&0!==e.id||(this._msgId++,e.id=this._msgId)}},{key:"postMessage",value:function(e,t){}},{key:"_onPostMessage",value:function(e){}},{key:"_registerExternalListener",value:function(){}}]),e}(),s=function(){function e(t,r,o){n(this,e);var i=this;i._subscriptions=t,i._url=r,i._callback=o}return o(e,[{key:"remove",value:function(){var e=this,t=e._subscriptions[e._url];if(t){var r=t.indexOf(e);t.splice(r,1),0===t.length&&delete e._subscriptions[e._url]}}},{key:"url",get:function(){return this._url}}]),e}();r["default"]=i,t.exports=r["default"]},{}],5:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(e,t,r){for(var n=!0;n;){var o=e,i=t,s=r;n=!1,null===o&&(o=Function.prototype);var a=Object.getOwnPropertyDescriptor(o,i);if(void 0!==a){if("value"in a)return a.value;var u=a.get;if(void 0===u)return;return u.call(s)}var c=Object.getPrototypeOf(o);if(null===c)return;e=c,t=i,r=s,n=!0,a=c=void 0}},u=e("./Bus"),c=n(u),l=e("./Pipeline"),f=n(l),d=function(e){function t(e){o(this,t),a(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this._registry=e,this._forwards={},this._pipeline=new f["default"](function(e){console.log("PIPELINE-ERROR: ",JSON.stringify(e))})}return i(t,e),s(t,[{key:"postMessage",value:function(e,t){var r=this;return r._genId(e),r._pipeline.process(e,function(n){if(r._responseCallback(e,t),!r._onResponse(n)){var o=r._subscriptions[n.to];o?r._publishOn(o,n):r._onPostMessage(n)}}),e.id}},{key:"addForward",value:function(e,t){var r=this,n=this,o=n._forwards[e];if(!o){var i=n.addListener(e,function(t){o.sandboxToUrls.forEach(function(r,n){console.log("MB-FORWARD: ( "+e+" to "+r.size+" destinations)"),r.forEach(function(e){console.log("SEND-TO: ",e)}),n.postMessage(t)})});o={from:e,fl:i,sandboxToUrls:new Map,urlToSandbox:new Map,remove:function(e){var t=r.urlToSandbox.get(e);t&&(r.urlToSandbox["delete"](e),r.sandboxToUrls.get(t)["delete"](e))}},n._forwards[e]=o}return this._registry.getSandbox(t).then(function(e){var r=o.sandboxToUrls.get(e);r||(r=new Set,o.sandboxToUrls.set(e,r)),r.add(t),o.urlToSandbox.set(t,e)}),o}},{key:"_publish",value:function(e,t){var r=this,n=r._subscriptions[e];n&&r._publishOn(n,t)}},{key:"_onPostMessage",value:function(e){var t=this;t._registry.resolve(e.to).then(function(r){t._publish(r,e)})["catch"](function(e){console.log("RESOLVE-ERROR: ",e)})}},{key:"pipeline",get:function(){return this._pipeline}}]),t}(c["default"]);r["default"]=d,t.exports=r["default"]},{"./Bus":4,"./Pipeline":6}],6:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(t){n(this,e);var r=this;r.handlers=[],r.onFail=t}return o(e,[{key:"process",value:function(e,t){var r=this;if(r.handlers.length>0){var n=new a(r.handlers);n.next(new s(r,n,e,t))}else t(e)}}]),e}(),s=function(){function e(t,r,o,i){n(this,e);var s=this;s._inStop=!1,s._pipeline=t,s._iter=r,s._msg=o,s._onDeliver=i}return o(e,[{key:"next",value:function(){var e=this;e._inStop||(e._iter.hasNext?e._iter.next(e):e._onDeliver(e._msg))}},{key:"deliver",value:function(){var e=this;e._inStop||(e._inStop=!0,e._onDeliver(e._msg))}},{key:"fail",value:function(e){var t=this;t._inStop||(t._inStop=!0,t._pipeline.onFail&&t._pipeline.onFail(e))}},{key:"pipeline",get:function(){return this._pipeline}},{key:"msg",get:function(){return this._msg},set:function(e){this._msg=e}}]),e}(),a=function(){function e(t){n(this,e),this._index=-1,this._array=t}return o(e,[{key:"hasNext",get:function(){return this._index<this._array.length-1}},{key:"next",get:function(){return this._index++,this._array[this._index]}}]),e}();r["default"]=i,t.exports=r["default"]},{}],7:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("hellojs"),a=n(s),u=function(){function e(){o(this,e);var t=this;t.identities=[]}return i(e,[{key:"registerIdentity",value:function(){}},{key:"registerWithRP",value:function(){}},{key:"getIdentities",value:function(){var e=this;return e.identities}},{key:"loginWithRP",value:function(e,t){var r=this,n="https://www.googleapis.com/oauth2/v1/tokeninfo?access_token=",o="https://www.googleapis.com/oauth2/v1/userinfo?access_token=",i=void 0,s=void 0;return new Promise(function(e,t){function u(e){var r=new XMLHttpRequest;r.open("GET",n+e,!0),r.onreadystatechange=function(n){4==r.readyState&&(200==r.status?c(e):t(400==r.status?"There was an error processing the token":"something else other than 200 was returned"))},r.send()}function c(e){var n=new XMLHttpRequest;n.open("GET",o+e,!0),n.onreadystatechange=function(o){if(4===n.readyState)if(200===n.status){s=JSON.parse(n.responseText),r.infoToken=s;var i=s.email,a="user://"+i.substring(i.indexOf("@")+1,i.length)+"/"+i.substring(0,i.indexOf("@")),u={identity:a,token:s,accessToken:e,idToken:{},infoToken:s};l(e,u)}else t(400===n.status?"There was an error processing the token":"something else other than 200 was returned")},n.send()}function l(o,s){var a=new XMLHttpRequest;a.open("GET",n+o,!0),a.onreadystatechange=function(n){4===a.readyState&&(200===a.status?(i=JSON.parse(a.responseText),s.idToken=i,r.identities.push(s),e(s.token)):t(400===a.status?"There was an error processing the token":"something else other than 200 was returned"))},a.send()}return void 0!==r.infoToken?e(r.infoToken):(a["default"].init({google:"808329566012-tqr8qoh111942gd2kg007t0s8f277roi.apps.googleusercontent.com"}),void(0,a["default"])("google").login({scope:"email"}).then(function(e){u(e.authResponse.access_token)},function(e){console.log("errorValidating ",e),t(e)}))})}},{key:"setHypertyIdentity",value:function(){}},{key:"generateAssertion",value:function(e,t,r){}},{key:"validateAssertion",value:function(e){}},{key:"getAssertionTrustLevel",value:function(e){}}]),e}();r["default"]=u,t.exports=r["default"]},{hellojs:2}],8:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(){n(this,e);var t=this;t.blackList=[],t.whiteList=[]}return o(e,[{key:"evaluate",value:function(e,t,r,n){var o=this,i=[!0],s=[];for(var a in n){var u=n[a],c=[],l=u.condition.split(" ");switch(l[0]){case"blacklisted":console.log("to verify",r),c[0]=o.isBlackListed(e,r)?u.authorise:!u.authorise,console.log("result",c[0]);break;case"whitelisted":c[0]=o.isWhiteListed(r)?u.authorise:!u.authorise;break;case"time":var f=l[1],d=l[2];c[0]=o.isTimeBetween(f,d)?u.authorise:!u.authorise;break;default:c[1]=u.actions}i.push(c[0]),s.push(c[1])}var p=o.getDecision(i);return[p,s]}},{key:"isSameOrigin",value:function(){}},{key:"isBlackListed",value:function(e,t){var r=this,n=r.blackList;console.log("blacklist",n),console.log("verifying "+t);for(var o in n)if(console.log("checking email"+n[o]),r.hypertiesMatch(e,n[o]),t)return console.log("returning true"),!0;return console.log("returning false"),!1}},{key:"hypertiesMatch",value:function(e,t,r){e.getUserHyperty(t).then(function(e){return console.log("email "+t+" -> hyperty "+e.hypertyURL),e.hypertyURL===r})}},{key:"isWhiteListed",value:function(e){var t=this;return t.whiteList.indexOf(e)>-1}},{key:"isTimeBetween",value:function(e,t){var r=this,n=new Date,o=r.getMinutes(parseInt(n.getHours())+":"+n.getMinutes()),i=r.getMinutes(e),s=r.getMinutes(t);return s>i?o>i&&s>o:(i>o&&(o+=1440),s+=1440,o>i&&s>o)}},{key:"getMinutes",value:function(e){var t=e.split(":");return 60*parseInt(t[0])+parseInt(t[1])}},{key:"getBlackList",value:function(){var e=this;return e.blackList}},{key:"isContext",value:function(){}},{key:"isHypertyType",value:function(){}},{key:"getDecision",value:function(e){return-1===e.indexOf(!1)}},{key:"addToBlackList",value:function(e){var t=this;-1===t.blackList.indexOf(e)&&t.blackList.push(e),console.log(t.blackList)}},{key:"removeFromBlackList",value:function(e){var t=this,r=t.blackList;for(var n in r)if(r[n]===e){r.splice(n,1);break}}},{key:"addToWhiteList",value:function(e){var t=this;-1===t.blackList.indexOf(e)&&t.whiteList.push(e)}},{key:"removeFromWhiteList",value:function(e){var t=this,r=t.whiteList;for(var n in r)if(r[n]===e){r.splice(n,1);break}}}]),e}();r["default"]=i,t.exports=r["default"]},{}],9:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(){n(this,e)}return o(e,[{key:"enforce",value:function(){}},{key:"sendAutomaticMessage",value:function(){}},{key:"forwardToID",value:function(){}},{key:"forwardToHyperty",value:function(){}}]),e}();r["default"]=i,t.exports=r["default"]},{}],10:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("./PEP"),a=n(s),u=e("./PDP"),c=n(u),l=function(){function e(t,r){o(this,e);var n=this;n.idModule=t,n.registry=r,n.pep=new a["default"],n.pdp=new c["default"],n.policies={}}return i(e,[{key:"addPolicies",value:function(e,t){var r=this;for(var n in t)void 0===r.policies[e]&&(r.policies[e]=[]),r.policies[e].push(t[n]),console.log(r.policies)}},{key:"removePolicies",value:function(e,t){var r=this,n=r.policies;if(e in n)if("all"!==t){for(var o=n[e],i=o.length,s=0;i>s;s++)if(o[s].id===t){o.splice(s,1);break}}else delete r.policies[e]}},{key:"addToBlackList",value:function(e){this.pdp.addToBlackList(e)}},{key:"removeFromBlackList",value:function(e){this.pdp.removeFromBlackList(e)}},{key:"addToWhiteList",value:function(e){this.pdp.addToWhiteList(e)}},{key:"removeFromWhiteList",value:function(e){this.pdp.removeFromWhiteList(e)}},{key:"authorise",value:function(e){var t=this;return console.log("Message:",e),new Promise(function(r,n){t.idModule.loginWithRP("google identity","scope").then(function(o){var i=t.idModule.getIdentities();e.hasOwnProperty("body")||(e.body={});var s=void 0;e.body.hasOwnProperty("assertedIdentity")?s=e.from:(e.body.assertedIdentity=i[0].identity,e.body.idToken=o,s=e.to);var a="user";console.log("THIS MESSAGE IS FROM ",e.body.assertedIdentity);var u=t.getApplicablePolicies(a);console.log("POLICIES BEING CHECKED: ",u);var c=void 0;c="hyperty"===s.split(":")[0]?t.pdp.evaluate(t.registry,e,s,u):[!0,[]],t.pep.enforce(c[1]),c[0]?(console.log("MESSAGE ACCEPTED"),r(e)):(console.log("DENIIIIIIIIIIIIIIIIIIIED"),n(e))},function(e){n(e)})})}},{key:"getApplicablePolicies",value:function(e){var t=this;return t.policies[e]}},{key:"getBlackList",value:function(){var e=this;return e.pdp.getBlackList()}}]),e}();r["default"]=l,t.exports=r["default"]},{"./PDP":8,"./PEP":9}],11:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(t,r){n(this,e);var o=this;o._url=t,o._bus=r}return o(e,[{key:"create",value:function(e,t){var r=this,n={type:"create",from:r._url,to:"domain://msg-node."+e+"/hyperty-address-allocation",body:{value:{number:t}}};return new Promise(function(e,t){r._bus.postMessage(n,function(r){200===r.body.code?e(r.body.value.allocated):t(r.body.desc)})})}},{key:"url",get:function(){return this._url}}]),e}();r["default"]=i,t.exports=r["default"]},{}],12:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(e,t,r){for(var n=!0;n;){var o=e,i=t,s=r;n=!1,null===o&&(o=Function.prototype);var a=Object.getOwnPropertyDescriptor(o,i);if(void 0!==a){if("value"in a)return a.value;var u=a.get;if(void 0===u)return;return u.call(s)}var c=Object.getPrototypeOf(o);if(null===c)return;e=c,t=i,r=s,n=!0,a=c=void 0}},u=e("./RegistryDataModel"),c=n(u),l=function(e){function t(e,r,n,i,s,u,c,l){o(this,t),a(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,r,n);var f=this;f._hypertyURL=i,f._user=s,f._guid=u,f._runtime=c,f._context=l}return i(t,e),s(t,[{key:"user",set:function(e){var t=this;t.user=e},get:function(){var e=this;return e._user}},{key:"hypertyURL",get:function(){var e=this;return e._hypertyURL}}]),t}(c["default"]);r["default"]=l,t.exports=r["default"]},{"./RegistryDataModel":14}],13:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(e,t,r){for(var n=!0;n;){var o=e,i=t,s=r;n=!1,null===o&&(o=Function.prototype);var a=Object.getOwnPropertyDescriptor(o,i);if(void 0!==a){if("value"in a)return a.value;var u=a.get;if(void 0===u)return;return u.call(s)}var c=Object.getPrototypeOf(o);if(null===c)return;e=c,t=i,r=s,n=!0,a=c=void 0}},u=e("../utils/EventEmitter"),c=n(u),l=e("./AddressAllocation"),f=n(l),d=e("./HypertyInstance"),p=n(d),h=e("service-framework"),m=e("../utils/utils.js"),y=function(e){function t(e,r,n,i){if(o(this,t),a(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),!e)throw new Error("runtimeURL is missing.");var s=this;s.registryURL=e+"/registry/123",s.appSandbox=r,s.runtimeURL=e,s.remoteRegistry=i,s.idModule=n,s.identifier=Math.floor(1e4*Math.random()+1),s.hypertiesListToRemove={},s.hypertiesList=[],s.protostubsList={},s.sandboxesList={stub:{},hyperty:{},domain:{}},s.pepList={},s._domain=(0,m.divideURL)(s.registryURL).domain,s.sandboxesList.domain[s._domain]=r;var u=new h.MessageFactory("false","{}");s.messageFactory=u}return i(t,e),s(t,[{key:"getAppSandbox",value:function(){var e=this;return e.appSandbox}},{key:"getUserHyperty",value:function(e){var t=this,r="user://"+e.substring(e.indexOf("@")+1,e.length)+"/"+e.substring(0,e.indexOf("@")),n={type:"READ",from:t.registryURL,to:"domain://registry."+t._domain+"/",body:{resource:r}};return new Promise(function(r,o){t._messageBus.postMessage(n,function(t){var n=void 0,i=void 0,s=void 0,a=t.body.value;console.log("reply",a);for(n in a)if(void 0!==a[n].lastModified)if(void 0===i)i=new Date(a[n].lastModified),s=n;else{var u=new Date(a[n].lastModified);i.getTime()<u.getTime()&&(i=u,s=n)}var c=s;if(void 0===c)return o("User Hyperty not found");var l={id:e,descriptor:a[c].descriptor,hypertyURL:c};console.log("===> RegisterHyperty messageBundle: ",l),r(l)})})}},{key:"deleteHypertyInstance",value:function(e,t){var r=this,n={type:"DELETE",from:r.registryURL,to:"domain://registry."+r._domain+"/",body:{value:{user:e,hypertyURL:t}}};r._messageBus.postMessage(n,function(e){console.log("delete hyperty Reply",e)})}},{key:"updateHypertyInstance",value:function(e,t){var r=this,n={type:"UPDATE",from:r.registryURL,to:"domain://registry."+r._domain+"/",body:{resource:e,value:t}};r._messageBus.post.postMessage(n,function(e){console.log("Updated hyperty reply",e)})}},{key:"registerHyperty",value:function(e,t){var r=this,n=(0,m.divideURL)(t).domain;return new Promise(function(o,i){r.idModule.loginWithRP("google","me").then(function(s){var a=s.email,u="user://"+a.substring(a.indexOf("@")+1,a.length)+"/"+a.substring(0,a.indexOf("@"));void 0===r._messageBus?i("MessageBus not found on registerStub"):r.resolve("hyperty-runtime://"+n).then(function(){r.registryDomain=n;var i=1;r.addressAllocation.create(n,i).then(function(n){n.forEach(function(e){r._messageBus.addListener(e+"/status",function(t){
console.log("Message addListener for : ",e+"/status -> "+t)})});var i=new p["default"](r.identifier,r.registryURL,t,n[0],u);r.hypertiesList.push(i),r.sandboxesList.hyperty[n[0]]=e;var s={type:"CREATE",from:r.registryURL,to:"domain://registry."+r.registryDomain+"/",body:{value:{user:u,hypertyDescriptorURL:t,hypertyURL:n[0]}}};r._messageBus.postMessage(s,function(e){console.log("===> RegisterHyperty Reply: ",e)}),o(n[0])})})["catch"](function(e){console.log("Address Reason: ",e),i(e)})},function(e){i("Failed to obtain an identity")})})}},{key:"unregisterHyperty",value:function(e){var t=this;return new Promise(function(r,n){var o=!1,i=0;for(i=0;i<t.hypertiesList.length;i++){var s=t.hypertiesList[i];if(void 0!==s&&s.hypertyURL===e){o=!0;break}}o===!1?n("Hyperty not found"):(delete t.hypertiesList[i],r("Hyperty successfully deleted"))})}},{key:"discoverProtostub",value:function(e){if(!e)throw new Error("Parameter url needed");var t=this;return new Promise(function(r,n){var o=t.protostubsList[e];void 0===o?n("requestUpdate couldn' get the ProtostubURL"):r(o)})}},{key:"registerStub",value:function(e,t){var r=this,n=void 0;return new Promise(function(o,i){void 0===r._messageBus&&i("MessageBus not found on registerStub"),t.indexOf("msg-node.")||(t=t.substring(t.indexOf(".")+1)),n="msg-node."+t+"/protostub/"+Math.floor(1e4*Math.random()+1),r.protostubsList[t]=n,r.sandboxesList.stub[n]=e,o(n),r._messageBus.addListener(n+"/status",function(e){e.resource===e.to+"/status"&&console.log("RuntimeProtostubURL/status message: ",e.body.value)})})}},{key:"unregisterStub",value:function(e){var t=this;return new Promise(function(r,n){var o=t.protostubsList[e];void 0===o?n("Error on unregisterStub: Hyperty not found"):(delete t.protostubsList[e],r("ProtostubURL removed"))})}},{key:"registerPEP",value:function(e,t){var r=this;return new Promise(function(n,o){r.pepList[t]=e,n("PEP registered with success")})}},{key:"unregisterPEP",value:function(e){var t=this;return new Promise(function(r,n){var o=t.pepList[e];void 0===o?n("Pep Not found."):r("PEP successfully removed.")})}},{key:"onEvent",value:function(e){}},{key:"getSandbox",value:function(e){if(!e)throw new Error("Parameter url needed");var t=(0,m.divideURL)(e),r=this;return new Promise(function(n,o){var i=void 0;if(e.includes("msg-node")){if(i=r.sandboxesList.stub[e],void 0===i)for(var s in r.sandboxesList.stub)if(s.includes(e)){i=r.sandboxesList.stub[s];break}}else if(e.includes("hyperty")&&(i=r.sandboxesList.hyperty[e],void 0===i))for(var a in r.sandboxesList.hyperty)if(a.includes(e)){i=r.sandboxesList.hyperty[a];break}if(void 0===i){if(i=r.sandboxesList.domain[e],void 0===i)for(var u in r.sandboxesList.domain)if(u.includes(t.domain)){i=r.sandboxesList.domain[u];break}void 0===i?o("Sandbox not found"):n(i)}else n(i)})}},{key:"resolve",value:function(e){console.log("resolve "+e);var t=this,r=(0,m.divideURL)(e).domain;return new Promise(function(e,n){r.indexOf("msg-node.")&&r.indexOf("registry.")||(r=r.substring(r.indexOf(".")+1));var o=t.protostubsList[r];t.addEventListener("runtime:stubLoaded",function(t){e(t)}),void 0!==o?e(o):t.trigger("runtime:loadStub",r)})}},{key:"messageBus",get:function(){var e=this;return e._messageBus},set:function(e){var t=this;t._messageBus=e;var r=new f["default"](t.registryURL,e);t.addressAllocation=r}}]),t}(c["default"]);r["default"]=y,t.exports=r["default"]},{"../utils/EventEmitter":23,"../utils/utils.js":24,"./AddressAllocation":11,"./HypertyInstance":12,"service-framework":3}],14:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(t,r,o,i,s,a,u,c){n(this,e);var l=this;l._id=t,l._url=r,l._descriptor=o,l._startingTime=i,l._lastModified=s,l._status=a,l._stubs=u,l._stubsConfiguration=c}return o(e,[{key:"id",get:function(){var e=this;return e._id}},{key:"url",get:function(){var e=this;return e._url}},{key:"descriptor",get:function(){var e=this;return e._descriptor}}]),e}();r["default"]=i,t.exports=r["default"]},{}],15:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var o=e("./runtime/RuntimeUA"),i=n(o);r["default"]=i["default"],t.exports=r["default"]},{"./runtime/RuntimeUA":17}],16:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e("../utils/utils"),s=e("service-framework"),a=function(){function e(){n(this,e);var t=this;t._factory=new s.CatalogueFactory(!1,void 0)}return o(e,[{key:"getHypertyRuntimeURL",value:function(){var e=this;return e._hypertyRuntimeURL}},{key:"_makeLocalRequest",value:function(e){return console.log(e),new Promise(function(t,r){var n={"hyperty-catalogue://":"http://","../":"../"},o=!1;for(var i in n)if(e.slice(0,i.length)===i){e=n[i]+e.slice(i.length,e.length),o=!0;break}if(!o)return void r("Invalid protocol of url: "+e);var s=new XMLHttpRequest;s.open("GET",e,!0),s.onreadystatechange=function(e){var n=e.currentTarget;4===n.readyState&&(200===n.status?t(n.responseText):r(n.responseText))},s.send()})}},{key:"_makeExternalRequest",value:function(e){return new Promise(function(t,r){var n={"hyperty-catalogue://":"http://"},o=!1;for(var i in n)if(e.slice(0,i.length)===i){e=n[i]+e.slice(i.length,e.length),o=!0;break}if(!o)return void r("Invalid protocol of url: "+e);var s=new XMLHttpRequest;s.open("GET",e,!0),s.onreadystatechange=function(e){var n=e.currentTarget;4===n.readyState&&(200===n.status?t(n.responseText):r(n.responseText))},s.send()})}},{key:"getHypertyDescriptor",value:function(e){var t=this;return new Promise(function(r,n){var o=(0,i.divideURL)(e),s=o.domain,a=o.identity;s||(s=e),a&&(a=a.substring(a.lastIndexOf("/")+1)),t._makeLocalRequest("../resources/descriptors/Hyperties.json").then(function(e){t.Hyperties=JSON.parse(e);var o=t.Hyperties[a];if(o.error)n(o);else{var i=t._factory.createHypertyDescriptorObject(o.cguid,o.objectName,o.description,o.language,o.sourcePackageURL,o.type,o.dataObjects);i.configuration=o.configuration,i.constraints=o.constraints,i.messageSchema=o.messageSchema,i.policies=o.policies,i.signature=o.signature;var s=o.sourcePackage;s&&(i.sourcePackage=t._createSourcePackage(t._factory,s)),console.log("hyperty has sourcePackage:",i),r(i)}})})}},{key:"getSourcePackageFromURL",value:function(e){var t=this;return new Promise(function(r,n){"/sourcePackage"===e&&n("sourcePackage is already contained in descriptor, please use it directly"),t._makeExternalRequest(e).then(function(e){if(e.error)n(e);else{e=JSON.parse(e);var o=e.sourcePackage;o?(o=t._createSourcePackage(t._factory,o),r(o)):n("no source package")}})["catch"](function(e){n(e)})})}},{key:"getStubDescriptor",value:function(e){var t=this;return new Promise(function(r,n){var o=(0,i.divideURL)(e),s=o.domain,a=o.identity;s||(s=e),a=a?a.substring(a.lastIndexOf("/")+1):"default",t._makeLocalRequest("../resources/descriptors/ProtoStubs.json").then(function(e){t.ProtoStubs=JSON.parse(e);var o=t.ProtoStubs[a];if(o.error)n(o);else{console.log("creating stub descriptor based on: ",o);var i=t._factory.createProtoStubDescriptorObject(o.cguid,o.objectName,o.description,o.language,o.sourcePackageURL,o.messageSchemas,JSON.stringify(o.configuration),o.constraints),s=o.sourcePackage;s&&(s=t._createSourcePackage(t._factory,s),i.sourcePackage=s),r(i)}})})}},{key:"getDataSchemaDescriptor",value:function(e){var t=this;return new Promise(function(r,n){e&&(e=e.substring(e.lastIndexOf("/")+1)),t._makeLocalRequest("../resources/descriptors/DataSchemas.json").then(function(o){t.DataSchemas=JSON.parse(o);var i=t.DataSchemas[e];if(i.ERROR)n(i);else{console.log("creating dataSchema based on: ",i);var s=t._factory.createDataObjectSchema(i.cguid,i.objectName,i.description,i.language,i.sourcePackageURL);console.log("created dataSchema descriptor object:",s);var a=i.sourcePackage;a&&(s.sourcePackage=t._createSourcePackage(t._factory,a),"string"==typeof s.sourcePackage.sourceCode&&(s.sourcePackage.sourceCode=JSON.parse(s.sourcePackage.sourceCode))),r(s)}})})}},{key:"_createSourcePackage",value:function(e,t){try{t=JSON.parse(t)}catch(r){console.log("parsing sourcePackage failed. already parsed? -> ",t)}"base64"===t.encoding&&(t.sourceCode=atob(t.sourceCode),t.encoding="UTF-8");var n=e.createSourcePackage(t.sourceCodeClassname,t.sourceCode);return t.hasOwnProperty("encoding")&&(n.encoding=t.encoding),t.hasOwnProperty("signature")&&(n.signature=t.signature),n}},{key:"runtimeURL",set:function(e){var t=this;t._runtimeURL=e},get:function(){var e=this;return e._runtimeURL}}]),e}();r["default"]=a,t.exports=r["default"]},{"../utils/utils":24,"service-framework":3}],17:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("../registry/Registry"),a=n(s),u=e("../identity/IdentityModule"),c=n(u),l=e("../policy/PolicyEngine"),f=n(l),d=e("../bus/MessageBus"),p=n(d),h=e("./RuntimeCatalogue-Local"),m=n(h),y=e("../syncher/SyncherManager"),v=n(y),b=e("../utils/utils"),g=function(){function e(t,r){if(o(this,e),!t)throw new Error("The sandbox factory is a needed parameter");if(!r)throw new Error("You need the domain of runtime");var n=this;n.sandboxFactory=t,n.runtimeCatalogue=new m["default"];var i="runtime://"+r+"/"+Math.floor(1e4*Math.random()+1);n.runtimeURL=i,n.domain=r,n.runtimeCatalogue.runtimeURL=i,n.identityModule=new c["default"];var s=t.createAppSandbox();n.registry=new a["default"](i,s,n.identityModule),n.policyEngine=new f["default"](n.identityModule,n.registry),n.messageBus=new p["default"](n.registry),n.messageBus.pipeline.handlers=[function(e){n.policyEngine.authorise(e.msg).then(function(t){e.msg=t,e.next()})["catch"](function(t){console.error(t),e.fail(t)})}],s.addListener("*",function(e){n.messageBus.postMessage(e)}),n.registry.messageBus=n.messageBus,n.registry.addEventListener("runtime:loadStub",function(e){n.loadStub(e).then(function(){n.registry.trigger("runtime:stubLoaded",e)})["catch"](function(e){console.error(e)})}),t.messageBus=n.messageBus,n.syncherManager=new v["default"](n.runtimeURL,n.messageBus,{},n.runtimeCatalogue)}return i(e,[{key:"discoverHiperty",value:function(e){}},{key:"registerHyperty",value:function(e,t){}},{key:"loadHyperty",value:function(e){var t=this;if(!e)throw new Error("Hyperty descriptor url parameter is needed");return new Promise(function(r,n){var o=void 0,i=void 0,s=void 0,a=void 0,u=function(e){n(e)};console.info("------------------ Hyperty ------------------------"),console.info("Get hyperty descriptor for :",e),t.runtimeCatalogue.getHypertyDescriptor(e).then(function(e){console.info("1: return hyperty descriptor",e),s=e;var r=e.sourcePackageURL;return"/sourcePackage"===r?e.sourcePackage:t.runtimeCatalogue.getSourcePackageFromURL(r)}).then(function(e){console.info("2: return hyperty source code"),a=e;var t=!0;return t}).then(function(r){console.info("3: return policy engine result: ",r);var n=!0,o=void 0;if(n)o=t.registry.getAppSandbox();else{var i=(0,b.divideURL)(e).domain;o=t.registry.getSandbox(i)}return o}).then(function(e){return console.info("4: return the sandbox",e),e},function(e){console.error("4.1: try to register a new sandbox",e);var r=t.sandboxFactory.createSandbox();return r.addListener("*",function(e){t.messageBus.postMessage(e)}),r}).then(function(r){return console.info("5: return sandbox and register"),i=r,t.registry.registerHyperty(r,e)}).then(function(e){console.info("6: Hyperty url, after register hyperty",e),o=e,console.log(s);var r={};if(!(0,b.emptyObject)(s.configuration))try{r=Object.assign({},JSON.parse(s.configuration))}catch(n){r=s.configuration}return r.runtimeURL=t.runtimeURL,i.deployComponent(a.sourceCode,o,r)}).then(function(e){console.info("7: Deploy component status for hyperty: ",e),t.messageBus.addListener(o,function(e){i.postMessage(e)});var n={runtimeHypertyURL:o,status:e};r(n),console.log("------------------ END ------------------------")})["catch"](u)})}},{key:"loadStub",value:function(e){var t=this;if(!e)throw new Error("domain parameter is needed");return new Promise(function(r,n){var o=(0,b.divideURL)(e).domain;o||(o=e);var i=void 0,s=void 0,a=void 0,u=void 0,c=function(e){console.error(e),n(e)};console.info("------------------- ProtoStub ---------------------------\n"),console.info("Discover or Create a new ProtoStub for domain: ",o),t.registry.discoverProtostub(o).then(function(e){return console.info("1. Proto Stub Discovered: ",e),s=e},function(r){return console.info("1. Proto Stub not found:",r),t.runtimeCatalogue.getStubDescriptor(e)}).then(function(e){console.info("2. return the ProtoStub descriptor:",e),s=e;var r=e.sourcePackageURL;return"/sourcePackage"===r?e.sourcePackage:t.runtimeCatalogue.getSourcePackageFromURL(r)}).then(function(e){console.info("3. return the ProtoStub Source Code: ",e),u=e;var t=!0;return t}).then(function(e){return t.registry.getSandbox(o)}).then(function(e){return console.info("4. if the sandbox is registered then return the sandbox",e),i=e,e},function(e){console.info("5. Sandbox was not found, creating a new one",e);var r=t.sandboxFactory.createSandbox();return r.addListener("*",function(e){t.messageBus.postMessage(e)}),r}).then(function(e){return console.info("6. return the sandbox instance and register",e,"to domain ",o),i=e,t.registry.registerStub(i,o)}).then(function(e){console.info("7. return the runtime protostub url: ",e),a=e,console.log(s);var r=Object.assign({},JSON.parse(s.configuration));return r.runtimeURL=t.runtimeURL,i.deployComponent(u.sourceCode,e,r)}).then(function(e){console.info("8: return deploy component for sandbox status: ",e),t.messageBus.addListener(a,function(e){i.postMessage(e)});var n={runtimeProtoStubURL:a,status:e};r(n),console.info("------------------- END ---------------------------\n")})["catch"](c)})}},{key:"checkForUpdate",value:function(e){}}]),e}();r["default"]=g,t.exports=r["default"]},{"../bus/MessageBus":5,"../identity/IdentityModule":7,"../policy/PolicyEngine":10,"../registry/Registry":13,"../syncher/SyncherManager":22,"../utils/utils":24,"./RuntimeCatalogue-Local":16}],18:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(t,r){n(this,e);var o=this;o._url=t,o._bus=r}return o(e,[{key:"create",value:function(e,t,r,n){var o=this,i={type:"create",from:o._url,to:"domain://msg-node."+e+"/object-address-allocation",body:{scheme:t,childrenResources:r,value:{number:n}}};return new Promise(function(e,t){o._bus.postMessage(i,function(r){200===r.body.code?e(r.body.value.allocated):t(r.body.desc)})})}},{key:"url",get:function(){return this._url}}]),e}();r["default"]=i,t.exports=r["default"]},{}],19:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("../utils/utils"),a=e("./Subscription"),u=n(a),c=function(){function e(t,r,n){o(this,e);var i=this;i._parent=t,i._url=r,i._childrens=n,i._bus=t._bus,i._subscriptions={}}return i(e,[{key:"addSubscription",value:function(e){var t=this;t._subscriptions[e]=new u["default"](t._bus,e,t._url,t._childrens)}},{key:"removeSubscription",value:function(e){var t=this,r=(0,s.divideURL)(e).domain,n=t._url+"/subscription",o=t._subscriptions[e];o&&(t._bus.postMessage({type:"unsubscribe",from:t._parent._url,to:n,body:{resource:t._url}}),t._bus.postMessage({type:"unsubscribe",from:t._parent._url,to:"domain://msg-node."+r+"/object-address-allocation",body:{resource:t._url,childrenResources:t._childrens}}),o._releaseListeners(),delete t._subscriptions[e])}}]),e}();r["default"]=c,t.exports=r["default"]},{"../utils/utils":24,"./Subscription":21}],20:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("../utils/utils"),a=e("./Subscription"),u=n(a),c=function(){function e(t,r,n,i){o(this,e);var s=this;s._parent=t,s._owner=r,s._url=n,s._childrens=i,s._objSubscriptorURL=s._url+"/subscription",s._bus=t._bus,s._subscriptions={},s._allocateListeners()}return i(e,[{key:"_allocateListeners",value:function(){var e=this;e._objForward=e._bus.addForward(e._url,e._owner),e._subscriptionListener=e._bus.addListener(e._objSubscriptorURL,function(t){switch(console.log(e._objSubscriptorURL+"-RCV: ",t),t.type){case"subscribe":e._onRemoteSubscribe(t);break;case"unsubscribe":e._onRemoteUnSubscribe(t);break;case"response":e._onRemoteResponse(t)}});var t=e._url+"/children/";e._childrenListeners=[],e._childrens.forEach(function(r){var n=t+r,o=e._bus.addListener(n,function(e){console.log("SyncherManager-"+n+"-RCV: ",e)});e._childrenListeners.push(o)})}},{key:"_releaseListeners",value:function(){var e=this;e._objForward.remove(),e._subscriptionListener.remove(),e._childrenListeners.forEach(function(e){e.remove()}),Object.keys(e._subscriptions).forEach(function(t){e._subscriptions[t]._releaseListeners()})}},{key:"delete",value:function(){var e=this,t=(0,s.divideURL)(e._owner).domain;e._bus.postMessage({type:"delete",from:e._objSubscriptorURL,to:e._url+"/changes"}),e._bus.postMessage({type:"delete",from:e._parent._url,to:"domain://msg-node."+t+"/object-address-allocation",body:{resource:e._url,childrenResources:e._childrens}}),e._releaseListeners(),delete e._parent._reporters[e._url]}},{key:"_onRemoteResponse",value:function(e){var t=this;t._bus.postMessage({id:e.id,type:"response",from:e.to,to:t._url,body:{code:e.body.code,source:e.from}})}},{key:"_onRemoteSubscribe",value:function(e){var t=this,r=e.body.subscriber;if(t._subscriptions[r]){var n={id:e.id,type:"response",from:e.to,to:r,body:{code:500,desc:"Subscription for ("+t._url+" : "+r+") already exists!"}};return void t._bus.postMessage(n)}var o="sub/pub";if("sub/pub"===o){var i={type:"forward",from:t._url,to:t._owner,body:{type:e.type,from:r,to:t._url}};t._bus.postMessage(i,function(n){console.log("forward-reply: ",n),200===n.body.code&&(t._subscriptions[r]=new u["default"](t._bus,r,t._url,t._childrens)),t._bus.postMessage({id:e.id,type:"response",from:e.to,to:e.from,body:n.body})})}}},{key:"_onRemoteUnSubscribe",value:function(e){var t=this,r=e.body.subscriber,n=t._subscriptions[r];n&&(n._releaseListeners(),delete t._subscriptions[r])}}]),e}();r["default"]=c,t.exports=r["default"]},{"../utils/utils":24,"./Subscription":21}],21:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(t,r,o,i){n(this,e);var s=this,a=o+"/children/",u=o+"/changes";s._deleteListener=t.addListener(u,function(e){if("delete"===e.type){console.log("Subscription-DELETE: ",e);var n={type:"delete",from:e.from,to:r,body:{resource:o}};t.postMessage(n,function(e){console.log("Subscription-DELETE-REPLY: ",e),200===e.body.code&&s._releaseListeners()})}}),s._changeListener=t.addForward(u,r),s._childrenListeners=[],i.forEach(function(e){var n=t.addForward(a+e,r);s._childrenListeners.push(n)})}return o(e,[{key:"_releaseListeners",value:function(){var e=this;e._deleteListener.remove(),e._changeListener.remove(),e._childrenListeners.forEach(function(e){e.remove()})}}]),e}();r["default"]=i,t.exports=r["default"]},{}],22:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("../utils/utils"),a=e("./ObjectAllocation"),u=n(a),c=e("./ReporterObject"),l=n(c),f=e("./ObserverObject"),d=n(f),p=function(){function e(t,r,n,i,a){o(this,e);var c=this;c._bus=r,c._registry=n,c._catalog=i,c._url=t+"/sm",c._objectURL=t+"/object-allocation",c._reporters={},c._observers={},c._domain=(0,s.divideURL)(t).domain,a?c._allocator=a:c._allocator=new u["default"](c._objectURL,r),r.addListener(c._url,function(e){switch(console.log("SyncherManager-RCV: ",e),e.type){case"create":c._onCreate(e);break;case"delete":c._onDelete(e);break;case"subscribe":c._onLocalSubscribe(e);break;case"unsubscribe":c._onLocalUnSubscribe(e)}})}return i(e,[{key:"_onCreate",value:function(e){var t=this,r=e.from,n=(0,s.divideURL)(e.from).domain;t._catalog.getDataSchemaDescriptor(e.body.schema).then(function(o){var i=o.sourcePackage.sourceCode.properties,s=i.scheme?i.scheme.constant:"resource",a=i.children?i.children.constant:[];t._allocator.create(n,s,a,1).then(function(n){var o=n[0],i=o+"/subscription";t._reporters[o]=new l["default"](t,r,o,a),t._bus.postMessage({id:e.id,type:"response",from:e.to,to:r,body:{code:200,resource:o,childrenResources:a}}),setTimeout(function(){e.body.authorise.forEach(function(r){t._bus.postMessage({type:"create",from:i,to:r,body:{source:e.from,value:e.body.value,schema:e.body.schema}})})})})})["catch"](function(n){t._bus.postMessage({id:e.id,type:"response",from:e.to,to:r,body:{code:500,desc:n}})})}},{key:"_onDelete",value:function(e){var t=this,r=e.body.resource,n=t._reporters[r];n&&(n["delete"](),t._bus.postMessage({id:e.id,type:"response",from:e.to,to:e.from,body:{code:200}}))}},{key:"_onLocalSubscribe",value:function(e){var t=this,r=this,n=e.from,o=(0,s.divideURL)(n).domain,i=e.body.resource,a=i+"/subscription";r._catalog.getDataSchemaDescriptor(e.body.schema).then(function(s){var u=s.sourcePackage.sourceCode.properties,c=u.children?u.children.constant:[],l={type:"subscribe",from:r._url,to:"domain://msg-node."+o+"/sm",body:{resource:i,childrenResources:c,schema:e.body.schema}};r._bus.postMessage(l,function(o){if(console.log("node-subscribe-response: ",o),200===o.body.code){r._bus.postMessage({id:e.id,type:"response",from:e.to,to:n,body:{code:100,childrenResources:c}});var s={type:"subscribe",from:r._url,to:a,body:{subscriber:n}};r._bus.postMessage(s,function(o){if(console.log("reporter-subscribe-response: ",o),200===o.body.code){var s=r._observers[i];s||(s=new d["default"](r,i,c),r._observers[i]=s),s.addSubscription(n),o.id=e.id,o.from=r._url,o.to=n,t._bus.postMessage(o)}})}else r._bus.postMessage({id:e.id,type:"response",from:e.to,to:n,body:o.body})})})}},{key:"_onLocalUnSubscribe",value:function(e){var t=this,r=e.from,n=e.body.resource,o=t._observers[n];o&&(o.removeSubscription(r),t._bus.postMessage({id:e.id,type:"response",from:e.to,to:e.from,body:{code:200}}))}},{key:"url",get:function(){return this._url}}]),e}();r["default"]=p,t.exports=r["default"]},{"../utils/utils":24,"./ObjectAllocation":18,"./ObserverObject":19,"./ReporterObject":20}],23:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(){n(this,e)}return o(e,[{key:"addEventListener",value:function(e,t){var r=this;r[e]=t}},{key:"trigger",value:function(e,t){var r=this;r[e]&&r[e](t)}}]),e}();r["default"]=i,t.exports=r["default"]},{}],24:[function(e,t,r){"use strict";function n(e){var t=/([a-zA-Z-]*):\/\/(?:\.)?([-a-zA-Z0-9@:%._\+~#=]{2,256})([-a-zA-Z0-9@:%._\+~#=\/]*)/gi,r="$1,$2,$3",n=e.replace(t,r).split(","),o={type:n[0],domain:n[1],identity:n[2]};return o}function o(e){return Object.keys(e).length>0?!1:!0}function i(e){return e?JSON.parse(JSON.stringify(e)):void 0}function s(e){var t=e.indexOf("@");return"user://"+e.substring(t+1,e.length)+"/"+e.substring(0,t)}function a(e){var t=n(e);return console.log(t),t.identity.replace("/","")+"@"+t.domain}Object.defineProperty(r,"__esModule",{value:!0}),r.divideURL=n,r.emptyObject=o,r.deepClone=i,r.getUserURLFromEmail=s,r.getUserEmailFromURL=a},{}]},{},[15])(15)});